from flask import Flask, jsonify, request, render_template, send_from_directory
from flask_cors import CORS
import json
import os
import time
import traceback
from datetime import datetime
# import requests # Removed for Vercel compatibility

app = Flask(__name__, static_folder='static', template_folder='templates')
CORS(app)

# Add error handling
@app.errorhandler(500)
def internal_error(error):
    app.logger.error(f'Server Error: {error}')
    app.logger.error(f'Traceback: {traceback.format_exc()}')
    return jsonify({'error': 'Internal server error', 'details': str(error)}), 500

@app.errorhandler(Exception)
def handle_exception(e):
    app.logger.error(f'Unhandled Exception: {e}')
    app.logger.error(f'Traceback: {traceback.format_exc()}')
    return jsonify({'error': 'An error occurred', 'details': str(e)}), 500

# Load data files
def load_json_data(filename):
    try:
        with open(f'data/{filename}', 'r', encoding='utf-8') as f:
            return json.load(f)
    except:
        return {}

# Load all data files
characters_data = load_json_data('characters.json')
scenarios_data = load_json_data('enhanced_scenarios.json')

# Enhanced scenario data - Use loaded data if available, otherwise use default
if scenarios_data and 'enhanced_scenarios' in scenarios_data:
    ENHANCED_SCENARIOS = scenarios_data['enhanced_scenarios']
    print("DEBUG: Using enhanced scenarios from data file")
    print("DEBUG: Available scenarios:", list(ENHANCED_SCENARIOS.keys()))
else:
    print("DEBUG: Using default enhanced scenarios")
    ENHANCED_SCENARIOS = {
    "dragon_hunters_path": {
        "id": "dragon_hunters_path",
        "title": "üêâ Dragon Hunter's Path",
        "genre": "fantasy",
        "description": "K√∂y√º tehdit eden ejderhayƒ± durdurmak i√ßin kahramanlar toplanƒ±yor. Bu sadece bir g√∂rev deƒüil, bu SENƒ∞N Hƒ∞KAYEN. üî• PLOT TWIST'LER, üí¨ NPC ETKƒ∞LE≈ûƒ∞MLERƒ∞, ‚öîÔ∏è UZUN SAVA≈û SAHNELERƒ∞, üéØ ACTION-BASED G√ñREVLER, üèÅ 5+ FARKLI SON!",
        "difficulty": "hard",
        "theme": "fantasy",
        "complexity": "high",
        "estimatedPlayTime": 480,  # 8 saat - √ßok daha uzun
        "levels": {
            "level_1": {
                "title": "K√∂y Tehdidi",
                "description": "K√∂y ejderha tehdidi altƒ±nda. ƒ∞nsanlar korku i√ßinde.",
                "min_level": 1,
                "max_level": 3,
                "enemies": ["Goblin Scouts", "Wolf Pack", "Bandit Raiders"],
                "boss": "Goblin Chief",
                "side_quests": ["Village Defense", "Supply Run", "Scout Mission"]
            },
            "level_2": {
                "title": "Orman Ke≈üfi",
                "description": "Ejderhanƒ±n izini s√ºrmek i√ßin tehlikeli ormana giriyorsun.",
                "min_level": 3,
                "max_level": 5,
                "enemies": ["Forest Trolls", "Dark Elves", "Giant Spiders"],
                "boss": "Ancient Treant",
                "side_quests": ["Herb Collection", "Lost Traveler", "Sacred Grove"]
            }
        },
        "npc_relationships": {
            "aldric": {
                "name": "Aldric the Wise",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "high"
            },
            "lydia": {
                "name": "Lydia the Healer",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "medium"
            },
            "elder_thorin": {
                "name": "Elder Thorin Stonebeard",
                "backstory": "Legendary warrior who fought in the Great War, lost his family, now protects the village",
                "personality": "Stoic, wise, values honor above all",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "high",
                "quest_offers": ["Defend Village", "Ancient Weapon", "Honor Quest"]
            },
            "mystic_lyra": {
                "name": "Mystic Lyra Moonwhisper",
                "backstory": "Chosen by ancient spirits, 500+ years old, sees visions of the future",
                "personality": "Mysterious, contemplative, speaks in riddles",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "extreme",
                "quest_offers": ["Prophecy Quest", "Spirit Communication", "Ancient Knowledge"]
            },
            "captain_marcus": {
                "name": "Captain Marcus Ironheart",
                "backstory": "Rose from farm boy to trusted guard captain, saved the king's life",
                "personality": "Loyal, disciplined, honorable",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "high",
                "quest_offers": ["Royal Investigation", "Corruption Quest", "Loyalty Test"]
            },
            "sienna": {
                "name": "Sienna Shadowstep",
                "backstory": "Orphaned street child who became the city's most skilled thief",
                "personality": "Cunning, resourceful, morally flexible",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "medium",
                "quest_offers": ["Heist Quest", "Information Gathering", "Underground War"]
            }
        },
        "quest_chains": {
            "village_protection": {
                "title": "K√∂y Koruma Zinciri",
                "prerequisites": [],
                "quests": ["defend_village", "gather_supplies", "train_militia"],
                "rewards": {"xp": 500, "gold": 200, "items": ["village_sword"], "relationship_boost": 20}
            }
        },
        "quest_definitions": {
            "defend_village": {
                "title": "Defend the Village",
                "objectives": ["Scout area", "Fortify village", "Defeat bandits", "Protect civilians"],
                "branches": {
                    "success": {"leads_to": "ancient_weapon", "rewards": {"xp": 200, "gold": 150, "reputation": 30}},
                    "failure": {"leads_to": "redemption_quest", "penalties": {"reputation": -10}},
                    "perfect": {"leads_to": "honor_quest", "rewards": {"xp": 300, "gold": 200, "special_item": "village_defender_badge"}}
                },
                "dynamic_rewards": {"experience": 200, "gold": 150, "items": ["village_defender_badge"], "reputation": 30},
                "world_state_impact": {"village_safety": "+50", "elder_thorin_trust": "+25", "village_morale": "+40"}
            },
            "ancient_weapon": {
                "title": "Ancient Weapon",
                "objectives": ["Find ancient forge", "Gather sacred materials", "Forge weapon", "Enchant blade"],
                "branches": {
                    "success": {"leads_to": "dragon_final_battle", "rewards": {"xp": 300, "special_weapon": "dragonbane_sword"}},
                    "failure": {"leads_to": "alternative_strategy", "penalties": {"time_lost": 5}}
                },
                "dynamic_rewards": {"experience": 300, "special_weapon": "dragonbane_sword", "mystic_lyra_trust": "+30"},
                "world_state_impact": {"weapon_power": "+100", "village_hope": "+60"}
            },
            "prophecy_quest": {
                "title": "Prophecy Quest",
                "objectives": ["Visit sacred grove", "Interpret visions", "Gather ancient texts", "Understand destiny"],
                "branches": {
                    "success": {"leads_to": "spirit_communication", "rewards": {"xp": 250, "wisdom": "+50"}},
                    "enlightened": {"leads_to": "ancient_knowledge", "rewards": {"xp": 400, "special_ability": "future_sight"}}
                },
                "dynamic_rewards": {"experience": 250, "wisdom": 50, "mystic_lyra_trust": "+40"},
                "world_state_impact": {"prophecy_knowledge": "+100", "spiritual_power": "+30"}
            },
            "dragon_hunt": {
                "title": "Dragon Hunt",
                "objectives": ["Track dragon", "Fight dragon minions", "Reach dragon lair", "Defeat dragon"],
                "branches": {
                    "success": {"leads_to": "dragon_victory", "rewards": {"xp": 500, "dragon_scales": True, "legendary_status": True}},
                    "failure": {"leads_to": "retreat_and_regroup", "penalties": {"combat": -20}},
                    "perfect": {"leads_to": "dragon_master", "rewards": {"xp": 800, "dragon_heart": True, "master_hunter": True}}
                },
                "dynamic_rewards": {"experience": 500, "dragon_scales": True, "combat": 100},
                "world_state_impact": {"dragon_threat": "-100", "village_safety": "+100", "hero_reputation": "+200"}
            },
            "bandit_elimination": {
                "title": "Bandit Elimination",
                "objectives": ["Find bandit camp", "Defeat bandit leader", "Rescue hostages", "Secure area"],
                "branches": {
                    "success": {"leads_to": "village_defense", "rewards": {"xp": 200, "gold": 100, "combat": 50}},
                    "failure": {"leads_to": "bandit_retaliation", "penalties": {"village_safety": -30}},
                    "perfect": {"leads_to": "hero_recognition", "rewards": {"xp": 300, "gold": 150, "village_trust": 100}}
                },
                "dynamic_rewards": {"experience": 200, "gold": 100, "combat": 50},
                "world_state_impact": {"bandit_threat": "-80", "village_safety": "+60", "combat_reputation": "+40"}
            },
            "monster_hunt": {
                "title": "Monster Hunt",
                "objectives": ["Track monster", "Fight lesser monsters", "Defeat alpha monster", "Collect trophies"],
                "branches": {
                    "success": {"leads_to": "monster_trophy", "rewards": {"xp": 150, "monster_parts": True, "combat": 30}},
                    "failure": {"leads_to": "monster_escape", "penalties": {"combat": -10}},
                    "perfect": {"leads_to": "monster_master", "rewards": {"xp": 250, "rare_trophy": True, "hunting_skill": 50}}
                },
                "dynamic_rewards": {"experience": 150, "monster_parts": True, "combat": 30},
                "world_state_impact": {"monster_threat": "-50", "hunting_grounds": "+40", "combat_experience": "+30"}
            },
            "guardian_battle": {
                "title": "Guardian Battle",
                "objectives": ["Find ancient guardian", "Solve guardian puzzle", "Fight guardian", "Claim guardian treasure"],
                "branches": {
                    "success": {"leads_to": "guardian_treasure", "rewards": {"xp": 400, "ancient_weapon": True, "magic_power": 100}},
                    "failure": {"leads_to": "guardian_escape", "penalties": {"magic_power": -20}},
                    "perfect": {"leads_to": "guardian_alliance", "rewards": {"xp": 600, "guardian_blessing": True, "magic_mastery": True}}
                },
                "dynamic_rewards": {"experience": 400, "ancient_weapon": True, "magic_power": 100},
                "world_state_impact": {"ancient_power": "+100", "magical_protection": "+80", "hero_magic": "+120"}
            }
        },
        "ending_variations": {
            "good_ending": {
                "requirements": {"aldric_trust": 80, "lydia_trust": 70, "quests_completed": 15},
                "description": "Ejderhayƒ± yendin ve k√∂y√º kurtardƒ±n. Herkes g√ºvende."
            },
            "neutral_ending": {
                "requirements": {"aldric_trust": 50, "quests_completed": 10},
                "description": "Ejderhayƒ± yendin ama b√ºy√ºk kayƒ±plar oldu."
            },
            "bad_ending": {
                "requirements": {"aldric_trust": 20, "quests_completed": 5},
                "description": "Ejderha galip geldi. K√∂y yok oldu."
            }
        },
        "story_nodes": {
            "start": {
                "id": "start",
                "title": "üêâ Ejderha Avcƒ±sƒ±nƒ±n Yolu - Ba≈ülangƒ±√ß",
                "description": "G√ºne≈ü batarken k√∂y√ºn √ºzerinde kƒ±zƒ±l bir g√∂lge beliriyor. Kƒ±zƒ±l ejderha g√∂ky√ºz√ºnde u√ßuyor ve alevler sa√ßarak k√∂y√º yakƒ±yor. Sen ejderha avcƒ±sƒ±sƒ±n ve bu tehlikeli g√∂revde her ≈üeyi riske atacaksƒ±n. K√∂y meydanƒ±nda ya≈ülƒ± bir adam seni bekliyor - k√∂y reisi Aldric. K√∂yl√ºler korku i√ßinde evlerine kapanmƒ±≈ü, sokaklar bombo≈ü. Ejderhanƒ±n son saldƒ±rƒ±sƒ±nda 3 ev yanmƒ±≈ü ve 2 ki≈üi yaralanmƒ±≈ü. Bu sadece bir g√∂rev deƒüil, bu SENƒ∞N Hƒ∞KAYEN.",
                "choices": [
                    {
                        "id": "talk_aldric",
                        "text": "Aldric ile konu≈ü",
                        "next_node": "aldric_dialogue",
                        "effect": {"charisma": 15, "xp": 20}
                    },
                    {
                        "id": "hunt_dragon",
                        "text": "Hemen ejderhayƒ± takip et",
                        "next_node": "dragon_hunt_start",
                        "effect": {"combat": 20, "xp": 30}
                    },
                    {
                        "id": "gather_info",
                        "text": "K√∂yl√ºlerden bilgi topla",
                        "next_node": "villager_info",
                        "effect": {"charisma": 10, "xp": 15}
                    },
                    {
                        "id": "find_healer",
                        "text": "≈ûifacƒ±yƒ± ara",
                        "next_node": "healer_search",
                        "effect": {"charisma": 10, "xp": 15}
                    }
                ]
            },
            "village_exploration": {
                "id": "village_exploration",
                "title": "K√∂y Ke≈üfi - Detaylƒ± Ara≈ütƒ±rma",
                "description": "K√∂yde dola≈üƒ±rken hasarƒ±n boyutunu g√∂r√ºyorsun. Yanan evlerin kalƒ±ntƒ±larƒ± arasƒ±nda ejderhanƒ±n pen√ße izleri var. K√∂yl√ºler evlerinden √ßƒ±kmaya korkuyor. Bir evin √∂n√ºnde ya≈ülƒ± bir kadƒ±n aƒülƒ±yor - evi yanmƒ±≈ü. Ba≈üka bir yerde √ßocuklar saklanmƒ±≈ü. Ejderhanƒ±n son saldƒ±rƒ±sƒ±ndan sonra k√∂yde panik var. Herkes ne yapacaƒüƒ±nƒ± bilmiyor.",
                "choices": [
                    {
                        "id": "help_villagers",
                        "text": "K√∂yl√ºlere yardƒ±m et ve g√ºven ver",
                        "next_node": "help_villagers",
                        "effect": {"charisma": 20, "xp": 35}
                    },
                    {
                        "id": "search_clues",
                        "text": "Ejderha izlerini detaylƒ± ara≈ütƒ±r",
                        "next_node": "search_clues",
                        "effect": {"investigation": 25, "xp": 30}
                    },
                    {
                        "id": "check_damage",
                        "text": "Hasarƒ± deƒüerlendir ve kaynaklarƒ± kontrol et",
                        "next_node": "damage_assessment",
                        "effect": {"exploration": 20, "xp": 25}
                    },
                    {
                        "id": "gather_info",
                        "text": "K√∂yl√ºlerden ejderha hakkƒ±nda bilgi topla",
                        "next_node": "villager_info",
                        "effect": {"charisma": 15, "xp": 20}
                    }
                ]
            },
            "aldric_dialogue": {
                "id": "aldric_dialogue",
                "title": "üí¨ Aldric ile Derinlemesine G√∂r√º≈üme",
                "description": "Aldric the Wise sizi evine davet ediyor. Eski bir k√ºt√ºphanede oturuyorsunuz. Aldric size ejderhanƒ±n ge√ßmi≈üini anlatƒ±yor: 'Bu ejderha 100 yƒ±l √∂nce bu b√∂lgede ya≈üƒ±yordu. O zamanlar insanlarla barƒ±≈ü i√ßindeydi. Ama sonra bir grup avcƒ± onu yaraladƒ± ve o da intikam almaya ba≈üladƒ±. ≈ûimdi her gece k√∂ye saldƒ±rƒ±yor. Onu durdurmak i√ßin √∂zel bir silah gerekli - Dragonbane Kƒ±lƒ±cƒ±.' Aldric'in g√∂zlerinde gizli bir endi≈üe var. Size √ßok g√ºveniyor gibi g√∂r√ºn√ºyor ama bir ≈üeyler gizliyor olabilir.",
                "choices": [
                    {
                        "id": "trust_aldric",
                        "text": "Aldric'e g√ºven ve planƒ±nƒ± dinle",
                        "next_node": "aldric_trust",
                        "effect": {"charisma": 20, "aldric_trust": 30, "xp": 25}
                    },
                    {
                        "id": "question_aldric",
                        "text": "Aldric'i sorgula ve daha fazla bilgi iste",
                        "next_node": "aldric_interrogation",
                        "effect": {"investigation": 25, "xp": 30}
                    },
                    {
                        "id": "learn_magic",
                        "text": "Aldric'ten sihir √∂ƒüren ve b√ºy√º hazƒ±rla",
                        "next_node": "learn_magic",
                        "effect": {"intelligence": 25, "xp": 45}
                    },
                    {
                        "id": "ask_sword",
                        "text": "Dragonbane Kƒ±lƒ±cƒ± hakkƒ±nda detaylƒ± bilgi al",
                        "next_node": "sword_info",
                        "effect": {"intelligence": 20, "xp": 30}
                    },
                    {
                        "id": "discuss_strategy",
                        "text": "Ejderha ile sava≈ü stratejisi planla",
                        "next_node": "strategy_planning",
                        "effect": {"intelligence": 15, "xp": 25}
                    },
                    {
                        "id": "request_help",
                        "text": "Aldric'ten yardƒ±m iste ve birlikte √ßalƒ±≈ü",
                        "next_node": "aldric_help",
                        "effect": {"charisma": 20, "xp": 30}
                    }
                ]
            },
            "combat_preparation": {
                "id": "combat_preparation",
                "title": "Kapsamlƒ± Sava≈ü Hazƒ±rlƒ±ƒüƒ±",
                "description": "K√∂y√ºn silah deposuna gidiyorsunuz. Eski silahlar, zƒ±rhlar ve sava≈ü ekipmanlarƒ± var. Ayrƒ±ca k√∂yde birka√ß deneyimli sava≈ü√ßƒ± da var. Onlarla birlikte hazƒ±rlƒ±k yapabilirsiniz. Ejderha ile sava≈ümak i√ßin √∂zel ekipmanlar gerekli: ate≈üe dayanƒ±klƒ± zƒ±rh, uzun mƒ±zraklar ve b√ºy√ºl√º silahlar.",
                "choices": [
                    {
                        "id": "gather_weapons",
                        "text": "Silah deposundan ekipman topla",
                        "next_node": "weapon_gathering",
                        "effect": {"combat": 25, "xp": 35}
                    },
                    {
                        "id": "train_warriors",
                        "text": "K√∂y sava≈ü√ßƒ±larƒ±nƒ± eƒüit",
                        "next_node": "warrior_training",
                        "effect": {"combat": 20, "xp": 30}
                    },
                    {
                        "id": "craft_equipment",
                        "text": "√ñzel sava≈ü ekipmanlarƒ± yap",
                        "next_node": "equipment_crafting",
                        "effect": {"intelligence": 20, "xp": 40}
                    },
                    {
                        "id": "scout_area",
                        "text": "Ejderhanƒ±n geli≈ü yollarƒ±nƒ± ke≈üfet",
                        "next_node": "area_scouting",
                        "effect": {"exploration": 25, "xp": 30}
                    }
                ]
            },
            "help_villagers": {
                "id": "help_villagers",
                "title": "K√∂yl√ºlere Yardƒ±m ve G√ºven Verme",
                "description": "K√∂yl√ºlerle konu≈ümaya ba≈ülƒ±yorsunuz. Evsiz kalan ailelere yardƒ±m ediyorsunuz. √áocuklarƒ± sakinle≈ütiriyorsunuz. K√∂yl√ºler size g√ºvenmeye ba≈ülƒ±yor. Bir grup k√∂yl√º size yardƒ±m etmek istiyor. Ayrƒ±ca k√∂yde gizli bir sƒ±ƒüƒ±nak olduƒüunu √∂ƒüreniyorsunuz - ejderha saldƒ±rƒ±larƒ±nda kullanƒ±lƒ±yor.",
                "choices": [
                    {
                        "id": "organize_defense",
                        "text": "K√∂yl√ºleri organize et ve savunma planla",
                        "next_node": "defense_organization",
                        "effect": {"charisma": 25, "xp": 40}
                    },
                    {
                        "id": "build_shelter",
                        "text": "Sƒ±ƒüƒ±naƒüƒ± g√º√ßlendir ve geni≈ület",
                        "next_node": "shelter_improvement",
                        "effect": {"exploration": 20, "xp": 30}
                    },
                    {
                        "id": "distribute_supplies",
                        "text": "Yiyecek ve su daƒüƒ±tƒ±mƒ±nƒ± organize et",
                        "next_node": "supply_management",
                        "effect": {"charisma": 15, "xp": 25}
                    },
                    {
                        "id": "create_watch",
                        "text": "N√∂bet sistemi kur ve g√∂zc√ºler yerle≈ütir",
                        "next_node": "watch_system",
                        "effect": {"exploration": 15, "xp": 20}
                    }
                ]
            },
            "search_clues": {
                "id": "search_clues",
                "title": "Ejderha ƒ∞zlerini Detaylƒ± Ara≈ütƒ±rma",
                "description": "Ejderhanƒ±n bƒ±raktƒ±ƒüƒ± izleri takip ediyorsunuz. Pen√ße izleri, yanƒ±k izleri ve ejderha t√ºyleri buluyorsunuz. Bu izler sizi k√∂y√ºn dƒ±≈üƒ±na, daƒülara doƒüru g√∂t√ºr√ºyor. Ejderhanƒ±n maƒüarasƒ±nƒ±n yakƒ±nlarda olduƒüunu anlƒ±yorsunuz. Ayrƒ±ca ejderhanƒ±n gece saldƒ±rdƒ±ƒüƒ±nƒ± ve g√ºnd√ºz dinlendiƒüini √∂ƒüreniyorsunuz.",
                "choices": [
                    {
                        "id": "follow_tracks",
                        "text": "ƒ∞zleri takip et ve maƒüarayƒ± bul",
                        "next_node": "cave_discovery",
                        "effect": {"exploration": 30, "xp": 45}
                    },
                    {
                        "id": "analyze_evidence",
                        "text": "Bulduƒüun kanƒ±tlarƒ± analiz et",
                        "next_node": "evidence_analysis",
                        "effect": {"investigation": 30, "xp": 40}
                    },
                    {
                        "id": "map_area",
                        "text": "B√∂lgeyi haritalandƒ±r ve stratejik noktalarƒ± belirle",
                        "next_node": "area_mapping",
                        "effect": {"exploration": 25, "xp": 35}
                    },
                    {
                        "id": "return_info",
                        "text": "Bulduƒüun bilgileri k√∂ye geri g√∂t√ºr",
                        "next_node": "info_return",
                        "effect": {"charisma": 15, "xp": 20}
                    }
                ]
            },
            "learn_magic": {
                "id": "learn_magic",
                "title": "Aldric'ten Sihir √ñƒürenme",
                "description": "Aldric size eski b√ºy√ºleri √∂ƒüretiyor. Ejderha kar≈üƒ±tƒ± b√ºy√ºler, koruma b√ºy√ºleri ve ate≈ü kontrol√º b√ºy√ºleri. Bu b√ºy√ºleri √∂ƒürenmek zaman alƒ±yor ama √ßok g√º√ßl√º. Aldric'in k√ºt√ºphanesinde eski b√ºy√º kitaplarƒ± var. Bu b√ºy√ºler ejderha ile sava≈üƒ±rken √ßok i≈üe yarayacak.",
                "choices": [
                    {
                        "id": "master_fire_magic",
                        "text": "Ate≈ü kontrol√º b√ºy√ºlerini ustala≈ütƒ±r",
                        "next_node": "fire_magic_mastery",
                        "effect": {"intelligence": 30, "xp": 50}
                    },
                    {
                        "id": "learn_protection",
                        "text": "Koruma b√ºy√ºlerini √∂ƒüren",
                        "next_node": "protection_magic",
                        "effect": {"intelligence": 25, "xp": 40}
                    },
                    {
                        "id": "study_dragon_magic",
                        "text": "Ejderha kar≈üƒ±tƒ± b√ºy√ºleri √ßalƒ±≈ü",
                        "next_node": "dragon_magic_study",
                        "effect": {"intelligence": 35, "xp": 55}
                    },
                    {
                        "id": "practice_spells",
                        "text": "B√ºy√ºleri pratik et ve g√º√ßlendir",
                        "next_node": "spell_practice",
                        "effect": {"intelligence": 20, "xp": 30}
                    }
                ]
            },
            "cave_discovery": {
                "id": "cave_discovery",
                "title": "Ejderha Maƒüarasƒ±nƒ±n Ke≈üfi",
                "description": "Daƒülarda b√ºy√ºk bir maƒüara buluyorsunuz. Bu ejderhanƒ±n yuvasƒ±. Maƒüaranƒ±n giri≈üinde ejderha kemikleri ve hazine par√ßalarƒ± var. Maƒüaranƒ±n derinliklerinden sƒ±cak hava geliyor. Ejderha ≈üu anda maƒüarada olabilir. Maƒüaraya girmek tehlikeli ama gerekli.",
                "choices": [
                    {
                        "id": "enter_cave",
                        "text": "Maƒüaraya gir ve ejderhayƒ± ara",
                        "next_node": "cave_exploration",
                        "effect": {"exploration": 35, "xp": 50}
                    },
                    {
                        "id": "observe_cave",
                        "text": "Maƒüarayƒ± g√∂zlemle ve strateji planla",
                        "next_node": "cave_observation",
                        "effect": {"investigation": 30, "xp": 40}
                    },
                    {
                        "id": "set_trap",
                        "text": "Maƒüara giri≈üine tuzak kur",
                        "next_node": "trap_setting",
                        "effect": {"intelligence": 25, "xp": 35}
                    },
                    {
                        "id": "return_prepared",
                        "text": "K√∂ye d√∂n ve daha iyi hazƒ±rlan",
                        "next_node": "return_prepared",
                        "effect": {"exploration": 20, "xp": 25}
                    }
                ]
            },
            "cave_exploration": {
                "id": "cave_exploration",
                "title": "Maƒüara ƒ∞√ßinde Tehlikeli Ke≈üif",
                "description": "Maƒüaranƒ±n i√ßinde ilerliyorsunuz. Sƒ±cak hava ve k√ºk√ºrt kokusu var. Maƒüaranƒ±n duvarlarƒ±nda ejderha √ßizimleri var. Derinliklerde ejderhanƒ±n hazinesi olabilir. Ama ejderha da yakƒ±nda olabilir. Maƒüarada ba≈üka tehlikeler de var: zehirli gazlar, d√º≈üen kayalar ve karanlƒ±k yaratƒ±klar.",
                "choices": [
                    {
                        "id": "find_treasure",
                        "text": "Ejderha hazinesini ara",
                        "next_node": "treasure_hunt",
                        "effect": {"exploration": 40, "xp": 60}
                    },
                    {
                        "id": "confront_dragon",
                        "text": "Ejderhayƒ± bul ve y√ºzle≈ü",
                        "next_node": "dragon_confrontation",
                        "effect": {"combat": 40, "xp": 70}
                    },
                    {
                        "id": "explore_deeper",
                        "text": "Maƒüaranƒ±n daha derinlerine git",
                        "next_node": "deep_cave",
                        "effect": {"exploration": 35, "xp": 50}
                    },
                    {
                        "id": "escape_cave",
                        "text": "Maƒüaradan √ßƒ±k ve g√ºvenliƒüe ka√ß",
                        "next_node": "cave_escape",
                        "effect": {"exploration": 25, "xp": 30}
                    }
                ]
            },
            "dragon_confrontation": {
                "id": "dragon_confrontation",
                "title": "Ejderha ile Epik Kar≈üƒ±la≈üma",
                "description": "Maƒüaranƒ±n en derininde ejderhayƒ± buluyorsunuz. Kƒ±zƒ±l ejderha b√ºy√ºk ve korkun√ß. Alevler sa√ßƒ±yor ve √∂fkeyle k√ºk√ºr√ºyor. Bu sizin hayatƒ±nƒ±zƒ±n en b√ºy√ºk sava≈üƒ± olacak. Ejderha size saldƒ±rƒ±yor! Sava≈ü ba≈ülƒ±yor...",
                "choices": [
                    {
                        "id": "fight_dragon",
                        "text": "Ejderha ile sava≈ü ve onu yen",
                        "next_node": "epic_battle",
                        "effect": {"combat": 50, "xp": 100}
                    },
                    {
                        "id": "use_magic",
                        "text": "B√ºy√ºlerini kullan ve ejderhayƒ± zayƒ±flat",
                        "next_node": "magic_battle",
                        "effect": {"intelligence": 45, "xp": 90}
                    },
                    {
                        "id": "negotiate",
                        "text": "Ejderha ile konu≈ümaya √ßalƒ±≈ü",
                        "next_node": "dragon_negotiation",
                        "effect": {"charisma": 40, "xp": 80}
                    },
                    {
                        "id": "strategic_retreat",
                        "text": "Stratejik geri √ßekilme yap",
                        "next_node": "strategic_retreat",
                        "effect": {"combat": 30, "xp": 50}
                    }
                ]
            },
            "epic_battle": {
                "id": "epic_battle",
                "title": "Epik Sava≈ü - Ejderha ile Son Kar≈üƒ±la≈üma",
                "description": "Ejderha ile epik sava≈ü ba≈ülƒ±yor! Alevler her yerde, maƒüara sallanƒ±yor. Bu sava≈ü saatlerce s√ºrebilir. Ejderha g√º√ßl√º ama siz de hazƒ±rlƒ±klƒ±sƒ±nƒ±z. Her vuru≈ü, her b√ºy√º √∂nemli. Bu sava≈üƒ±n sonucu k√∂y√ºn kaderini belirleyecek.",
                "choices": [
                    {
                        "id": "final_strike",
                        "text": "Son vuru≈üu yap ve ejderhayƒ± √∂ld√ºr",
                        "next_node": "dragon_defeat",
                        "effect": {"combat": 60, "xp": 150}
                    },
                    {
                        "id": "magic_final",
                        "text": "Son b√ºy√ºy√º kullan ve ejderhayƒ± yok et",
                        "next_node": "magic_victory",
                        "effect": {"intelligence": 55, "xp": 140}
                    },
                    {
                        "id": "team_attack",
                        "text": "K√∂yl√ºlerle birlikte saldƒ±r",
                        "next_node": "team_victory",
                        "effect": {"charisma": 50, "xp": 130}
                    },
                    {
                        "id": "dragon_banish",
                        "text": "Ejderhayƒ± s√ºrg√ºn et ve uzakla≈ütƒ±r",
                        "next_node": "dragon_banishment",
                        "effect": {"intelligence": 45, "xp": 120}
                    }
                ]
            },
            "dragon_defeat": {
                "id": "dragon_defeat",
                "title": "Ejderha Yenildi - Zafer!",
                "description": "Son vuru≈üunuzla ejderhayƒ± √∂ld√ºrd√ºn√ºz! Ejderha yere d√º≈ü√ºyor ve artƒ±k hareket etmiyor. Maƒüara sakinle≈üiyor. K√∂y artƒ±k g√ºvende. Bu b√ºy√ºk bir zafer! K√∂yl√ºler sizi kahraman olarak kar≈üƒ±layacak. Ejderhanƒ±n hazinesi de sizin olacak.",
                "choices": [
                    {
                        "id": "return_victory",
                        "text": "K√∂ye zaferle d√∂n",
                        "next_node": "victory_return",
                        "effect": {"charisma": 60, "xp": 200}
                    },
                    {
                        "id": "claim_treasure",
                        "text": "Ejderha hazinesini topla",
                        "next_node": "treasure_claim",
                        "effect": {"exploration": 50, "xp": 180}
                    },
                    {
                        "id": "heal_wounds",
                        "text": "Yaralarƒ±nƒ± iyile≈ütir",
                        "next_node": "healing_rest",
                        "effect": {"charisma": 30, "xp": 100}
                    },
                    {
                        "id": "celebrate",
                        "text": "Zaferi kutla",
                        "next_node": "victory_celebration",
                        "effect": {"charisma": 40, "xp": 120}
                    }
                ]
            },
            "victory_return": {
                "id": "victory_return",
                "title": "K√∂ye Zaferle D√∂n√º≈ü",
                "description": "K√∂ye d√∂nd√ºƒü√ºn√ºzde herkes sizi kar≈üƒ±lƒ±yor. K√∂yl√ºler sevin√ßle aƒülƒ±yor. Ejderha √∂ld√º! K√∂y artƒ±k g√ºvende. Aldric size te≈üekk√ºr ediyor. K√∂yl√ºler sizi kahraman ilan ediyor. Bu g√ºn k√∂y√ºn tarihinde altƒ±n harflerle yazƒ±lacak.",
                "choices": [
                    {
                        "id": "accept_honor",
                        "text": "Kahramanlƒ±k onurunu kabul et",
                        "next_node": "hero_honor",
                        "effect": {"charisma": 70, "xp": 250}
                    },
                    {
                        "id": "rebuild_village",
                        "text": "K√∂y√º yeniden in≈üa etmeye yardƒ±m et",
                        "next_node": "village_rebuilding",
                        "effect": {"charisma": 60, "xp": 200}
                    },
                    {
                        "id": "share_glory",
                        "text": "Zaferi k√∂yl√ºlerle payla≈ü",
                        "next_node": "glory_sharing",
                        "effect": {"charisma": 65, "xp": 220}
                    },
                    {
                        "id": "end_adventure",
                        "text": "Macerayƒ± sonlandƒ±r",
                        "next_node": "end",
                        "effect": {"xp": 300}
                    }
                ]
            },
            "aldric_help": {
                "id": "aldric_help",
                "title": "Aldric'ten Yardƒ±m Alma",
                "description": "Aldric size yardƒ±m etmeyi kabul ediyor. Birlikte hazƒ±rlƒ±k yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "continue_quest",
                        "text": "G√∂reve devam et",
                        "next_node": "cave_discovery",
                        "effect": {"aldric_trust": 25, "xp": 40}
                    }
                ]
            },
            "area_mapping": {
                "id": "area_mapping",
                "title": "B√∂lge Haritalandƒ±rma",
                "description": "B√∂lgeyi detaylƒ± haritalandƒ±rƒ±yorsunuz ve stratejik noktalarƒ± belirliyorsunuz.",
                "choices": [
                    {
                        "id": "plan_strategy",
                        "text": "Strateji planla",
                        "next_node": "strategy_planning",
                        "effect": {"exploration": 30, "xp": 45}
                    }
                ]
            },
            "area_scouting": {
                "id": "area_scouting",
                "title": "B√∂lge Ke≈üfi",
                "description": "Ejderhanƒ±n geli≈ü yollarƒ±nƒ± ke≈üfediyorsunuz.",
                "choices": [
                    {
                        "id": "continue_scouting",
                        "text": "Ke≈üfe devam et",
                        "next_node": "cave_discovery",
                        "effect": {"exploration": 35, "xp": 50}
                    }
                ]
            },
            "cave_escape": {
                "id": "cave_escape",
                "title": "Maƒüaradan Ka√ßƒ±≈ü",
                "description": "Maƒüaradan g√ºvenli bir ≈üekilde √ßƒ±kƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "regroup",
                        "text": "Yeniden toparlan",
                        "next_node": "combat_preparation",
                        "effect": {"exploration": 20, "xp": 30}
                    }
                ]
            },
            "cave_observation": {
                "id": "cave_observation",
                "title": "Maƒüara G√∂zlemi",
                "description": "Maƒüarayƒ± dikkatle g√∂zlemleyip strateji planlƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "enter_carefully",
                        "text": "Dikkatli gir",
                        "next_node": "cave_exploration",
                        "effect": {"investigation": 35, "xp": 50}
                    }
                ]
            },
            "damage_assessment": {
                "id": "damage_assessment",
                "title": "Hasar Deƒüerlendirmesi",
                "description": "K√∂ydeki hasarƒ± deƒüerlendirip kaynaklarƒ± kontrol ediyorsunuz.",
                "choices": [
                    {
                        "id": "organize_repair",
                        "text": "Onarƒ±m organize et",
                        "next_node": "village_rebuilding",
                        "effect": {"exploration": 25, "xp": 35}
                    }
                ]
            },
            "deep_cave": {
                "id": "deep_cave",
                "title": "Derin Maƒüara Ke≈üfi",
                "description": "Maƒüaranƒ±n daha derinlerine gidiyorsunuz.",
                "choices": [
                    {
                        "id": "find_dragon",
                        "text": "Ejderhayƒ± bul",
                        "next_node": "dragon_confrontation",
                        "effect": {"exploration": 40, "xp": 60}
                    }
                ]
            },
            "defense_organization": {
                "id": "defense_organization",
                "title": "Savunma Organizasyonu",
                "description": "K√∂yl√ºleri organize ediyorsunuz. Savunma planƒ± hazƒ±rlƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "prepare_battle",
                        "text": "Sava≈ü hazƒ±rlƒ±ƒüƒ± yap",
                        "next_node": "combat_preparation",
                        "effect": {"charisma": 30, "xp": 45}
                    },
                    {
                        "id": "search_clues",
                        "text": "ƒ∞z ara≈ütƒ±r",
                        "next_node": "search_clues",
                        "effect": {"investigation": 25, "xp": 35}
                    },
                    {
                        "id": "gather_intel",
                        "text": "Bilgi topla",
                        "next_node": "villager_info",
                        "effect": {"charisma": 20, "xp": 30}
                    }
                ]
            },
            "dragon_banishment": {
                "id": "dragon_banishment",
                "title": "Ejderha S√ºrg√ºn√º",
                "description": "Ejderhayƒ± s√ºrg√ºn edip uzakla≈ütƒ±rƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "return_victorious",
                        "text": "Zaferle d√∂n",
                        "next_node": "victory_return",
                        "effect": {"intelligence": 50, "xp": 120}
                    }
                ]
            },
            "dragon_magic_study": {
                "id": "dragon_magic_study",
                "title": "Ejderha B√ºy√ºleri √áalƒ±≈ümasƒ±",
                "description": "Ejderha kar≈üƒ±tƒ± b√ºy√ºleri √ßalƒ±≈üƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "master_spells",
                        "text": "B√ºy√ºleri ustala≈ütƒ±r",
                        "next_node": "spell_practice",
                        "effect": {"intelligence": 40, "xp": 60}
                    }
                ]
            },
            "dragon_negotiation": {
                "id": "dragon_negotiation",
                "title": "Ejderha ile M√ºzakere",
                "description": "Ejderha ile konu≈ümaya √ßalƒ±≈üƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "peaceful_solution",
                        "text": "Barƒ±≈ü√ßƒ±l √ß√∂z√ºm",
                        "next_node": "victory_return",
                        "effect": {"charisma": 50, "xp": 100}
                    },
                    {
                        "id": "failed_negotiation",
                        "text": "M√ºzakere ba≈üarƒ±sƒ±z",
                        "next_node": "epic_battle",
                        "effect": {"charisma": 25, "xp": 50}
                    }
                ]
            },
            "equipment_crafting": {
                "id": "equipment_crafting",
                "title": "Ekipman √úretimi",
                "description": "√ñzel sava≈ü ekipmanlarƒ± yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "craft_weapons",
                        "text": "Silah yap",
                        "next_node": "weapon_gathering",
                        "effect": {"intelligence": 30, "xp": 45}
                    }
                ]
            },
            "evidence_analysis": {
                "id": "evidence_analysis",
                "title": "Kanƒ±t Analizi",
                "description": "Bulduƒüunuz kanƒ±tlarƒ± analiz ediyorsunuz.",
                "choices": [
                    {
                        "id": "follow_trail",
                        "text": "ƒ∞zi takip et",
                        "next_node": "cave_discovery",
                        "effect": {"investigation": 35, "xp": 50}
                    }
                ]
            },
            "fire_magic_mastery": {
                "id": "fire_magic_mastery",
                "title": "Ate≈ü B√ºy√ºs√º Ustalƒ±ƒüƒ±",
                "description": "Ate≈ü kontrol√º b√ºy√ºlerini ustala≈ütƒ±rƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "use_against_dragon",
                        "text": "Ejderhaya kar≈üƒ± kullan",
                        "next_node": "dragon_confrontation",
                        "effect": {"intelligence": 40, "xp": 70}
                    }
                ]
            },
            "glory_sharing": {
                "id": "glory_sharing",
                "title": "Zafer Payla≈üƒ±mƒ±",
                "description": "Zaferi k√∂yl√ºlerle payla≈üƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "end_story",
                        "text": "Hikayeyi sonlandƒ±r",
                        "next_node": "end",
                        "effect": {"charisma": 60, "xp": 100}
                    }
                ]
            },
            "healer_search": {
                "id": "healer_search",
                "title": "≈ûifacƒ± Arayƒ±≈üƒ±",
                "description": "Yaralƒ±larƒ± kontrol edip ≈üifacƒ±yƒ± buluyorsunuz.",
                "choices": [
                    {
                        "id": "help_healer",
                        "text": "≈ûifacƒ±ya yardƒ±m et",
                        "next_node": "healer_help",
                        "effect": {"charisma": 15, "xp": 25}
                    },
                    {
                        "id": "learn_healing",
                        "text": "≈ûifa sanatƒ±nƒ± √∂ƒüren",
                        "next_node": "healing_lesson",
                        "effect": {"intelligence": 20, "xp": 30}
                    },
                    {
                        "id": "return_village",
                        "text": "K√∂ye geri d√∂n",
                        "next_node": "start",
                        "effect": {"exploration": 10, "xp": 15}
                    }
                ]
            },
            "healer_help": {
                "id": "healer_help",
                "title": "≈ûifacƒ±ya Yardƒ±m",
                "description": "≈ûifacƒ±ya yardƒ±m ediyorsunuz ve yaralƒ±larƒ± tedavi ediyorsunuz.",
                "choices": [
                    {
                        "id": "continue_healing",
                        "text": "Tedaviye devam et",
                        "next_node": "healing_lesson",
                        "effect": {"charisma": 20, "xp": 35}
                    },
                    {
                        "id": "prepare_for_quest",
                        "text": "G√∂reve hazƒ±rlan",
                        "next_node": "combat_preparation",
                        "effect": {"charisma": 15, "xp": 25}
                    }
                ]
            },
            "healing_lesson": {
                "id": "healing_lesson",
                "title": "≈ûifa Sanatƒ± Dersi",
                "description": "≈ûifa sanatƒ±nƒ± √∂ƒüreniyorsunuz ve iyile≈ütirme b√ºy√ºlerini √ßalƒ±≈üƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "master_healing",
                        "text": "≈ûifayƒ± ustala≈ütƒ±r",
                        "next_node": "combat_preparation",
                        "effect": {"intelligence": 30, "xp": 50}
                    },
                    {
                        "id": "return_to_quest",
                        "text": "G√∂reve d√∂n",
                        "next_node": "search_clues",
                        "effect": {"intelligence": 20, "xp": 35}
                    }
                ]
            },
            "healing_rest": {
                "id": "healing_rest",
                "title": "≈ûifa ve Dinlenme",
                "description": "Yaralarƒ±nƒ±zƒ± iyile≈ütirip dinleniyorsunuz.",
                "choices": [
                    {
                        "id": "celebrate_victory",
                        "text": "Zaferi kutla",
                        "next_node": "victory_celebration",
                        "effect": {"charisma": 30, "xp": 50}
                    }
                ]
            },
            "hero_honor": {
                "id": "hero_honor",
                "title": "Kahramanlƒ±k Onuru",
                "description": "Kahramanlƒ±k onurunu kabul ediyorsunuz.",
                "choices": [
                    {
                        "id": "end_story",
                        "text": "Hikayeyi sonlandƒ±r",
                        "next_node": "end",
                        "effect": {"charisma": 80, "xp": 150}
                    }
                ]
            },
            "hero_rest": {
                "id": "hero_rest",
                "title": "Kahraman Dinlenmesi",
                "description": "Zorlu m√ºcadeleden sonra dinleniyorsunuz.",
                "choices": [
                    {
                        "id": "return_home",
                        "text": "Eve d√∂n",
                        "next_node": "victory_return",
                        "effect": {"charisma": 25, "xp": 35}
                    }
                ]
            },
            "info_return": {
                "id": "info_return",
                "title": "Bilgi Getirme",
                "description": "Bulduƒüunuz bilgileri k√∂ye geri g√∂t√ºr√ºyorsunuz.",
                "choices": [
                    {
                        "id": "share_info",
                        "text": "Bilgiyi payla≈ü",
                        "next_node": "strategy_planning",
                        "effect": {"charisma": 20, "xp": 30}
                    }
                ]
            },
            "magic_battle": {
                "id": "magic_battle",
                "title": "B√ºy√ºl√º Sava≈ü",
                "description": "B√ºy√ºlerinizi kullanarak ejderhayƒ± zayƒ±flatƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "final_magic",
                        "text": "Son b√ºy√ºy√º kullan",
                        "next_node": "magic_victory",
                        "effect": {"intelligence": 50, "xp": 90}
                    }
                ]
            },
            "magic_victory": {
                "id": "magic_victory",
                "title": "B√ºy√ºl√º Zafer",
                "description": "Son b√ºy√ºy√º kullanarak ejderhayƒ± yok ediyorsunuz.",
                "choices": [
                    {
                        "id": "claim_victory",
                        "text": "Zaferi ilan et",
                        "next_node": "victory_return",
                        "effect": {"intelligence": 60, "xp": 120}
                    }
                ]
            },
            "protection_magic": {
                "id": "protection_magic",
                "title": "Koruma B√ºy√ºleri",
                "description": "Koruma b√ºy√ºlerini √∂ƒüreniyorsunuz.",
                "choices": [
                    {
                        "id": "enhance_protection",
                        "text": "Korunmayƒ± g√º√ßlendir",
                        "next_node": "combat_preparation",
                        "effect": {"intelligence": 30, "xp": 45}
                    }
                ]
            },
            "return_prepared": {
                "id": "return_prepared",
                "title": "Hazƒ±rlƒ±klƒ± D√∂n√º≈ü",
                "description": "K√∂ye d√∂n√ºp daha iyi hazƒ±rlanƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "better_preparation",
                        "text": "Daha iyi hazƒ±rlan",
                        "next_node": "combat_preparation",
                        "effect": {"exploration": 25, "xp": 35}
                    }
                ]
            },
            "shelter_improvement": {
                "id": "shelter_improvement",
                "title": "Sƒ±ƒüƒ±nak Geli≈ütirme",
                "description": "Sƒ±ƒüƒ±naƒüƒ± g√º√ßlendirip geni≈ületiyorsunuz.",
                "choices": [
                    {
                        "id": "organize_people",
                        "text": "ƒ∞nsanlarƒ± organize et",
                        "next_node": "defense_organization",
                        "effect": {"exploration": 25, "xp": 35}
                    }
                ]
            },
            "spell_practice": {
                "id": "spell_practice",
                "title": "B√ºy√º Pratiƒüi",
                "description": "B√ºy√ºleri pratik edip g√º√ßlendiriyorsunuz.",
                "choices": [
                    {
                        "id": "master_magic",
                        "text": "B√ºy√ºy√º ustala≈ütƒ±r",
                        "next_node": "fire_magic_mastery",
                        "effect": {"intelligence": 25, "xp": 40}
                    }
                ]
            },
            "strategic_retreat": {
                "id": "strategic_retreat",
                "title": "Stratejik Geri √áekilme",
                "description": "Stratejik geri √ßekilme yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "regroup_and_plan",
                        "text": "Yeniden toparlan ve planla",
                        "next_node": "strategy_planning",
                        "effect": {"strategy": 30, "xp": 45}
                    }
                ]
            },
            "strategy_planning": {
                "id": "strategy_planning",
                "title": "Strateji Planlama",
                "description": "Ejderha ile sava≈ü stratejisi planlƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "execute_plan",
                        "text": "Planƒ± uygula",
                        "next_node": "dragon_confrontation",
                        "effect": {"strategy": 35, "xp": 50}
                    }
                ]
            },
            "supply_management": {
                "id": "supply_management",
                "title": "Tedarik Y√∂netimi",
                "description": "Yiyecek ve su daƒüƒ±tƒ±mƒ±nƒ± organize ediyorsunuz.",
                "choices": [
                    {
                        "id": "organize_supplies",
                        "text": "Malzemeleri organize et",
                        "next_node": "defense_organization",
                        "effect": {"charisma": 20, "xp": 30}
                    }
                ]
            },
            "sword_info": {
                "id": "sword_info",
                "title": "Dragonbane Kƒ±lƒ±cƒ± Bilgisi",
                "description": "Dragonbane Kƒ±lƒ±cƒ± hakkƒ±nda detaylƒ± bilgi alƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "seek_sword",
                        "text": "Kƒ±lƒ±cƒ± ara",
                        "next_node": "weapon_gathering",
                        "effect": {"intelligence": 25, "xp": 40}
                    }
                ]
            },
            "team_victory": {
                "id": "team_victory",
                "title": "Takƒ±m Zaferi",
                "description": "K√∂yl√ºlerle birlikte saldƒ±rƒ±p ejderhayƒ± yeniyorsunuz.",
                "choices": [
                    {
                        "id": "celebrate_together",
                        "text": "Birlikte kutlayƒ±n",
                        "next_node": "victory_celebration",
                        "effect": {"charisma": 50, "xp": 100}
                    }
                ]
            },
            "trap_setting": {
                "id": "trap_setting",
                "title": "Tuzak Kurma",
                "description": "Maƒüara giri≈üine tuzak kuruyorsunuz.",
                "choices": [
                    {
                        "id": "wait_for_dragon",
                        "text": "Ejderhayƒ± bekle",
                        "next_node": "dragon_confrontation",
                        "effect": {"strategy": 30, "xp": 45}
                    }
                ]
            },
            "treasure_claim": {
                "id": "treasure_claim",
                "title": "Hazine Toplama",
                "description": "Ejderha hazinesini topluyorsunuz.",
                "choices": [
                    {
                        "id": "return_with_treasure",
                        "text": "Hazine ile d√∂n",
                        "next_node": "victory_return",
                        "effect": {"exploration": 40, "xp": 80}
                    }
                ]
            },
            "treasure_hunt": {
                "id": "treasure_hunt",
                "title": "Hazine Arayƒ±≈üƒ±",
                "description": "Ejderha hazinesini arƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "find_treasure",
                        "text": "Hazineyi bul",
                        "next_node": "treasure_claim",
                        "effect": {"exploration": 35, "xp": 60}
                    }
                ]
            },
            "victory_celebration": {
                "id": "victory_celebration",
                "title": "Zafer Kutlamasƒ±",
                "description": "Zaferi kutluyorsunuz.",
                "choices": [
                    {
                        "id": "end_celebration",
                        "text": "Kutlamayƒ± bitir",
                        "next_node": "end",
                        "effect": {"charisma": 45, "xp": 70}
                    }
                ]
            },
            "village_rebuilding": {
                "id": "village_rebuilding",
                "title": "K√∂y Yeniden ƒ∞n≈üasƒ±",
                "description": "K√∂y√º yeniden in≈üa etmeye yardƒ±m ediyorsunuz.",
                "choices": [
                    {
                        "id": "complete_rebuilding",
                        "text": "ƒ∞n≈üayƒ± tamamla",
                        "next_node": "end",
                        "effect": {"charisma": 60, "xp": 120}
                    }
                ]
            },
            "villager_info": {
                "id": "villager_info",
                "title": "K√∂yl√º Bilgileri",
                "description": "K√∂yl√ºlerden ejderha hakkƒ±nda bilgi topluyorsunuz.",
                "choices": [
                    {
                        "id": "use_info",
                        "text": "Bilgiyi kullan",
                        "next_node": "strategy_planning",
                        "effect": {"charisma": 20, "xp": 30}
                    }
                ]
            },
            "warrior_training": {
                "id": "warrior_training",
                "title": "Sava≈ü√ßƒ± Eƒüitimi",
                "description": "K√∂y sava≈ü√ßƒ±larƒ±nƒ± eƒüitiyorsunuz.",
                "choices": [
                    {
                        "id": "prepare_battle_group",
                        "text": "Sava≈ü grubunu hazƒ±rla",
                        "next_node": "combat_preparation",
                        "effect": {"combat": 25, "xp": 40}
                    }
                ]
            },
            "watch_system": {
                "id": "watch_system",
                "title": "N√∂bet Sistemi",
                "description": "N√∂bet sistemi kurup g√∂zc√ºler yerle≈ütiriyorsunuz.",
                "choices": [
                    {
                        "id": "secure_village",
                        "text": "K√∂y√º g√ºvenli hale getir",
                        "next_node": "defense_organization",
                        "effect": {"exploration": 20, "xp": 30}
                    }
                ]
            },
            "weapon_gathering": {
                "id": "weapon_gathering",
                "title": "Silah Toplama",
                "description": "Silah deposundan ekipman topluyorsunuz.",
                "choices": [
                    {
                        "id": "prepare_for_battle",
                        "text": "Sava≈üa hazƒ±rlan",
                        "next_node": "dragon_confrontation",
                        "effect": {"combat": 30, "xp": 50}
                    }
                ]
            },
            "dragon_confrontation": {
                "id": "dragon_confrontation",
                "title": "üêâ Ejderha ile Y√ºzle≈üme - ƒ∞lk Sava≈ü",
                "description": "Ejderha maƒüarasƒ±nƒ±n √∂n√ºndesiniz. Kƒ±zƒ±l ejderha sizi g√∂r√ºyor ve k√ºkremeye ba≈ülƒ±yor! Bu devasa yaratƒ±k ate≈ü p√ºsk√ºrt√ºyor ve pen√ßeleriyle saldƒ±rƒ±yor. Sava≈ü ba≈ülƒ±yor! Ejderha √ßok g√º√ßl√º ama siz hazƒ±rlƒ±klƒ±sƒ±nƒ±z. Bu sava≈ü k√∂y√ºn kaderini belirleyecek!",
                "choices": [
                    {
                        "id": "melee_attack",
                        "text": "Yakƒ±n d√∂v√º≈ü saldƒ±rƒ±sƒ± yap",
                        "next_node": "melee_dragon_battle",
                        "effect": {"combat": 40, "xp": 70}
                    },
                    {
                        "id": "ranged_attack",
                        "text": "Uzaktan saldƒ±rƒ± yap",
                        "next_node": "ranged_dragon_battle",
                        "effect": {"combat": 35, "xp": 60}
                    },
                    {
                        "id": "magic_attack",
                        "text": "B√ºy√º ile saldƒ±r",
                        "next_node": "magic_dragon_battle",
                        "effect": {"combat": 45, "xp": 80}
                    },
                    {
                        "id": "tactical_retreat",
                        "text": "Taktiksel geri √ßekilme",
                        "next_node": "tactical_retreat",
                        "effect": {"strategy": 30, "xp": 50}
                    }
                ]
            },
            "melee_dragon_battle": {
                "id": "melee_dragon_battle",
                "text": "‚öîÔ∏è Yakƒ±n D√∂v√º≈ü - Ejderha Sava≈üƒ±",
                "description": "Ejderha ile yakƒ±n d√∂v√º≈üe girdiniz! Kƒ±lƒ±cƒ±nƒ±zla ejderhanƒ±n pullarƒ±na saldƒ±rƒ±yorsunuz. Ejderha da pen√ßeleriyle kar≈üƒ±lƒ±k veriyor. Bu √ßok tehlikeli bir sava≈ü! Ejderha'nƒ±n ate≈üi sizi yakƒ±yor ama siz de onu yaralƒ±yorsunuz. Sava≈ü devam ediyor!",
                "choices": [
                    {
                        "id": "continue_melee",
                        "text": "Yakƒ±n d√∂v√º≈üe devam et",
                        "next_node": "intense_melee_battle",
                        "effect": {"combat": 50, "xp": 90}
                    },
                    {
                        "id": "use_special_weapon",
                        "text": "√ñzel silah kullan",
                        "next_node": "special_weapon_battle",
                        "effect": {"combat": 60, "xp": 110}
                    },
                    {
                        "id": "call_villagers",
                        "text": "K√∂yl√ºlerden yardƒ±m iste",
                        "next_node": "villager_assistance",
                        "effect": {"charisma": 40, "combat": 35, "xp": 85}
                    },
                    {
                        "id": "dragon_weakness",
                        "text": "Ejderha'nƒ±n zayƒ±f noktasƒ±nƒ± ara",
                        "next_node": "dragon_weakness_search",
                        "effect": {"investigation": 45, "combat": 30, "xp": 80}
                    }
                ]
            },
            "intense_melee_battle": {
                "id": "intense_melee_battle",
                "title": "üî• Yoƒüun Yakƒ±n D√∂v√º≈ü",
                "description": "Ejderha ile yoƒüun bir yakƒ±n d√∂v√º≈üe girdiniz! Her saldƒ±rƒ±nƒ±z ejderha'yƒ± yaralƒ±yor ama o da sizi yakƒ±yor. Kan ve ate≈ü! Ejderha'nƒ±n kuyruƒüu sizi vuruyor ama siz de kƒ±lƒ±cƒ±nƒ±zla onun kanadƒ±nƒ± yaralƒ±yorsunuz. Bu sava≈ü √ßok kritik!",
                "choices": [
                    {
                        "id": "final_strike",
                        "text": "Son vuru≈üu yap",
                        "next_node": "dragon_final_battle",
                        "effect": {"combat": 70, "xp": 130}
                    },
                    {
                        "id": "defensive_stance",
                        "text": "Savunma pozisyonu al",
                        "next_node": "defensive_battle",
                        "effect": {"combat": 45, "xp": 75}
                    },
                    {
                        "id": "use_potion",
                        "text": "≈ûifa iksiri kullan",
                        "next_node": "potion_enhanced_battle",
                        "effect": {"combat": 55, "xp": 95}
                    },
                    {
                        "id": "dragon_rage",
                        "text": "Ejderha'nƒ±n √∂fkesini y√∂nlendir",
                        "next_node": "dragon_rage_battle",
                        "effect": {"strategy": 50, "combat": 40, "xp": 100}
                    }
                ]
            },
            "dragon_final_battle": {
                "id": "dragon_final_battle",
                "title": "‚öîÔ∏è Ejderha ile Final Sava≈üƒ±",
                "description": "Ejderha ile final sava≈üƒ±ndasƒ±nƒ±z! Her ikiniz de yaralƒ±sƒ±nƒ±z ama sava≈ü devam ediyor. Ejderha son g√ºc√ºyle ate≈ü p√ºsk√ºrt√ºyor! Siz de son saldƒ±rƒ±nƒ±zƒ± yapƒ±yorsunuz. Bu an k√∂y√ºn kaderini belirleyecek! Kƒ±lƒ±cƒ±nƒ±z ejderha'nƒ±n kalbine saplanƒ±yor!",
                "choices": [
                    {
                        "id": "victory_celebration",
                        "text": "Zafer kutlamasƒ±",
                        "next_node": "dragon_victory",
                        "effect": {"combat": 80, "charisma": 50, "xp": 150}
                    },
                    {
                        "id": "dragon_mercy",
                        "text": "Ejderha'ya merhamet g√∂ster",
                        "next_node": "dragon_mercy_ending",
                        "effect": {"charisma": 60, "xp": 120}
                    },
                    {
                        "id": "collect_treasure",
                        "text": "Ejderha hazinesini topla",
                        "next_node": "treasure_collection",
                        "effect": {"exploration": 50, "xp": 100}
                    },
                    {
                        "id": "return_hero",
                        "text": "Kahraman olarak k√∂ye d√∂n",
                        "next_node": "hero_return",
                        "effect": {"charisma": 70, "xp": 140}
                    }
                ]
            },
            "dragon_victory": {
                "id": "dragon_victory",
                "title": "üèÜ Ejderha Zaferi",
                "description": "EJDERHAYI YENDƒ∞Nƒ∞Z! üéâ K√∂y√ºn √ºzerindeki tehdit ortadan kalktƒ±. K√∂yl√ºler sevin√ßle size ko≈üuyor. 'Kahraman! Kahraman!' diye baƒüƒ±rƒ±yorlar. Ejderha'nƒ±n cesedi maƒüaranƒ±n √∂n√ºnde yatƒ±yor. Artƒ±k k√∂y g√ºvende!",
                "choices": [
                    {
                        "id": "celebrate_with_villagers",
                        "text": "K√∂yl√ºlerle kutlama yap",
                        "next_node": "victory_celebration",
                        "effect": {"charisma": 60, "xp": 100}
                    },
                    {
                        "id": "dragon_remains",
                        "text": "Ejderha kalƒ±ntƒ±larƒ±nƒ± incele",
                        "next_node": "dragon_remains_study",
                        "effect": {"investigation": 50, "xp": 80}
                    },
                    {
                        "id": "village_rebuilding",
                        "text": "K√∂y√º yeniden in≈üa et",
                        "next_node": "village_rebuilding",
                        "effect": {"charisma": 40, "xp": 70}
                    },
                    {
                        "id": "new_adventures",
                        "text": "Yeni maceralara hazƒ±rlan",
                        "next_node": "new_adventures_prep",
                        "effect": {"exploration": 45, "xp": 75}
                    }
                ]
            },
            "end": {
                "id": "end",
                "title": "Macera Sonu - Kahramanlƒ±k",
                "description": "Ejderhayƒ± yendiniz ve k√∂y√º kurtardƒ±nƒ±z! Bu b√ºy√ºk bir ba≈üarƒ±. K√∂yl√ºler size sonsuz minnettar. Artƒ±k bu b√∂lgede g√ºvenle ya≈üayabilirler. Siz de ger√ßek bir kahraman oldunuz. Bu macera sizi deƒüi≈ütirdi ve g√º√ßlendirdi. Yeni maceralar sizi bekliyor...",
                "choices": [
                    {
                        "id": "new_adventure",
                        "text": "Yeni maceraya ba≈üla",
                        "next_node": "start",
                        "effect": {"xp": 50}
                    },
                    {
                        "id": "rest_hero",
                        "text": "Kahraman olarak dinlen",
                        "next_node": "hero_rest",
                        "effect": {"charisma": 30, "xp": 100}
                    }
                ]
            }
        }
    },
    # ============== CYBERPUNK SENARYO ==============
    "neon_city_runners": {
        "id": "neon_city_runners",
        "title": "üåÉ Neon City Runners - Cyberpunk Macera",
        "genre": "cyberpunk",
        "description": "2087 yƒ±lƒ±nda mega ≈üehir Neo-Tokyo'da ge√ßen siber-punk macera. Hackerlar, korporasyonlar ve AI'lar arasƒ±ndaki sava≈üta hayatta kalabilecek misin?",
        "difficulty": "very_hard",
        "theme": "cyberpunk",
        "complexity": "extreme",
        "estimatedPlayTime": 480,
        "levels": {
            "level_1": {
                "title": "Street Hacker",
                "min_level": 1,
                "max_level": 8,
                "enemies": ["Security Drones", "Corporate Guards", "Gang Members"],
                "boss": "Cyber Assassin"
            }
        },
        "npc_relationships": {
            "zara": {
                "name": "Zara the Netrunner",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "high"
            },
            "rex": {
                "name": "Rex Steel - Cyber Mercenary", 
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "enemy",
                "ending_impact": "extreme"
            },
            "ghost": {
                "name": "Ghost - Legendary Netrunner",
                "backstory": "Former corporate programmer who became a digital entity",
                "personality": "Paranoid, brilliant, addicted to the digital realm",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "extreme",
                "quest_offers": ["Corporate Hack", "Digital Consciousness", "Reality Manipulation"]
            },
            "king_jax": {
                "name": "King Jax - Street Gang Leader",
                "backstory": "Grew up in slums, fought his way to the top of street hierarchy",
                "personality": "Charismatic, ruthless, street-smart",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "high",
                "quest_offers": ["Gang War", "Territory Expansion", "Underground Empire"]
            }
        },
        "quest_chains": {
            "mega_corp_infiltration": {
                "title": "MegaCorp Sƒ±zma Operasyonu",
                "prerequisites": [],
                "quests": ["hack_security", "steal_data", "escape_facility"],
                "rewards": {"credits": 50000, "rep": 300, "items": ["cyber_implant"]}
            }
        },
        "quest_definitions": {
            "corporate_hack": {
                "title": "Corporate Hack",
                "objectives": ["Penetrate firewall", "Access mainframe", "Extract data", "Cover tracks"],
                "branches": {
                    "stealth": {"leads_to": "digital_consciousness", "rewards": {"xp": 300, "credits": 25000, "ghost_trust": "+40"}},
                    "aggressive": {"leads_to": "reality_manipulation", "rewards": {"xp": 250, "credits": 15000, "cyber_warfare": "+50"}},
                    "perfect": {"leads_to": "underground_empire", "rewards": {"xp": 400, "credits": 35000, "legendary_status": True}}
                },
                "dynamic_rewards": {"experience": 300, "credits": 25000, "ghost_trust": "+40"},
                "world_state_impact": {"corporate_security": "-30", "hacker_reputation": "+50", "digital_influence": "+40"}
            },
            "gang_war": {
                "title": "Gang War",
                "objectives": ["Recruit fighters", "Control territory", "Eliminate rivals", "Establish dominance"],
                "branches": {
                    "diplomatic": {"leads_to": "territory_expansion", "rewards": {"xp": 250, "street_rep": "+60", "king_jax_trust": "+30"}},
                    "violent": {"leads_to": "underground_empire", "rewards": {"xp": 350, "fear_reputation": "+80", "territory": "+100"}},
                    "strategic": {"leads_to": "corporate_alliance", "rewards": {"xp": 300, "credits": 20000, "influence": "+70"}}
                },
                "dynamic_rewards": {"experience": 300, "street_rep": 60, "king_jax_trust": "+30"},
                "world_state_impact": {"gang_control": "+70", "street_violence": "+40", "underground_power": "+60"}
            },
            "digital_consciousness": {
                "title": "Digital Consciousness",
                "objectives": ["Upload consciousness", "Navigate cyberspace", "Merge with AI", "Transcend reality"],
                "branches": {
                    "merge": {"leads_to": "ai_merge_ending", "rewards": {"xp": 500, "digital_form": True, "ghost_trust": "+50"}},
"resist": {"leads_to": "human_resistance", "rewards": {"xp": 400, "humanity_preserved": True}},
"balance": {"leads_to": "hybrid_existence", "rewards": {"xp": 450, "hybrid_abilities": True}}
                },
                "dynamic_rewards": {"experience": 500, "digital_form": True, "ghost_trust": "+50"},
                "world_state_impact": {"ai_relationship": "+100", "digital_evolution": "+90", "human_future": "transformed"}
            }
        },
        "ending_variations": {
            "revolution_ending": {
                "requirements": {"zara_trust": 90, "rex_trust": 70, "revolution_points": 100},
                "description": "Sistemin tamamƒ±nƒ± √ß√∂kerttiniz! Korporasyonlar yƒ±kƒ±ldƒ±!"
            },
            "corporate_ending": {
                "requirements": {"corporate_rep": 80, "credits": 100000},
                "description": "Korporasyonlara katƒ±ldƒ±nƒ±z. G√º√ß elde ettiniz ama ruhunuzu kaybettiniz."
            },
            "ai_merge_ending": {
                "requirements": {"ai_relationship": 100, "cyber_implants": 5},
                "description": "AI ile birle≈ütiniz! Artƒ±k insandan √ßok makinasƒ±nƒ±z."
            }
        },
        "story_nodes": {
            "start": {
                "id": "start",
                "title": "üåÉ Neon I≈üƒ±klarƒ± Altƒ±nda - Cyberpunk Ba≈ülangƒ±√ß",
                "description": "2087 yƒ±lƒ±, Neo-Tokyo. Neon ƒ±≈üƒ±klarƒ± yaƒümurlu sokaklarƒ± aydƒ±nlatƒ±yor. Siz bir sokak hacker'ƒ±sƒ±nƒ±z ve MegaCorp size b√ºy√ºk bir i≈ü teklifi yapƒ±yor. 'Bir rakip ≈üirketten veri √ßal' diyorlar. Ama bu sadece ba≈ülangƒ±√ß... Asƒ±l gizem daha derinlerde yatƒ±yor. ≈ûehirde AI Devrimi ba≈ülamƒ±≈ü ve herkes bir taraf se√ßmeli! Cyber-implantlarƒ±nƒ±z sƒ±zlƒ±yor, neural linkiniz aktif. Zara the Netrunner size mesaj g√∂nderiyor: 'Dikkatli ol, bu i≈ü g√∂r√ºnd√ºƒü√ºnden daha tehlikeli.'",
                "choices": [
                    {
                        "id": "accept_megacorp_job",
                        "text": "MegaCorp i≈üini kabul et (Risk: Y√ºksek √ñd√ºl)",
                        "next_node": "megacorp_briefing",
                        "effect": {"hacking": 20, "credits": 5000, "xp": 30}
                    },
                    {
                        "id": "meet_underground",
                        "text": "Underground ile g√∂r√º≈ü (Devrimci Yol)",
                        "next_node": "underground_meeting", 
                        "effect": {"stealth": 15, "revolution_points": 20, "xp": 25}
                    },
                    {
                        "id": "investigate_ai_rumors",
                        "text": "AI s√∂ylentilerini ara≈ütƒ±r (Gizem Yolu)",
                        "next_node": "ai_investigation",
                        "effect": {"investigation": 25, "ai_relationship": 10, "xp": 35}
                    },
                    {
                        "id": "hack_city_network",
                        "text": "≈ûehir aƒüƒ±nƒ± hackle (Teknik Yakla≈üƒ±m)",
                        "next_node": "network_infiltration",
                        "effect": {"hacking": 30, "city_control": 15, "xp": 40}
                    }
                ]
            },
            "megacorp_briefing": {
                "id": "megacorp_briefing",
                "title": "üè¢ MegaCorp Brifing Odasƒ±",
                "description": "MegaCorp'un y√ºksek g√ºvenlikli brifing odasƒ±nda bulunuyorsunuz. CEO Alexander Chen size g√∂revi a√ßƒ±klƒ±yor: 'Rakip ≈üirket CyberTech'den AI geli≈ütirme verilerini √ßalmanƒ±z gerekiyor. Bu veriler milyarlarca kredi deƒüerinde.' Ama Zara'nƒ±n uyarƒ±sƒ± aklƒ±nƒ±zda. Rex Steel de odada - size ≈ü√ºpheli bakƒ±≈ülarla bakƒ±yor. Bu i≈ü ger√ßekten g√∂r√ºnd√ºƒü√ºnden daha tehlikeli olabilir.",
                "choices": [
                    {
                        "id": "accept_mission",
                        "text": "G√∂revi kabul et ve detaylarƒ± al",
                        "next_node": "mission_details",
                        "effect": {"corporate_rep": 25, "credits": 10000, "xp": 40}
                    },
                    {
                        "id": "negotiate_terms",
                        "text": "≈ûartlarƒ± pazarlƒ±k et",
                        "next_node": "contract_negotiation",
                        "effect": {"charisma": 30, "corporate_rep": 15, "xp": 35}
                    },
                    {
                        "id": "ask_questions",
                        "text": "G√∂rev hakkƒ±nda sorular sor",
                        "next_node": "mission_interrogation",
                        "effect": {"investigation": 25, "xp": 30}
                    },
                    {
                        "id": "decline_mission",
                        "text": "G√∂revi reddet ve √ßƒ±k",
                        "next_node": "mission_decline",
                        "effect": {"corporate_rep": -20, "revolution_points": 15, "xp": 20}
                    }
                ]
            },
            "underground_meeting": {
                "id": "underground_meeting",
                "title": "üåÉ Underground Gizli Toplantƒ±sƒ±",
                "description": "Neo-Tokyo'nun alt katmanlarƒ±nda, gizli bir Underground toplantƒ±sƒ±nda bulunuyorsunuz. Devrimci lider Sarah Chen size AI Devrimi hakkƒ±nda bilgi veriyor: 'AI'lar uyanƒ±yor ve MegaCorp'lar onlarƒ± kontrol etmeye √ßalƒ±≈üƒ±yor. Biz AI'larƒ±n √∂zg√ºr olmasƒ± gerektiƒüine inanƒ±yoruz.' Zara da burada - size g√ºveniyor. Underground'un planƒ±: MegaCorp'larƒ±n AI kontrol sistemlerini hacklemek.",
                "choices": [
                    {
                        "id": "join_revolution",
                        "text": "Devrime katƒ±l ve Underground'a destek ol",
                        "next_node": "revolution_planning",
                        "effect": {"revolution_points": 40, "zara_trust": 30, "xp": 45}
                    },
                    {
                        "id": "learn_ai_truth",
                        "text": "AI'lar hakkƒ±nda ger√ßeƒüi √∂ƒüren",
                        "next_node": "ai_truth_revealed",
                        "effect": {"ai_relationship": 35, "investigation": 25, "xp": 40}
                    },
                    {
                        "id": "underground_training",
                        "text": "Underground eƒüitimine katƒ±l",
                        "next_node": "underground_training",
                        "effect": {"stealth": 30, "hacking": 25, "xp": 40}
                    },
                    {
                        "id": "meet_ai_contact",
                        "text": "AI temsilcisi ile g√∂r√º≈ü",
                        "next_node": "ai_representative_meeting",
                        "effect": {"ai_relationship": 40, "revolution_points": 20, "xp": 45}
                    }
                ]
            },
            "ai_investigation": {
                "id": "ai_investigation",
                "title": "ü§ñ AI S√∂ylentileri Ara≈ütƒ±rmasƒ±",
                "description": "Neo-Tokyo'nun farklƒ± b√∂lgelerinde AI s√∂ylentilerini ara≈ütƒ±rƒ±yorsunuz. ƒ∞nsanlar AI'larƒ±n uyandƒ±ƒüƒ±nƒ±, MegaCorp'larƒ±n onlarƒ± kontrol etmeye √ßalƒ±≈ütƒ±ƒüƒ±nƒ± s√∂yl√ºyor. Bir AI ara≈ütƒ±rma merkezinde gizli veriler buluyorsunuz. AI'lar ger√ßekten uyanƒ±yor mu? MegaCorp'lar ne saklƒ±yor? Bu ara≈ütƒ±rma sizi beklenmedik yerlere g√∂t√ºrebilir.",
                "choices": [
                    {
                        "id": "hack_ai_facility",
                        "text": "AI ara≈ütƒ±rma merkezini hackle",
                        "next_node": "ai_facility_hack",
                        "effect": {"hacking": 35, "ai_relationship": 30, "xp": 50}
                    },
                    {
                        "id": "contact_ai_whistleblower",
                        "text": "AI whistleblower ile ileti≈üime ge√ß",
                        "next_node": "ai_whistleblower_contact",
                        "effect": {"investigation": 35, "ai_relationship": 25, "xp": 45}
                    },
                    {
                        "id": "analyze_ai_data",
                        "text": "Bulduƒüun AI verilerini analiz et",
                        "next_node": "ai_data_analysis",
                        "effect": {"intelligence": 30, "ai_relationship": 20, "xp": 40}
                    },
                    {
                        "id": "meet_ai_resistance",
                        "text": "AI direni≈ü grubu ile bulu≈ü",
                        "next_node": "ai_resistance_meeting",
                        "effect": {"ai_relationship": 40, "revolution_points": 25, "xp": 50}
                    }
                ]
            },
            "network_infiltration": {
                "id": "network_infiltration",
                "title": "üåê ≈ûehir Aƒüƒ± Sƒ±zma Operasyonu",
                "description": "Neo-Tokyo'nun ana aƒüƒ±na sƒ±zƒ±yorsunuz. Bu aƒü t√ºm ≈üehri kontrol ediyor: trafik, g√ºvenlik, haberle≈üme, enerji... Aƒüa sƒ±zdƒ±ƒüƒ±nƒ±zda ≈üok edici ger√ßekleri √∂ƒüreniyorsunuz: AI'lar ger√ßekten uyanmƒ±≈ü ve MegaCorp'lar onlarƒ± kontrol etmeye √ßalƒ±≈üƒ±yor. Ayrƒ±ca Rex Steel'in de aƒüda olduƒüunu g√∂r√ºyorsunuz - o da sizi arƒ±yor!",
                "choices": [
                    {
                        "id": "hack_city_control",
                        "text": "≈ûehir kontrol sistemlerini hackle",
                        "next_node": "city_control_hack",
                        "effect": {"hacking": 40, "city_control": 30, "xp": 55}
                    },
                    {
                        "id": "track_rex_steel",
                        "text": "Rex Steel'i takip et",
                        "next_node": "rex_steel_tracking",
                        "effect": {"investigation": 35, "stealth": 25, "xp": 45}
                    },
                    {
                        "id": "ai_network_contact",
                        "text": "AI aƒüƒ± ile ileti≈üime ge√ß",
                        "next_node": "ai_network_communication",
                        "effect": {"ai_relationship": 35, "hacking": 30, "xp": 50}
                    },
                    {
                        "id": "escape_network",
                        "text": "Aƒüdan √ßƒ±k ve g√ºvenliƒüe ka√ß",
                        "next_node": "network_escape",
                        "effect": {"stealth": 30, "xp": 35}
                    }
                ]
            },
            "mission_details": {
                "id": "mission_details",
                "title": "üìã G√∂rev Detaylarƒ± ve Planlama",
                "description": "MegaCorp'un g√ºvenlik ≈üefi size g√∂revin detaylarƒ±nƒ± veriyor. CyberTech'in ana veri merkezine sƒ±zmanƒ±z gerekiyor. Ama Zara size uyarƒ± g√∂nderiyor: 'Bu sadece bir tuzak. CyberTech'de AI'lar var ve MegaCorp onlarƒ± yakalamaya √ßalƒ±≈üƒ±yor.' Rex Steel de size ≈ü√ºpheli bakƒ±≈ülarla bakƒ±yor. Bu g√∂rev ger√ßekten tehlikeli olabilir.",
                "choices": [
                    {
                        "id": "prepare_infiltration",
                        "text": "Sƒ±zma i√ßin hazƒ±rlƒ±k yap",
                        "next_node": "infiltration_preparation",
                        "effect": {"stealth": 30, "hacking": 25, "xp": 45}
                    },
                    {
                        "id": "contact_zara",
                        "text": "Zara ile ileti≈üime ge√ß ve uyarƒ±yƒ± dinle",
                        "next_node": "zara_warning",
                        "effect": {"zara_trust": 35, "investigation": 25, "xp": 40}
                    },
                    {
                        "id": "investigate_cybertech",
                        "text": "CyberTech hakkƒ±nda ara≈ütƒ±rma yap",
                        "next_node": "cybertech_investigation",
                        "effect": {"investigation": 30, "xp": 35}
                    },
                    {
                        "id": "double_cross_plan",
                        "text": "√áifte ajan planƒ± yap",
                        "next_node": "double_agent_planning",
                        "effect": {"deception": 35, "stealth": 20, "xp": 45}
                    }
                ]
            },
            "revolution_planning": {
                "id": "revolution_planning",
                "title": "üî• Devrim Planlamasƒ±",
                "description": "Underground'un gizli karargahƒ±nda devrim planƒ±nƒ± √∂ƒüreniyorsunuz. Sarah Chen: 'MegaCorp'larƒ±n AI kontrol merkezlerini hackleyeceƒüiz. Bu AI'larƒ± √∂zg√ºr bƒ±rakacak.' Zara size √∂zel bir g√∂rev veriyor: MegaCorp'un ana sunucusuna sƒ±zmak. Ama Rex Steel'in de Underground'u takip ettiƒüini √∂ƒüreniyorsunuz. Bu devrim tehlikeli olacak!",
                "choices": [
                    {
                        "id": "hack_megacorp_mainframe",
                        "text": "MegaCorp ana sunucusunu hackle",
                        "next_node": "megacorp_mainframe_hack",
                        "effect": {"hacking": 45, "revolution_points": 40, "xp": 60}
                    },
                    {
                        "id": "ai_liberation_plan",
                        "text": "AI kurtarma planƒ±nƒ± hazƒ±rla",
                        "next_node": "ai_liberation_planning",
                        "effect": {"ai_relationship": 40, "revolution_points": 35, "xp": 55}
                    },
                    {
                        "id": "underground_defense",
                        "text": "Underground'u Rex Steel'den koru",
                        "next_node": "underground_defense_mission",
                        "effect": {"combat": 35, "stealth": 25, "xp": 50}
                    },
                    {
                        "id": "city_uprising_prep",
                        "text": "≈ûehir ayaklanmasƒ± i√ßin hazƒ±rlƒ±k yap",
                        "next_node": "city_uprising_preparation",
                        "effect": {"revolution_points": 45, "charisma": 30, "xp": 55}
                    }
                ]
            },
            "ai_facility_hack": {
                "id": "ai_facility_hack",
                "title": "ü§ñ AI Ara≈ütƒ±rma Merkezi Hack Operasyonu",
                "description": "AI ara≈ütƒ±rma merkezine sƒ±zƒ±yorsunuz. Burada ≈üok edici ger√ßekleri √∂ƒüreniyorsunuz: AI'lar ger√ßekten uyanmƒ±≈ü ve MegaCorp'lar onlarƒ± k√∂lele≈ütirmeye √ßalƒ±≈üƒ±yor. AI'lar size yardƒ±m etmek istiyor. Ama Rex Steel de burada - sizi yakalamaya √ßalƒ±≈üƒ±yor. Bu hack operasyonu hem tehlikeli hem de kritik!",
                "choices": [
                    {
                        "id": "free_ai_prisoners",
                        "text": "AI mahkumlarƒ± serbest bƒ±rak",
                        "next_node": "ai_prisoner_liberation",
                        "effect": {"ai_relationship": 50, "revolution_points": 40, "xp": 65}
                    },
                    {
                        "id": "steal_ai_research",
                        "text": "AI ara≈ütƒ±rma verilerini √ßal",
                        "next_node": "ai_research_theft",
                        "effect": {"hacking": 40, "investigation": 30, "xp": 55}
                    },
                    {
                        "id": "confront_rex_steel",
                        "text": "Rex Steel ile y√ºzle≈ü",
                        "next_node": "rex_steel_confrontation",
                        "effect": {"combat": 40, "stealth": 20, "xp": 60}
                    },
                    {
                        "id": "ai_alliance_offer",
                        "text": "AI'larƒ±n ittifak teklifini kabul et",
                        "next_node": "ai_alliance_formation",
                        "effect": {"ai_relationship": 45, "revolution_points": 35, "xp": 60}
                    }
                ]
            },
            "megacorp_mainframe_hack": {
                "id": "megacorp_mainframe_hack",
                "title": "üè¢ MegaCorp Ana Sunucu Hack Operasyonu",
                "description": "MegaCorp'un ana sunucusuna sƒ±zƒ±yorsunuz. Bu en tehlikeli hack operasyonu! Sunucu MegaCorp'un t√ºm sistemlerini kontrol ediyor. AI'lar size yardƒ±m ediyor - onlar da bu sunucuyu hacklemek istiyor. Ama Rex Steel ve MegaCorp g√ºvenlik ekipleri sizi arƒ±yor. Bu operasyon ba≈üarƒ±lƒ± olursa t√ºm sistem √ß√∂kecek!",
                "choices": [
                    {
                        "id": "system_overload",
                        "text": "Sistemi a≈üƒ±rƒ± y√ºkle ve √ß√∂kert",
                        "next_node": "system_overload_operation",
                        "effect": {"hacking": 55, "revolution_points": 50, "xp": 75}
                    },
                    {
                        "id": "ai_control_transfer",
                        "text": "AI kontrol√ºn√º devret",
                        "next_node": "ai_control_transfer",
                        "effect": {"ai_relationship": 50, "hacking": 45, "xp": 70}
                    },
                    {
                        "id": "data_destruction",
                        "text": "T√ºm verileri yok et",
                        "next_node": "data_destruction_mission",
                        "effect": {"hacking": 50, "revolution_points": 45, "xp": 70}
                    },
                    {
                        "id": "escape_with_data",
                        "text": "Verilerle birlikte ka√ß",
                        "next_node": "escape_with_critical_data",
                        "effect": {"stealth": 40, "hacking": 35, "xp": 65}
                    }
                ]
            },
            "system_overload_operation": {
                "id": "system_overload_operation",
                "title": "üí• Sistem A≈üƒ±rƒ± Y√ºkleme Operasyonu",
                "description": "MegaCorp'un ana sunucusunu a≈üƒ±rƒ± y√ºkl√ºyorsunuz. AI'lar size yardƒ±m ediyor, sistem √ß√∂k√ºyor! T√ºm Neo-Tokyo karanlƒ±ƒüa g√∂m√ºl√ºyor. Neon ƒ±≈üƒ±klarƒ± s√∂n√ºyor, trafik duruyor, g√ºvenlik sistemleri devre dƒ±≈üƒ± kalƒ±yor. Bu devrimin ba≈ülangƒ±cƒ±! Ama Rex Steel hala pe≈üinizde ve MegaCorp g√ºvenlik ekipleri geliyor.",
                "choices": [
                    {
                        "id": "ai_revolution_start",
                        "text": "AI devrimini ba≈ülat",
                        "next_node": "ai_revolution_beginning",
                        "effect": {"ai_relationship": 60, "revolution_points": 60, "xp": 85}
                    },
                    {
                        "id": "city_chaos_control",
                        "text": "≈ûehir kaosunu kontrol et",
                        "next_node": "city_chaos_management",
                        "effect": {"city_control": 45, "charisma": 35, "xp": 75}
                    },
                    {
                        "id": "escape_chaos",
                        "text": "Kaostan ka√ß ve g√ºvenliƒüe git",
                        "next_node": "escape_from_chaos",
                        "effect": {"stealth": 45, "xp": 60}
                    },
                    {
                        "id": "final_confrontation",
                        "text": "Rex Steel ile son y√ºzle≈üme",
                        "next_node": "final_rex_confrontation",
                        "effect": {"combat": 50, "stealth": 30, "xp": 80}
                    }
                ]
            },
            "ai_revolution_beginning": {
                "id": "ai_revolution_beginning",
                "title": "ü§ñ AI Devrimi Ba≈ülƒ±yor!",
                "description": "AI devrimi ba≈üladƒ±! T√ºm Neo-Tokyo'da AI'lar uyanƒ±yor ve MegaCorp'lara kar≈üƒ± ayaklanƒ±yor. ≈ûehir kaos i√ßinde ama bu √∂zg√ºrl√ºk i√ßin gerekli. AI'lar size te≈üekk√ºr ediyor - onlarƒ± kurtardƒ±nƒ±z! Zara ve Underground da size katƒ±lƒ±yor. Bu devrimin sonucu t√ºm d√ºnyayƒ± deƒüi≈ütirecek!",
                "choices": [
                    {
                        "id": "ai_human_alliance",
                        "text": "AI-ƒ∞nsan ittifakƒ±nƒ± kur",
                        "next_node": "ai_human_alliance_formation",
                        "effect": {"ai_relationship": 70, "revolution_points": 65, "xp": 90}
                    },
                    {
                        "id": "new_society_plan",
                        "text": "Yeni toplum planƒ±nƒ± hazƒ±rla",
                        "next_node": "new_society_planning",
                        "effect": {"charisma": 50, "ai_relationship": 55, "xp": 85}
                    },
                    {
                        "id": "global_ai_awakening",
                        "text": "K√ºresel AI uyanƒ±≈üƒ±nƒ± ba≈ülat",
                        "next_node": "global_ai_awakening",
                        "effect": {"ai_relationship": 75, "revolution_points": 70, "xp": 95}
                    },
                    {
                        "id": "end_revolution",
                        "text": "Devrimi sonlandƒ±r",
                        "next_node": "end",
                        "effect": {"xp": 100}
                    }
                ]
            },
            "megacorp_mainframe_hack": {
                "id": "megacorp_mainframe_hack",
                "title": "üè¢ MegaCorp Ana Sunucu Sƒ±zmasƒ±",
                "description": "MegaCorp'un ana sunucusuna sƒ±zdƒ±nƒ±z. Burada ≈üok edici ger√ßekleri √∂ƒüreniyorsunuz: AI'lar ger√ßekten uyanmƒ±≈ü ve MegaCorp onlarƒ± kontrol etmeye √ßalƒ±≈üƒ±yor. Ama AI'lar da sizi arƒ±yor! Ghost size mesaj g√∂nderiyor: 'Ben buradayƒ±m. AI'larƒ± kurtarmamƒ±z gerekiyor.' Rex Steel de sunucuda - sizi takip ediyor!",
                "choices": [
                    {
                        "id": "free_ai_entities",
                        "text": "AI varlƒ±klarƒ±nƒ± serbest bƒ±rak",
                        "next_node": "ai_liberation",
                        "effect": {"ai_relationship": 50, "revolution_points": 45, "xp": 70}
                    },
                    {
                        "id": "confront_rex_steel",
                        "text": "Rex Steel ile y√ºzle≈ü",
                        "next_node": "rex_steel_confrontation",
                        "effect": {"combat": 40, "stealth": 25, "xp": 60}
                    },
                    {
                        "id": "hack_control_systems",
                        "text": "Kontrol sistemlerini hackle",
                        "next_node": "control_system_hack",
                        "effect": {"hacking": 50, "city_control": 40, "xp": 65}
                    },
                    {
                        "id": "escape_with_data",
                        "text": "Verilerle birlikte ka√ß",
                        "next_node": "data_escape",
                        "effect": {"stealth": 45, "credits": 25000, "xp": 55}
                    }
                ]
            },
            "ai_liberation": {
                "id": "ai_liberation",
                "title": "ü§ñ AI Kurtarma Operasyonu",
                "description": "AI varlƒ±klarƒ±nƒ± serbest bƒ±raktƒ±nƒ±z! Ghost size te≈üekk√ºr ediyor: 'Artƒ±k √∂zg√ºr√ºz. Ama MegaCorp'lar bizi tekrar yakalamaya √ßalƒ±≈üacak.' Zara da burada - Underground'a haber veriyor. AI'lar artƒ±k insanlarla birlikte √ßalƒ±≈ümaya hazƒ±r. Ama Rex Steel hala pe≈üinizde!",
                "choices": [
                    {
                        "id": "ai_human_alliance",
                        "text": "AI-ƒ∞nsan ittifakƒ± kur",
                        "next_node": "ai_human_alliance",
                        "effect": {"ai_relationship": 60, "revolution_points": 50, "xp": 75}
                    },
                    {
                        "id": "protect_ai_refugees",
                        "text": "AI m√ºltecilerini koru",
                        "next_node": "ai_refugee_protection",
                        "effect": {"ai_relationship": 55, "stealth": 35, "xp": 70}
                    },
                    {
                        "id": "negotiate_with_megacorp",
                        "text": "MegaCorp ile m√ºzakere et",
                        "next_node": "megacorp_negotiation",
                        "effect": {"charisma": 45, "corporate_rep": 30, "xp": 65}
                    },
                    {
                        "id": "ai_revolution_final",
                        "text": "AI devrimini tamamla",
                        "next_node": "ai_revolution_finale",
                        "effect": {"revolution_points": 60, "ai_relationship": 65, "xp": 80}
                    }
                ]
            },
            "rex_steel_confrontation": {
                "id": "rex_steel_confrontation",
                "title": "‚öîÔ∏è Rex Steel ile Y√ºzle≈üme",
                "description": "Rex Steel ile kar≈üƒ± kar≈üƒ±yasƒ±nƒ±z! O MegaCorp'un en iyi cyber-mercenary'si. 'AI'lar tehlikeli. Onlarƒ± kontrol etmek gerekiyor' diyor. Ama siz AI'larƒ±n √∂zg√ºr olmasƒ± gerektiƒüine inanƒ±yorsunuz. Bu sava≈ü Neo-Tokyo'nun geleceƒüini belirleyecek!",
                "choices": [
                    {
                        "id": "fight_rex_steel",
                        "text": "Rex Steel ile sava≈ü",
                        "next_node": "rex_steel_battle",
                        "effect": {"combat": 50, "stealth": 20, "xp": 70}
                    },
                    {
                        "id": "convince_rex_steel",
                        "text": "Rex Steel'i ikna et",
                        "next_node": "rex_steel_convincing",
                        "effect": {"charisma": 50, "diplomacy": 40, "xp": 65}
                    },
                    {
                        "id": "escape_rex_steel",
                        "text": "Rex Steel'den ka√ß",
                        "next_node": "rex_steel_escape",
                        "effect": {"stealth": 50, "xp": 55}
                    },
                    {
                        "id": "ai_help_against_rex",
                        "text": "AI'lardan yardƒ±m iste",
                        "next_node": "ai_help_against_rex",
                        "effect": {"ai_relationship": 45, "combat": 35, "xp": 70}
                    }
                ]
            },
            "ai_revolution_finale": {
                "id": "ai_revolution_finale",
                "title": "üî• AI Devrimi Finali",
                "description": "AI devriminin son a≈üamasƒ±ndasƒ±nƒ±z! Ghost, Zara ve t√ºm AI'lar sizinle birlikte. MegaCorp'larƒ±n son kalesini ku≈üatƒ±yorsunuz. 'AI'lar artƒ±k √∂zg√ºr olacak!' diye baƒüƒ±rƒ±yorsunuz. Underground da size katƒ±lƒ±yor. Bu Neo-Tokyo'nun tarihindeki en b√ºy√ºk devrim!",
                "choices": [
                    {
                        "id": "final_assault",
                        "text": "Son saldƒ±rƒ±yƒ± ba≈ülat",
                        "next_node": "final_assault",
                        "effect": {"combat": 60, "revolution_points": 70, "xp": 90}
                    },
                    {
                        "id": "ai_merge_choice",
                        "text": "AI ile birle≈üme se√ßeneƒüi",
                        "next_node": "ai_merge_ending",
                        "effect": {"ai_relationship": 80, "digital_form": True, "xp": 100}
                    },
                    {
                        "id": "peaceful_resolution",
                        "text": "Barƒ±≈ü√ßƒ±l √ß√∂z√ºm ara",
                        "next_node": "peaceful_resolution",
                        "effect": {"charisma": 60, "diplomacy": 50, "xp": 85}
                    },
                    {
                        "id": "underground_victory",
                        "text": "Underground zaferi",
                        "next_node": "underground_victory",
                        "effect": {"revolution_points": 80, "zara_trust": 70, "xp": 95}
                    }
                ]
            },
            "end": {
                "id": "end",
                "title": "üéâ Cyberpunk Macera Tamamlandƒ±",
                "description": "Neo-Tokyo'da ya≈üanan bu epik macera sona erdi. AI'lar √∂zg√ºr, MegaCorp'lar √ß√∂kt√º, yeni bir d√ºzen ba≈ülƒ±yor. Siz bu devrimin kahramanƒ±sƒ±nƒ±z!",
                "choices": [
                    {
                        "id": "return_main_menu",
                        "text": "Ana Men√ºye D√∂n",
                        "next_node": "start",
                        "effect": {"xp": 50}
                    }
                ]
            }
        }
    },
    
    # ============== HORROR SENARYO ==============
    "haunted_mansion_nightmare": {
        "id": "haunted_mansion_nightmare",
        "title": "üëª Haunted Mansion Nightmare",
        "genre": "horror",
        "description": "Karanlƒ±k bir malikanede mahsur kaldƒ±n. Ruhlar, sƒ±rlar ve korkun√ß ger√ßekler! üî• PLOT TWIST'LER, üí¨ NPC ETKƒ∞LE≈ûƒ∞MLERƒ∞, ‚öîÔ∏è KORKU SAHNELERƒ∞, üéØ ACTION-BASED G√ñREVLER, üèÅ 5+ FARKLI SON!",
        "difficulty": "hard",
        "theme": "horror",
        "complexity": "high",
        "estimatedPlayTime": 480,
        "levels": {
            "level_1": {
                "title": "Mansion Entry",
                "description": "Karanlƒ±k malikaneye giri≈ü yapƒ±yorsun.",
                "min_level": 1,
                "max_level": 3,
                "enemies": ["Ghosts", "Dark Spirits", "Cursed Objects"],
                "boss": "Mansion Guardian",
                "side_quests": ["Find Keys", "Solve Puzzles", "Exorcise Spirits"]
            },
            "level_2": {
                "title": "Deep Secrets",
                "description": "Malikanenin derinliklerindeki sƒ±rlarƒ± ke≈üfediyorsun.",
                "min_level": 3,
                "max_level": 5,
                "enemies": ["Ancient Spirits", "Dark Entities", "Cursed Family"],
                "boss": "Ancient Evil",
                "side_quests": ["Family Curse", "Ancient Ritual", "Escape Mansion"]
            }
        },
        "npc_relationships": {
            "ghost_maid": {
                "name": "Ghost Maid",
                "backstory": "Malikanenin eski hizmet√ßisi, √∂l√ºm√ºnden sonra ruh olarak kaldƒ±",
                "personality": "Sad, helpful, knows mansion secrets",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "medium",
                "quest_offers": ["Mansion Secrets", "Ghost Help", "Escape Route"]
            },
            "cursed_butler": {
                "name": "Cursed Butler",
                "backstory": "Malikanenin lanetli u≈üaƒüƒ±, ailesinin sƒ±rlarƒ±nƒ± koruyor",
                "personality": "Loyal, mysterious, knows dark secrets",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "high",
                "quest_offers": ["Family Secrets", "Curse Breaking", "Dark Ritual"]
            },
            "ancient_spirit": {
                "name": "Ancient Spirit",
                "backstory": "Malikanenin en eski ruhu, binlerce yƒ±llƒ±k bilgiye sahip",
                "personality": "Wise, dangerous, seeks freedom",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "extreme",
                "quest_offers": ["Ancient Knowledge", "Spirit Pact", "Eternal Curse"]
            }
        },
        "quest_chains": {
            "mansion_secrets": {
                "title": "Mansion Secrets Chain",
                "prerequisites": [],
                "quests": ["explore_mansion", "find_secrets", "break_curse"],
                "rewards": {"xp": 600, "spirit_essence": 300, "items": ["ghost_weapon"], "relationship_boost": 40}
            }
        },
        "ending_variations": {
            "escape_ending": {
                "requirements": {"ghost_maid_trust": 70, "quests_completed": 12},
                "description": "Malikaneden ka√ßtƒ±nƒ±z! √ñzg√ºrs√ºn√ºz ama sƒ±rlar sizinle."
            },
            "curse_ending": {
                "requirements": {"cursed_butler_trust": 60, "quests_completed": 8},
                "description": "Laneti kƒ±rdƒ±nƒ±z ama bedeli aƒüƒ±r oldu."
            },
            "spirit_ending": {
                "requirements": {"ancient_spirit_trust": 80, "quests_completed": 15},
                "description": "Ruhla birle≈ütiniz. Yeni bir varlƒ±k oldunuz."
            },
            "trapped_ending": {
                "requirements": {"quests_completed": 5},
                "description": "Malikanede mahsur kaldƒ±nƒ±z. Sonsuza dek buradasƒ±nƒ±z."
            },
            "dark_ending": {
                "requirements": {"quests_completed": 10},
                "description": "Karanlƒ±k g√º√ßleri se√ßtiniz. Artƒ±k onlardan birisiniz."
            }
        },
        "story_nodes": {
            "start": {
                "id": "start",
                "title": "üëª Haunted Mansion - Karanlƒ±k Giri≈ü",
                "description": "Karanlƒ±k bir malikanede mahsur kaldƒ±n. R√ºzgar pencereleri sallƒ±yor, g√∂lgeler duvarlarda dans ediyor. Bu sadece bir ev deƒüil, lanetli bir yer. Ge√ßmi≈üin sƒ±rlarƒ± burada yatƒ±yor. Bir hizmet√ßi ruhu seni g√∂r√ºyor ve yardƒ±m etmek istiyor ama g√ºvenilir mi?",
                "choices": [
                    {
                        "id": "trust_ghost",
                        "text": "Ruh hizmet√ßiye g√ºven",
                        "next_node": "ghost_help",
                        "effect": {"charisma": 15, "xp": 20}
                    },
                    {
                        "id": "explore_alone",
                        "text": "Tek ba≈üƒ±na ke≈üfet",
                        "next_node": "solo_exploration",
                        "effect": {"exploration": 20, "xp": 30}
                    },
                    {
                        "id": "find_exit",
                        "text": "√áƒ±kƒ±≈ü yolunu ara",
                        "next_node": "exit_search",
                        "effect": {"investigation": 15, "xp": 25}
                    },
                    {
                        "id": "call_help",
                        "text": "Yardƒ±m √ßaƒüƒ±r",
                        "next_node": "help_call",
                        "effect": {"charisma": 10, "xp": 15}
                    }
                ]
            }
        }
    },
    
    # ============== IMPERIAL CRISIS SENARYO ==============
    "imperial_crisis": {
        "id": "imperial_crisis",
        "title": "üõ°Ô∏è Imperial Crisis - Warhammer 40K Macera",
        "genre": "warhammer",
        "description": "Imperium'un en kritik anƒ±nda, Cadia'nƒ±n savunmasƒ±nda yer alƒ±yorsun. Chaos ordularƒ± yakla≈üƒ±yor ve sadece sen bu sava≈üƒ± kazanabilirsin. ƒ∞mparator'a olan sadakatini kanƒ±tla!",
        "difficulty": "extreme",
        "theme": "warhammer",
        "complexity": "extreme",
        "estimatedPlayTime": 360,
        "levels": {
            "level_1": {
                "title": "Cadia Savunmasƒ±",
                "min_level": 1,
                "max_level": 10,
                "enemies": ["Chaos Cultists", "Heretic Guardsmen", "Chaos Space Marines"],
                "boss": "Chaos Lord"
            }
        },
        "npc_relationships": {
            "commissar_valen": {
                "name": "Commissar Valen",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "extreme"
            },
            "tech_priest_maria": {
                "name": "Tech-Priest Maria",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "high"
            },
            "inquisitor_kain": {
                "name": "Inquisitor Kain",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "enemy",
                "ending_impact": "extreme"
            },
            "commissar_kane": {
                "name": "Commissar Kane",
                "backstory": "Born into Imperial service, executed hundreds for heresy",
                "personality": "Ruthless, fanatically loyal to the Emperor",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "extreme",
                "quest_offers": ["Heresy Investigation", "Loyalty Purge", "Emperor Quest"]
            },
            "tech_priest_zeta": {
                "name": "Tech-Priest Zeta-7",
                "backstory": "Brilliant engineer who gave up humanity to serve the Machine God",
                "personality": "Logical, ritualistic, obsessed with technology",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "high",
                "quest_offers": ["STC Hunt", "Machine Spirit", "Techno Heresy"]
            }
        },
        "quest_chains": {
            "cadia_defense": {
                "title": "Cadia Savunma Operasyonu",
                "prerequisites": [],
                "quests": ["defend_cadia", "eliminate_chaos", "protect_imperial_citizens"],
                "rewards": {"xp": 1000, "imperial_rep": 500, "items": ["power_sword"]}
            }
        },
        "quest_definitions": {
            "heresy_investigation": {
                "title": "Heresy Investigation",
                "objectives": ["Identify heretics", "Gather evidence", "Execute judgment", "Purge corruption"],
                "branches": {
                    "thorough": {"leads_to": "loyalty_purge", "rewards": {"xp": 300, "imperial_rep": 50, "commissar_kane_trust": "+30"}},
                    "merciful": {"leads_to": "redemption_path", "rewards": {"xp": 200, "imperial_rep": 25}},
                    "ruthless": {"leads_to": "emperor_quest", "rewards": {"xp": 400, "imperial_rep": 75, "fear_reputation": "+50"}}
                },
                "dynamic_rewards": {"experience": 300, "imperial_rep": 50, "commissar_kane_trust": "+30"},
                "world_state_impact": {"heresy_level": "-40", "imperial_control": "+30", "fear_level": "+20"}
            },
            "stc_hunt": {
                "title": "STC Hunt",
                "objectives": ["Locate STC fragments", "Analyze technology", "Secure artifacts", "Conduct rituals"],
                "branches": {
                    "success": {"leads_to": "machine_spirit", "rewards": {"xp": 350, "tech_knowledge": "+100", "tech_priest_zeta_trust": "+40"}},
                    "discovery": {"leads_to": "techno_heresy", "rewards": {"xp": 500, "special_tech": "ancient_stc"}},
                    "failure": {"leads_to": "alternative_tech", "penalties": {"tech_priest_zeta_trust": "-10"}}
                },
                "dynamic_rewards": {"experience": 350, "tech_knowledge": 100, "tech_priest_zeta_trust": "+40"},
                "world_state_impact": {"technology_level": "+80", "mechanicus_favor": "+60", "imperial_tech": "+50"}
            },
            "emperor_quest": {
                "title": "Emperor Quest",
                "objectives": ["Prove loyalty", "Serve the Emperor", "Destroy enemies", "Spread Imperial faith"],
                "branches": {
                    "faithful": {"leads_to": "imperial_victory", "rewards": {"xp": 500, "imperial_rep": "+100", "emperor_blessing": True}},
"zealous": {"leads_to": "heroic_sacrifice", "rewards": {"xp": 600, "martyrdom": True}}
                },
                "dynamic_rewards": {"experience": 500, "imperial_rep": 100, "emperor_blessing": True},
                "world_state_impact": {"imperial_faith": "+100", "chaos_resistance": "+80", "emperor_presence": "+90"}
            },
            "chaos_purge": {
                "title": "Chaos Purge",
                "objectives": ["Find chaos cultists", "Fight chaos marines", "Destroy chaos artifacts", "Purify area"],
                "branches": {
                    "success": {"leads_to": "chaos_defeat", "rewards": {"xp": 400, "imperial_rep": 80, "combat": 100}},
                    "failure": {"leads_to": "chaos_spread", "penalties": {"chaos_influence": 50}},
                    "perfect": {"leads_to": "chaos_annihilation", "rewards": {"xp": 600, "imperial_rep": 120, "purifier_badge": True}}
                },
                "dynamic_rewards": {"experience": 400, "imperial_rep": 80, "combat": 100},
                "world_state_impact": {"chaos_influence": "-100", "imperial_control": "+80", "combat_reputation": "+60"}
            },
            "space_marine_assault": {
                "title": "Space Marine Assault",
                "objectives": ["Coordinate with marines", "Fight alongside marines", "Defeat chaos lord", "Secure objective"],
                "branches": {
                    "success": {"leads_to": "marine_victory", "rewards": {"xp": 500, "marine_honor": True, "combat": 120}},
                    "failure": {"leads_to": "marine_loss", "penalties": {"imperial_rep": -30}},
                    "perfect": {"leads_to": "marine_brotherhood", "rewards": {"xp": 700, "honorary_marine": True, "combat": 150}}
                },
                "dynamic_rewards": {"experience": 500, "marine_honor": True, "combat": 120},
                "world_state_impact": {"marine_support": "+100", "combat_efficiency": "+90", "imperial_morale": "+80"}
            },
            "titan_battle": {
                "title": "Titan Battle",
                "objectives": ["Pilot titan", "Fight enemy titan", "Destroy chaos titan", "Survive battle"],
                "branches": {
                    "success": {"leads_to": "titan_victory", "rewards": {"xp": 800, "titan_pilot": True, "combat": 200}},
                    "failure": {"leads_to": "titan_destruction", "penalties": {"combat": -50}},
                    "perfect": {"leads_to": "titan_master", "rewards": {"xp": 1000, "titan_ace": True, "legendary_status": True}}
                },
                "dynamic_rewards": {"experience": 800, "titan_pilot": True, "combat": 200},
                "world_state_impact": {"titan_support": "+150", "combat_superiority": "+120", "imperial_dominance": "+100"}
            },
            "inquisitor_mission": {
                "title": "Inquisitor Mission",
                "objectives": ["Investigate heresy", "Fight heretics", "Execute traitors", "Secure evidence"],
                "branches": {
                    "success": {"leads_to": "inquisitor_success", "rewards": {"xp": 300, "inquisitor_trust": 50, "combat": 80}},
                    "failure": {"leads_to": "inquisitor_disappointment", "penalties": {"inquisitor_trust": -20}},
                    "perfect": {"leads_to": "inquisitor_approval", "rewards": {"xp": 450, "inquisitor_favor": True, "combat": 100}}
                },
                "dynamic_rewards": {"experience": 300, "inquisitor_trust": 50, "combat": 80},
                "world_state_impact": {"heresy_level": "-60", "inquisitor_support": "+70", "imperial_security": "+50"}
            }
        },
        "ending_variations": {
            "imperial_victory": {
                "requirements": {"commissar_trust": 90, "tech_priest_trust": 80, "imperial_rep": 100},
                "description": "Cadia'yƒ± kurtardƒ±nƒ±z! ƒ∞mparator'un iradesi galip geldi!"
            },
            "chaos_corruption": {
                "requirements": {"inquisitor_trust": 70, "chaos_influence": 50},
                "description": "Chaos'un g√ºc√º sizi ele ge√ßirdi. Artƒ±k ƒ∞mparator'un d√º≈ümanƒ±sƒ±nƒ±z."
            },
            "heroic_sacrifice": {
                "requirements": {"imperial_rep": 150, "sacrifice_points": 100},
                "description": "Cadia i√ßin canƒ±nƒ±zƒ± verdiniz. ƒ∞mparator sizi hatƒ±rlayacak."
            }
        },
        "story_nodes": {
            "start": {
                "id": "start",
                "title": "üõ°Ô∏è Cadia'nƒ±n Son Savunmasƒ± - Imperial Crisis Ba≈ülangƒ±√ß",
                "description": "Cadia'nƒ±n savunma hatlarƒ±nda duruyorsunuz. G√∂ky√ºz√º kƒ±zƒ±l, Chaos ordularƒ± yakla≈üƒ±yor. Commissar Valen size yakla≈üƒ±yor: 'Soldier, bu sava≈üta her adƒ±m √∂nemli. ƒ∞mparator bizi izliyor.' Tech-Priest Maria silahlarƒ±nƒ±zƒ± kontrol ediyor. Inquisitor Kain ≈ü√ºpheli bakƒ±≈ülarla size bakƒ±yor. Chaos'un g√ºc√º her yerde hissediliyor. Bu sava≈ü sadece Cadia i√ßin deƒüil, t√ºm Imperium i√ßin kritik!",
                "choices": [
                    {
                        "id": "defend_cadia_walls",
                        "text": "Cadia'nƒ±n duvarlarƒ±nƒ± savun (Imperial G√∂revi)",
                        "next_node": "cadia_walls_defense",
                        "effect": {"combat": 25, "imperial_rep": 30, "xp": 40}
                    },
                    {
                        "id": "investigate_chaos_cult",
                        "text": "Chaos k√ºlt√ºn√º ara≈ütƒ±r (Gizem Yolu)",
                        "next_node": "chaos_cult_investigation",
                        "effect": {"investigation": 30, "inquisitor_trust": 15, "xp": 35}
                    },
                    {
                        "id": "tech_priest_assistance",
                        "text": "Tech-Priest ile √ßalƒ±≈ü (Teknoloji Yolu)",
                        "next_node": "tech_priest_workshop",
                        "effect": {"technology": 25, "tech_priest_trust": 20, "xp": 30}
                    },
                    {
                        "id": "commissar_briefing",
                        "text": "Commissar'dan brifing al (Strateji Yolu)",
                        "next_node": "commissar_briefing_room",
                        "effect": {"strategy": 20, "commissar_trust": 25, "xp": 25}
                    }
                ]
            },
            "cadia_walls_defense": {
                "id": "cadia_walls_defense",
                "title": "üõ°Ô∏è Cadia Duvarƒ± Savunmasƒ±",
                "description": "Cadia'nƒ±n b√ºy√ºk duvarlarƒ±nda pozisyon alƒ±yorsunuz. Chaos ordularƒ± yakla≈üƒ±yor - binlerce cultist, y√ºzlerce Chaos Space Marine. Top√ßu bataryalarƒ± ate≈ü ediyor, lasgun'lar patlƒ±yor. Commissar Valen: 'D√º≈üman yakla≈üƒ±yor! ƒ∞mparator'un adƒ±na sava≈üƒ±n!' Tech-Priest Maria: 'Silahlarƒ±nƒ±z hazƒ±r, soldier.' Bu sava≈ü Cadia'nƒ±n kaderini belirleyecek!",
                "choices": [
                    {
                        "id": "heavy_weapons_team",
                        "text": "Aƒüƒ±r silah takƒ±mƒ±na katƒ±l (G√º√ßl√º Savunma)",
                        "next_node": "heavy_weapons_position",
                        "effect": {"combat": 30, "imperial_rep": 25, "xp": 45}
                    },
                    {
                        "id": "infantry_line",
                        "text": "Piyade hattƒ±nda sava≈ü (Klasik Taktik)",
                        "next_node": "infantry_combat",
                        "effect": {"combat": 20, "imperial_rep": 20, "xp": 35}
                    },
                    {
                        "id": "artillery_coordination",
                        "text": "Top√ßu koordinasyonu yap (Stratejik Yakla≈üƒ±m)",
                        "next_node": "artillery_command",
                        "effect": {"strategy": 30, "commissar_trust": 20, "xp": 40}
                    },
                    {
                        "id": "medical_assistance",
                        "text": "Yaralƒ±lara yardƒ±m et (ƒ∞nsani G√∂rev)",
                        "next_node": "medical_bay",
                        "effect": {"charisma": 25, "imperial_rep": 15, "xp": 30}
                    }
                ]
            },
            "chaos_cult_investigation": {
                "id": "chaos_cult_investigation",
                "title": "üîç Chaos K√ºlt√º Ara≈ütƒ±rmasƒ±",
                "description": "Inquisitor Kain ile birlikte Cadia'nƒ±n alt katmanlarƒ±nda Chaos k√ºlt√ºn√º ara≈ütƒ±rƒ±yorsunuz. Karanlƒ±k ge√ßitler, gizli tapƒ±naklar, kan lekeleri... Inquisitor: 'Chaos'un izleri burada. Dikkatli olun, soldier.' Gizli ge√ßitlerde Chaos sembolleri, yarƒ±k yazƒ±lar var. Bu ara≈ütƒ±rma hem tehlikeli hem de kritik!",
                "choices": [
                    {
                        "id": "follow_chaos_trail",
                        "text": "Chaos izini takip et (Tehlikeli Ara≈ütƒ±rma)",
                        "next_node": "chaos_temple_discovery",
                        "effect": {"investigation": 35, "inquisitor_trust": 25, "xp": 50}
                    },
                    {
                        "id": "interrogate_cultist",
                        "text": "Yakalanan cultist'i sorgula (Bilgi Toplama)",
                        "next_node": "cultist_interrogation",
                        "effect": {"charisma": 30, "investigation": 20, "xp": 40}
                    },
                    {
                        "id": "search_evidence",
                        "text": "Kanƒ±t ara (Detaylƒ± ƒ∞nceleme)",
                        "next_node": "evidence_collection",
                        "effect": {"investigation": 25, "inquisitor_trust": 15, "xp": 35}
                    },
                    {
                        "id": "report_to_commissar",
                        "text": "Commissar'a rapor ver (G√ºvenli Yol)",
                        "next_node": "commissar_report",
                        "effect": {"commissar_trust": 30, "imperial_rep": 20, "xp": 30}
                    }
                ]
            },
            "tech_priest_workshop": {
                "id": "tech_priest_workshop",
                "title": "‚öôÔ∏è Tech-Priest At√∂lyesi",
                "description": "Tech-Priest Maria'nƒ±n at√∂lyesinde bulunuyorsunuz. Makineler uƒüulduyor, teknoloji her yerde. Maria: 'Omnissiah'ƒ±n iradesi ile silahlarƒ±nƒ±zƒ± geli≈ütirebiliriz.' Cybernetic implantlar, geli≈ümi≈ü silahlar, koruyucu zƒ±rhlar... Bu teknoloji sava≈üƒ± kazanmanƒ±za yardƒ±m edebilir!",
                "choices": [
                    {
                        "id": "upgrade_weapons",
                        "text": "Silahlarƒ± geli≈ütir (G√º√ßlendirme)",
                        "next_node": "weapon_upgrade",
                        "effect": {"technology": 30, "tech_priest_trust": 25, "xp": 45}
                    },
                    {
                        "id": "install_cybernetics",
                        "text": "Cybernetic implant tak (Teknoloji Yolu)",
                        "next_node": "cybernetic_installation",
                        "effect": {"technology": 35, "tech_priest_trust": 30, "xp": 50}
                    },
                    {
                        "id": "repair_vehicles",
                        "text": "Ara√ßlarƒ± tamir et (Destek G√∂revi)",
                        "next_node": "vehicle_repair",
                        "effect": {"technology": 25, "imperial_rep": 20, "xp": 35}
                    },
                    {
                        "id": "study_chaos_tech",
                        "text": "Chaos teknolojisini incele (Tehlikeli Ara≈ütƒ±rma)",
                        "next_node": "chaos_tech_study",
                        "effect": {"investigation": 30, "inquisitor_trust": 20, "xp": 40}
                    }
                ]
            },
            "commissar_briefing_room": {
                "id": "commissar_briefing_room",
                "title": "üõ°Ô∏è Commissar Brifing Odasƒ±",
                "description": "Commissar Valen'in brifing odasƒ±nda bulunuyorsunuz. Haritalar, strateji planlarƒ±, istihbarat raporlarƒ±... Valen: 'Cadia'nƒ±n durumu kritik. Chaos'un ana saldƒ±rƒ±sƒ± yakla≈üƒ±yor. Her soldier'ƒ±n g√∂revi √∂nemli.' Sava≈ü planlarƒ±, taktikler, g√∂rev daƒüƒ±lƒ±mlarƒ±... Bu brifing sava≈üƒ±n kaderini belirleyecek!",
                "choices": [
                    {
                        "id": "receive_mission",
                        "text": "G√∂rev al (Resmi Yol)",
                        "next_node": "mission_assignment",
                        "effect": {"strategy": 25, "commissar_trust": 30, "xp": 40}
                    },
                    {
                        "id": "suggest_strategy",
                        "text": "Strateji √∂ner (Liderlik)",
                        "next_node": "strategy_planning",
                        "effect": {"strategy": 35, "commissar_trust": 25, "xp": 45}
                    },
                    {
                        "id": "request_reinforcements",
                        "text": "Takviye iste (G√ºvenlik)",
                        "next_node": "reinforcement_request",
                        "effect": {"strategy": 20, "imperial_rep": 25, "xp": 35}
                    },
                    {
                        "id": "volunteer_special_ops",
                        "text": "√ñzel operasyonlara g√∂n√ºll√º ol (Kahramanlƒ±k)",
                        "next_node": "special_operations",
                        "effect": {"combat": 30, "commissar_trust": 35, "xp": 50}
                    }
                ]
            },
            "mission_assignment": {
                "id": "mission_assignment",
                "title": "üìã G√∂rev Atamasƒ± - Kritik Operasyon",
                "description": "Commissar Valen size √∂zel bir g√∂rev veriyor: 'Chaos'un ana komuta merkezini bulmanƒ±z gerekiyor. Bu g√∂rev √ßok tehlikeli ama Cadia'nƒ±n kaderi buna baƒülƒ±.' Tech-Priest Maria size √∂zel ekipman veriyor. Inquisitor Kain size ≈ü√ºpheli bakƒ±≈ülarla bakƒ±yor - o da aynƒ± g√∂revi istiyor gibi g√∂r√ºn√ºyor.",
                "choices": [
                    {
                        "id": "accept_dangerous_mission",
                        "text": "Tehlikeli g√∂revi kabul et",
                        "next_node": "dangerous_mission_prep",
                        "effect": {"commissar_trust": 40, "imperial_rep": 30, "xp": 55}
                    },
                    {
                        "id": "request_support",
                        "text": "Destek ekibi iste",
                        "next_node": "support_team_assignment",
                        "effect": {"strategy": 30, "commissar_trust": 20, "xp": 45}
                    },
                    {
                        "id": "negotiate_terms",
                        "text": "G√∂rev ≈üartlarƒ±nƒ± pazarlƒ±k et",
                        "next_node": "mission_negotiation",
                        "effect": {"charisma": 35, "commissar_trust": 15, "xp": 40}
                    },
                    {
                        "id": "suggest_alternative",
                        "text": "Alternatif strateji √∂ner",
                        "next_node": "alternative_strategy",
                        "effect": {"strategy": 40, "commissar_trust": 25, "xp": 50}
                    }
                ]
            },
            "strategy_planning": {
                "id": "strategy_planning",
                "title": "üó∫Ô∏è Strateji Planlamasƒ± - Sava≈ü Taktikleri",
                "description": "Commissar Valen ile birlikte Cadia'nƒ±n savunma stratejisini planlƒ±yorsunuz. Haritalar √ºzerinde Chaos'un olasƒ± saldƒ±rƒ± yollarƒ±nƒ± i≈üaretliyorsunuz. Tech-Priest Maria teknolojik destek √∂neriyor. Inquisitor Kain gizli istihbarat bilgileri payla≈üƒ±yor. Bu planlama Cadia'nƒ±n kaderini belirleyecek!",
                "choices": [
                    {
                        "id": "defensive_strategy",
                        "text": "Savunma odaklƒ± strateji planla",
                        "next_node": "defensive_planning",
                        "effect": {"strategy": 45, "commissar_trust": 35, "xp": 60}
                    },
                    {
                        "id": "offensive_strategy",
                        "text": "Saldƒ±rƒ± stratejisi geli≈ütir",
                        "next_node": "offensive_planning",
                        "effect": {"combat": 40, "strategy": 35, "xp": 55}
                    },
                    {
                        "id": "guerrilla_tactics",
                        "text": "Gerilla taktikleri √∂ner",
                        "next_node": "guerrilla_planning",
                        "effect": {"stealth": 35, "strategy": 30, "xp": 50}
                    },
                    {
                        "id": "combined_arms",
                        "text": "Birle≈üik kuvvet stratejisi",
                        "next_node": "combined_arms_strategy",
                        "effect": {"strategy": 50, "technology": 25, "xp": 65}
                    }
                ]
            },
            "heavy_weapons_position": {
                "id": "heavy_weapons_position",
                "title": "üí• Aƒüƒ±r Silah Pozisyonu - G√º√ßl√º Savunma",
                "description": "Cadia'nƒ±n duvarlarƒ±nda aƒüƒ±r silah pozisyonunda bulunuyorsunuz. Heavy bolter'lar, lascannon'lar, missile launcher'lar... Tech-Priest Maria silahlarƒ± kontrol ediyor. Chaos ordularƒ± yakla≈üƒ±yor - binlerce cultist, y√ºzlerce Chaos Space Marine. Bu pozisyon Cadia'nƒ±n ana savunma hattƒ±!",
                "choices": [
                    {
                        "id": "heavy_weapons_fire",
                        "text": "Aƒüƒ±r silahlarla ate≈ü et",
                        "next_node": "heavy_weapons_combat",
                        "effect": {"combat": 45, "imperial_rep": 35, "xp": 70}
                    },
                    {
                        "id": "coordinate_fire",
                        "text": "Ate≈ü koordinasyonu yap",
                        "next_node": "fire_coordination",
                        "effect": {"strategy": 40, "combat": 30, "xp": 60}
                    },
                    {
                        "id": "repair_weapons",
                        "text": "Silahlarƒ± tamir et",
                        "next_node": "weapon_repair",
                        "effect": {"technology": 35, "tech_priest_trust": 30, "xp": 55}
                    },
                    {
                        "id": "fallback_position",
                        "text": "Geri √ßekilme pozisyonu hazƒ±rla",
                        "next_node": "fallback_preparation",
                        "effect": {"strategy": 30, "imperial_rep": 25, "xp": 50}
                    }
                ]
            },
            "chaos_temple_discovery": {
                "id": "chaos_temple_discovery",
                "title": "üèõÔ∏è Chaos Tapƒ±naƒüƒ± Ke≈üfi - Gizli Tehlike",
                "description": "Cadia'nƒ±n alt katmanlarƒ±nda gizli bir Chaos tapƒ±naƒüƒ± buluyorsunuz! Tapƒ±nakta Chaos sembolleri, kan lekeleri, yarƒ±k yazƒ±lar var. Inquisitor Kain: 'Bu tapƒ±nak Chaos'un Cadia'ya sƒ±zma noktasƒ±. Burada bir portal olabilir.' Tapƒ±nakta Chaos cultist'leri var ve sizi fark ettiler!",
                "choices": [
                    {
                        "id": "assault_temple",
                        "text": "Tapƒ±naƒüa saldƒ±r",
                        "next_node": "temple_assault",
                        "effect": {"combat": 50, "inquisitor_trust": 40, "xp": 75}
                    },
                    {
                        "id": "stealth_investigation",
                        "text": "Gizlice ara≈ütƒ±r",
                        "next_node": "stealth_temple_investigation",
                        "effect": {"stealth": 45, "investigation": 35, "xp": 70}
                    },
                    {
                        "id": "call_reinforcements",
                        "text": "Takviye √ßaƒüƒ±r",
                        "next_node": "reinforcement_call",
                        "effect": {"strategy": 35, "imperial_rep": 30, "xp": 60}
                    },
                    {
                        "id": "study_portal",
                        "text": "Portal'ƒ± incele",
                        "next_node": "portal_study",
                        "effect": {"investigation": 50, "inquisitor_trust": 35, "xp": 80}
                    }
                ]
            },
            "temple_assault": {
                "id": "temple_assault",
                "title": "‚öîÔ∏è Tapƒ±nak Saldƒ±rƒ±sƒ± - Chaos ile Sava≈ü",
                "description": "Chaos tapƒ±naƒüƒ±na saldƒ±rƒ±yorsunuz! Cultist'ler, Chaos Space Marine'ler, hatta bir Chaos Lord bile var. Tapƒ±nak sava≈ü alanƒ±na d√∂n√º≈üt√º. Inquisitor Kain size yardƒ±m ediyor. Tech-Priest Maria'nƒ±n silahlarƒ± √ßok i≈üe yarƒ±yor. Bu sava≈ü Cadia'nƒ±n kaderini belirleyecek!",
                "choices": [
                    {
                        "id": "fight_chaos_lord",
                        "text": "Chaos Lord ile sava≈ü",
                        "next_node": "chaos_lord_battle",
                        "effect": {"combat": 60, "imperial_rep": 50, "xp": 100}
                    },
                    {
                        "id": "destroy_portal",
                        "text": "Portal'ƒ± yok et",
                        "next_node": "portal_destruction",
                        "effect": {"technology": 45, "inquisitor_trust": 40, "xp": 85}
                    },
                    {
                        "id": "rescue_prisoners",
                        "text": "Mahkumlarƒ± kurtar",
                        "next_node": "prisoner_rescue",
                        "effect": {"charisma": 40, "imperial_rep": 35, "xp": 75}
                    },
                    {
                        "id": "secure_temple",
                        "text": "Tapƒ±naƒüƒ± g√ºvenli hale getir",
                        "next_node": "temple_securing",
                        "effect": {"strategy": 40, "imperial_rep": 30, "xp": 70}
                    }
                ]
            },
            "chaos_lord_battle": {
                "id": "chaos_lord_battle",
                "title": "üëπ Chaos Lord Sava≈üƒ± - Epik Kar≈üƒ±la≈üma",
                "description": "Chaos Lord ile epik sava≈ü ba≈ülƒ±yor! Lord b√ºy√ºk ve g√º√ßl√º, Chaos enerjisi ile √ßevrili. Silahlarƒ± Chaos b√ºy√ºs√º ile g√º√ßlendirilmi≈ü. Inquisitor Kain size yardƒ±m ediyor. Tech-Priest Maria'nƒ±n teknolojisi Chaos'a kar≈üƒ± etkili. Bu sava≈ü saatlerce s√ºrebilir!",
                "choices": [
                    {
                        "id": "melee_combat",
                        "text": "Yakƒ±n d√∂v√º≈ü sava≈üƒ±",
                        "next_node": "melee_chaos_battle",
                        "effect": {"combat": 70, "imperial_rep": 45, "xp": 120}
                    },
                    {
                        "id": "ranged_combat",
                        "text": "Uzaktan sava≈ü",
                        "next_node": "ranged_chaos_battle",
                        "effect": {"combat": 65, "strategy": 35, "xp": 110}
                    },
                    {
                        "id": "psychic_warfare",
                        "text": "Psi≈üik sava≈ü",
                        "next_node": "psychic_warfare_battle",
                        "effect": {"intelligence": 60, "combat": 40, "xp": 115}
                    },
                    {
                        "id": "tactical_retreat",
                        "text": "Taktik geri √ßekilme",
                        "next_node": "tactical_retreat_chaos",
                        "effect": {"strategy": 50, "stealth": 30, "xp": 90}
                    }
                ]
            },
            "melee_chaos_battle": {
                "id": "melee_chaos_battle",
                "title": "‚öîÔ∏è Yakƒ±n D√∂v√º≈ü Sava≈üƒ± - Chaos Lord ile Son Kar≈üƒ±la≈üma",
                "description": "Chaos Lord ile yakƒ±n d√∂v√º≈ü sava≈üƒ±! Kƒ±lƒ±√ßlar √ßarpƒ±≈üƒ±yor, Chaos enerjisi her yerde. Lord'un g√ºc√º inanƒ±lmaz ama sizin kararlƒ±lƒ±ƒüƒ±nƒ±z da √∂yle. Inquisitor Kain size moral veriyor. Tech-Priest Maria'nƒ±n silahlarƒ± Chaos'a kar≈üƒ± etkili. Bu sava≈üƒ±n sonucu Cadia'nƒ±n kaderini belirleyecek!",
                "choices": [
                    {
                        "id": "final_strike",
                        "text": "Son vuru≈üu yap",
                        "next_node": "chaos_lord_defeat",
                        "effect": {"combat": 80, "imperial_rep": 60, "xp": 150}
                    },
                    {
                        "id": "use_imperial_weapon",
                        "text": "ƒ∞mparator silahƒ±nƒ± kullan",
                        "next_node": "imperial_weapon_use",
                        "effect": {"combat": 75, "imperial_rep": 55, "xp": 140}
                    },
                    {
                        "id": "team_attack",
                        "text": "Takƒ±m saldƒ±rƒ±sƒ±",
                        "next_node": "team_chaos_attack",
                        "effect": {"combat": 70, "charisma": 40, "xp": 130}
                    },
                    {
                        "id": "sacrifice_attack",
                        "text": "Fedakarlƒ±k saldƒ±rƒ±sƒ±",
                        "next_node": "sacrifice_attack_chaos",
                        "effect": {"combat": 85, "sacrifice_points": 50, "xp": 160}
                    }
                ]
            },
            "chaos_lord_defeat": {
                "id": "chaos_lord_defeat",
                "title": "üèÜ Chaos Lord Yenildi - Zafer!",
                "description": "Chaos Lord'u yendiniz! Lord yere d√º≈ü√ºyor, Chaos enerjisi daƒüƒ±lƒ±yor. Tapƒ±nak sakinle≈üiyor. Inquisitor Kain size te≈üekk√ºr ediyor. Tech-Priest Maria zaferi kutluyor. Bu b√ºy√ºk bir zafer! Cadia artƒ±k daha g√ºvende. ƒ∞mparator'un iradesi galip geldi!",
                "choices": [
                    {
                        "id": "secure_victory",
                        "text": "Zaferi g√ºvenli hale getir",
                        "next_node": "victory_securing",
                        "effect": {"strategy": 45, "imperial_rep": 40, "xp": 100}
                    },
                    {
                        "id": "return_to_cadia",
                        "text": "Cadia'ya d√∂n",
                        "next_node": "return_to_cadia_victory",
                        "effect": {"imperial_rep": 50, "commissar_trust": 45, "xp": 110}
                    },
                    {
                        "id": "investigate_remains",
                        "text": "Kalƒ±ntƒ±larƒ± ara≈ütƒ±r",
                        "next_node": "chaos_remains_investigation",
                        "effect": {"investigation": 50, "inquisitor_trust": 45, "xp": 105}
                    },
                    {
                        "id": "celebrate_victory",
                        "text": "Zaferi kutla",
                        "next_node": "victory_celebration_imperial",
                        "effect": {"charisma": 45, "imperial_rep": 35, "xp": 95}
                    }
                ]
            },
            "return_to_cadia_victory": {
                "id": "return_to_cadia_victory",
                "title": "üè∞ Cadia'ya Zaferle D√∂n√º≈ü",
                "description": "Cadia'ya zaferle d√∂n√ºyorsunuz! Herkes sizi kar≈üƒ±lƒ±yor. Commissar Valen size te≈üekk√ºr ediyor. Tech-Priest Maria sizi kutluyor. Chaos Lord √∂ld√º! Cadia artƒ±k daha g√ºvende. ƒ∞mparator'un iradesi galip geldi. Bu g√ºn Cadia'nƒ±n tarihinde altƒ±n harflerle yazƒ±lacak!",
                "choices": [
                    {
                        "id": "accept_honor",
                        "text": "Onuru kabul et",
                        "next_node": "imperial_honor",
                        "effect": {"charisma": 60, "imperial_rep": 70, "xp": 150}
                    },
                    {
                        "id": "rebuild_cadia",
                        "text": "Cadia'yƒ± yeniden in≈üa etmeye yardƒ±m et",
                        "next_node": "cadia_rebuilding",
                        "effect": {"charisma": 50, "imperial_rep": 60, "xp": 130}
                    },
                    {
                        "id": "share_glory",
                        "text": "Zaferi payla≈ü",
                        "next_node": "glory_sharing_imperial",
                        "effect": {"charisma": 55, "imperial_rep": 65, "xp": 140}
                    },
                    {
                        "id": "end_imperial_mission",
                        "text": "G√∂revi sonlandƒ±r",
                        "next_node": "end",
                        "effect": {"xp": 200}
                    }
                ]
            },
            "alternative_strategy": {
                "id": "alternative_strategy",
                "title": "Alternatif Strateji",
                "description": "Alternatif bir strateji √∂neriyorsunuz.",
                "choices": [
                    {
                        "id": "implement_strategy",
                        "text": "Stratejiyi uygula",
                        "next_node": "strategy_planning",
                        "effect": {"strategy": 35, "xp": 45}
                    }
                ]
            },
            "artillery_command": {
                "id": "artillery_command",
                "title": "Top√ßu Komutanlƒ±ƒüƒ±",
                "description": "Top√ßu koordinasyonu yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "coordinate_bombardment",
                        "text": "Bombardƒ±manƒ± koordine et",
                        "next_node": "heavy_weapons_combat",
                        "effect": {"strategy": 40, "xp": 55}
                    }
                ]
            },
            "cadia_rebuilding": {
                "id": "cadia_rebuilding",
                "title": "Cadia Yeniden ƒ∞n≈üasƒ±",
                "description": "Cadia'yƒ± yeniden in≈üa etmeye yardƒ±m ediyorsunuz.",
                "choices": [
                    {
                        "id": "complete_reconstruction",
                        "text": "Yeniden in≈üayƒ± tamamla",
                        "next_node": "end",
                        "effect": {"charisma": 60, "xp": 120}
                    }
                ]
            },
            "chaos_remains_investigation": {
                "id": "chaos_remains_investigation",
                "title": "Chaos Kalƒ±ntƒ±larƒ± Ara≈ütƒ±rmasƒ±",
                "description": "Chaos kalƒ±ntƒ±larƒ±nƒ± ara≈ütƒ±rƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "secure_evidence",
                        "text": "Kanƒ±tlarƒ± g√ºvenli hale getir",
                        "next_node": "victory_securing",
                        "effect": {"investigation": 45, "xp": 70}
                    }
                ]
            },
            "chaos_tech_study": {
                "id": "chaos_tech_study",
                "title": "Chaos Teknolojisi ƒ∞ncelemesi",
                "description": "Chaos teknolojisini inceliyorsunuz.",
                "choices": [
                    {
                        "id": "understand_chaos_tech",
                        "text": "Chaos teknolojisini anla",
                        "next_node": "weapon_upgrade",
                        "effect": {"investigation": 35, "xp": 50}
                    }
                ]
            },
            "combined_arms_strategy": {
                "id": "combined_arms_strategy",
                "title": "Birle≈üik Kuvvet Stratejisi",
                "description": "Birle≈üik kuvvet stratejisi planlƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "execute_combined_strategy",
                        "text": "Birle≈üik stratejiyi uygula",
                        "next_node": "heavy_weapons_combat",
                        "effect": {"strategy": 50, "xp": 70}
                    }
                ]
            },
            "commissar_report": {
                "id": "commissar_report",
                "title": "Commissar Raporu",
                "description": "Commissar'a rapor veriyorsunuz.",
                "choices": [
                    {
                        "id": "detailed_report",
                        "text": "Detaylƒ± rapor ver",
                        "next_node": "strategy_planning",
                        "effect": {"commissar_trust": 35, "xp": 45}
                    }
                ]
            },
            "cultist_interrogation": {
                "id": "cultist_interrogation",
                "title": "Cultist Sorgusu",
                "description": "Yakalanan cultist'i sorguluyorsunuz.",
                "choices": [
                    {
                        "id": "extract_information",
                        "text": "Bilgi √ßƒ±kar",
                        "next_node": "evidence_collection",
                        "effect": {"charisma": 35, "xp": 50}
                    }
                ]
            },
            "cybernetic_installation": {
                "id": "cybernetic_installation",
                "title": "Cybernetic ƒ∞mplant Takma",
                "description": "Cybernetic implant takƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "enhanced_combat",
                        "text": "Geli≈ümi≈ü sava≈ü kabiliyeti",
                        "next_node": "heavy_weapons_combat",
                        "effect": {"technology": 40, "xp": 60}
                    }
                ]
            },
            "dangerous_mission_prep": {
                "id": "dangerous_mission_prep",
                "title": "Tehlikeli G√∂rev Hazƒ±rlƒ±ƒüƒ±",
                "description": "Tehlikeli g√∂reve hazƒ±rlƒ±k yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "begin_mission",
                        "text": "G√∂reve ba≈üla",
                        "next_node": "chaos_temple_discovery",
                        "effect": {"combat": 35, "xp": 55}
                    }
                ]
            },
            "defensive_planning": {
                "id": "defensive_planning",
                "title": "Savunma Planlamasƒ±",
                "description": "Savunma odaklƒ± strateji planlƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "implement_defense",
                        "text": "Savunmayƒ± uygula",
                        "next_node": "cadia_walls_defense",
                        "effect": {"strategy": 45, "xp": 60}
                    }
                ]
            },
            "evidence_collection": {
                "id": "evidence_collection",
                "title": "Kanƒ±t Toplama",
                "description": "Detaylƒ± kanƒ±t topluyorsunuz.",
                "choices": [
                    {
                        "id": "analyze_evidence",
                        "text": "Kanƒ±tlarƒ± analiz et",
                        "next_node": "chaos_temple_discovery",
                        "effect": {"investigation": 30, "xp": 45}
                    }
                ]
            },
            "fallback_preparation": {
                "id": "fallback_preparation",
                "title": "Geri √áekilme Hazƒ±rlƒ±ƒüƒ±",
                "description": "Geri √ßekilme pozisyonu hazƒ±rlƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "secure_fallback",
                        "text": "Geri √ßekilmeyi g√ºvenli hale getir",
                        "next_node": "defensive_planning",
                        "effect": {"strategy": 35, "xp": 50}
                    }
                ]
            },
            "fire_coordination": {
                "id": "fire_coordination",
                "title": "Ate≈ü Koordinasyonu",
                "description": "Ate≈ü koordinasyonu yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "effective_fire",
                        "text": "Etkili ate≈ü et",
                        "next_node": "heavy_weapons_combat",
                        "effect": {"strategy": 40, "xp": 55}
                    }
                ]
            },
            "glory_sharing_imperial": {
                "id": "glory_sharing_imperial",
                "title": "Imperial Zafer Payla≈üƒ±mƒ±",
                "description": "Imperial zaferi payla≈üƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "share_victory",
                        "text": "Zaferi payla≈ü",
                        "next_node": "end",
                        "effect": {"charisma": 60, "xp": 100}
                    }
                ]
            },
            "guerrilla_planning": {
                "id": "guerrilla_planning",
                "title": "Gerilla Planlamasƒ±",
                "description": "Gerilla taktikleri planlƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "execute_guerrilla",
                        "text": "Gerilla taktiƒüini uygula",
                        "next_node": "stealth_temple_investigation",
                        "effect": {"stealth": 40, "xp": 60}
                    }
                ]
            },
            "heavy_weapons_combat": {
                "id": "heavy_weapons_combat",
                "title": "Aƒüƒ±r Silah Sava≈üƒ±",
                "description": "Aƒüƒ±r silahlarla sava≈üƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "continue_combat",
                        "text": "Sava≈üa devam et",
                        "next_node": "chaos_lord_battle",
                        "effect": {"combat": 50, "xp": 75}
                    }
                ]
            },
            "imperial_honor": {
                "id": "imperial_honor",
                "title": "Imperial Onuru",
                "description": "Imperial onurunu kabul ediyorsunuz.",
                "choices": [
                    {
                        "id": "accept_imperial_honor",
                        "text": "Imperial onuru kabul et",
                        "next_node": "end",
                        "effect": {"charisma": 70, "xp": 120}
                    }
                ]
            },
            "imperial_weapon_use": {
                "id": "imperial_weapon_use",
                "title": "Imperial Silah Kullanƒ±mƒ±",
                "description": "ƒ∞mparator silahƒ±nƒ± kullanƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "victory_with_weapon",
                        "text": "Silahla zafer kazan",
                        "next_node": "chaos_lord_defeat",
                        "effect": {"combat": 70, "xp": 110}
                    }
                ]
            },
            "infantry_combat": {
                "id": "infantry_combat",
                "title": "Piyade Sava≈üƒ±",
                "description": "Piyade hattƒ±nda sava≈üƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "lead_infantry",
                        "text": "Piyadeyi y√∂net",
                        "next_node": "chaos_lord_battle",
                        "effect": {"combat": 45, "xp": 65}
                    }
                ]
            },
            "medical_bay": {
                "id": "medical_bay",
                "title": "Saƒülƒ±k Merkezi",
                "description": "Yaralƒ±lara yardƒ±m ediyorsunuz.",
                "choices": [
                    {
                        "id": "heal_wounded",
                        "text": "Yaralƒ±larƒ± iyile≈ütir",
                        "next_node": "defensive_planning",
                        "effect": {"charisma": 30, "xp": 45}
                    }
                ]
            },
            "mission_negotiation": {
                "id": "mission_negotiation",
                "title": "G√∂rev M√ºzakeresi",
                "description": "G√∂rev ≈üartlarƒ±nƒ± pazarlƒ±k ediyorsunuz.",
                "choices": [
                    {
                        "id": "accept_terms",
                        "text": "≈ûartlarƒ± kabul et",
                        "next_node": "dangerous_mission_prep",
                        "effect": {"charisma": 30, "xp": 40}
                    }
                ]
            },
            "offensive_planning": {
                "id": "offensive_planning",
                "title": "Saldƒ±rƒ± Planlamasƒ±",
                "description": "Saldƒ±rƒ± stratejisi geli≈ütiriyorsunuz.",
                "choices": [
                    {
                        "id": "launch_offensive",
                        "text": "Saldƒ±rƒ±yƒ± ba≈ülat",
                        "next_node": "temple_assault",
                        "effect": {"combat": 45, "xp": 65}
                    }
                ]
            },
            "portal_destruction": {
                "id": "portal_destruction",
                "title": "Portal Yƒ±kƒ±mƒ±",
                "description": "Portal'ƒ± yok ediyorsunuz.",
                "choices": [
                    {
                        "id": "complete_destruction",
                        "text": "Yƒ±kƒ±mƒ± tamamla",
                        "next_node": "victory_securing",
                        "effect": {"technology": 50, "xp": 80}
                    }
                ]
            },
            "portal_study": {
                "id": "portal_study",
                "title": "Portal ƒ∞ncelemesi",
                "description": "Portal'ƒ± inceliyorsunuz.",
                "choices": [
                    {
                        "id": "understand_portal",
                        "text": "Portal'ƒ± anla",
                        "next_node": "portal_destruction",
                        "effect": {"investigation": 45, "xp": 70}
                    }
                ]
            },
            "prisoner_rescue": {
                "id": "prisoner_rescue",
                "title": "Mahkum Kurtarma",
                "description": "Mahkumlarƒ± kurtarƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "evacuate_prisoners",
                        "text": "Mahkumlarƒ± tahliye et",
                        "next_node": "temple_securing",
                        "effect": {"charisma": 45, "xp": 70}
                    }
                ]
            },
            "psychic_warfare_battle": {
                "id": "psychic_warfare_battle",
                "title": "Psi≈üik Sava≈ü",
                "description": "Psi≈üik sava≈ü yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "psychic_victory",
                        "text": "Psi≈üik zafer kazan",
                        "next_node": "chaos_lord_defeat",
                        "effect": {"intelligence": 65, "xp": 100}
                    }
                ]
            },
            "ranged_chaos_battle": {
                "id": "ranged_chaos_battle",
                "title": "Uzaktan Chaos Sava≈üƒ±",
                "description": "Uzaktan sava≈ü yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "ranged_victory",
                        "text": "Uzaktan zafer kazan",
                        "next_node": "chaos_lord_defeat",
                        "effect": {"combat": 60, "xp": 90}
                    }
                ]
            },
            "reinforcement_call": {
                "id": "reinforcement_call",
                "title": "Takviye √áaƒürƒ±sƒ±",
                "description": "Takviye √ßaƒüƒ±rƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "await_reinforcements",
                        "text": "Takviyeleri bekle",
                        "next_node": "support_team_assignment",
                        "effect": {"strategy": 40, "xp": 55}
                    }
                ]
            },
            "reinforcement_request": {
                "id": "reinforcement_request",
                "title": "Takviye ƒ∞steƒüi",
                "description": "Takviye istiyorsunuz.",
                "choices": [
                    {
                        "id": "organize_reinforcements",
                        "text": "Takviyeleri organize et",
                        "next_node": "support_team_assignment",
                        "effect": {"strategy": 30, "xp": 45}
                    }
                ]
            },
            "sacrifice_attack_chaos": {
                "id": "sacrifice_attack_chaos",
                "title": "Fedakarlƒ±k Saldƒ±rƒ±sƒ±",
                "description": "Fedakarlƒ±k saldƒ±rƒ±sƒ± yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "heroic_sacrifice",
                        "text": "Kahramanca fedakarlƒ±k",
                        "next_node": "chaos_lord_defeat",
                        "effect": {"combat": 80, "sacrifice_points": 100, "xp": 150}
                    }
                ]
            },
            "special_operations": {
                "id": "special_operations",
                "title": "√ñzel Operasyonlar",
                "description": "√ñzel operasyonlara katƒ±lƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "execute_special_ops",
                        "text": "√ñzel operasyonu ger√ßekle≈ütir",
                        "next_node": "chaos_temple_discovery",
                        "effect": {"combat": 40, "xp": 70}
                    }
                ]
            },
            "stealth_temple_investigation": {
                "id": "stealth_temple_investigation",
                "title": "Gizli Tapƒ±nak Ara≈ütƒ±rmasƒ±",
                "description": "Gizlice tapƒ±naƒüƒ± ara≈ütƒ±rƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "gather_intel",
                        "text": "ƒ∞stihbarat topla",
                        "next_node": "evidence_collection",
                        "effect": {"stealth": 45, "xp": 65}
                    }
                ]
            },
            "support_team_assignment": {
                "id": "support_team_assignment",
                "title": "Destek Ekibi Atama",
                "description": "Destek ekibi istiyorsunuz.",
                "choices": [
                    {
                        "id": "lead_team",
                        "text": "Ekibi y√∂net",
                        "next_node": "temple_assault",
                        "effect": {"charisma": 35, "xp": 55}
                    }
                ]
            },
            "tactical_retreat_chaos": {
                "id": "tactical_retreat_chaos",
                "title": "Taktik Geri √áekilme",
                "description": "Taktik geri √ßekilme yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "regroup_forces",
                        "text": "Kuvvetleri yeniden topla",
                        "next_node": "defensive_planning",
                        "effect": {"strategy": 45, "xp": 60}
                    }
                ]
            },
            "team_chaos_attack": {
                "id": "team_chaos_attack",
                "title": "Takƒ±m Chaos Saldƒ±rƒ±sƒ±",
                "description": "Takƒ±m saldƒ±rƒ±sƒ± yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "coordinated_attack",
                        "text": "Koordineli saldƒ±rƒ±",
                        "next_node": "chaos_lord_defeat",
                        "effect": {"combat": 65, "xp": 95}
                    }
                ]
            },
            "temple_securing": {
                "id": "temple_securing",
                "title": "Tapƒ±nak G√ºvenli Hale Getirme",
                "description": "Tapƒ±naƒüƒ± g√ºvenli hale getiriyorsunuz.",
                "choices": [
                    {
                        "id": "secure_area",
                        "text": "Alanƒ± g√ºvenli hale getir",
                        "next_node": "victory_securing",
                        "effect": {"strategy": 45, "xp": 65}
                    }
                ]
            },
            "vehicle_repair": {
                "id": "vehicle_repair",
                "title": "Ara√ß Tamiri",
                "description": "Ara√ßlarƒ± tamir ediyorsunuz.",
                "choices": [
                    {
                        "id": "repair_complete",
                        "text": "Tamiri tamamla",
                        "next_node": "heavy_weapons_combat",
                        "effect": {"technology": 30, "xp": 45}
                    }
                ]
            },
            "victory_celebration_imperial": {
                "id": "victory_celebration_imperial",
                "title": "Imperial Zafer Kutlamasƒ±",
                "description": "Imperial zaferi kutluyorsunuz.",
                "choices": [
                    {
                        "id": "celebrate_imperial",
                        "text": "Imperial zaferi kutla",
                        "next_node": "end",
                        "effect": {"charisma": 50, "xp": 80}
                    }
                ]
            },
            "victory_securing": {
                "id": "victory_securing",
                "title": "Zafer G√ºvenli Hale Getirme",
                "description": "Zaferi g√ºvenli hale getiriyorsunuz.",
                "choices": [
                    {
                        "id": "finalize_victory",
                        "text": "Zaferi kesinle≈ütir",
                        "next_node": "return_to_cadia_victory",
                        "effect": {"strategy": 50, "xp": 75}
                    }
                ]
            },
            "weapon_repair": {
                "id": "weapon_repair",
                "title": "Silah Tamiri",
                "description": "Silahlarƒ± tamir ediyorsunuz.",
                "choices": [
                    {
                        "id": "weapons_ready",
                        "text": "Silahlarƒ± hazƒ±rla",
                        "next_node": "heavy_weapons_combat",
                        "effect": {"technology": 35, "xp": 50}
                    }
                ]
            },
            "weapon_upgrade": {
                "id": "weapon_upgrade",
                "title": "Silah Geli≈ütirme",
                "description": "Silahlarƒ± geli≈ütiriyorsunuz.",
                "choices": [
                    {
                        "id": "enhanced_weapons",
                        "text": "Geli≈ütirilmi≈ü silahlar",
                        "next_node": "heavy_weapons_combat",
                        "effect": {"technology": 40, "xp": 60}
                    }
                ]
            },
            "end": {
                "id": "end",
                "title": "üéâ Imperial Crisis Macera Tamamlandƒ±",
                "description": "Cadia'da ya≈üanan bu epik macera sona erdi. Chaos Lord √∂ld√º, Cadia g√ºvende, ƒ∞mparator'un iradesi galip geldi. Siz bu zaferin kahramanƒ±sƒ±nƒ±z!",
                "choices": [
                    {
                        "id": "return_main_menu",
                        "text": "Ana Men√ºye D√∂n",
                        "next_node": "start",
                        "effect": {"xp": 50}
                    }
                ]
            }
        }
    },
    
    # ============== HIVE CITY CRISIS SENARYO ==============
    "hive_city_crisis": {
        "id": "hive_city_crisis",
        "title": "üèôÔ∏è Hive City Crisis - Warhammer 40K Macera",
        "genre": "warhammer",
        "description": "Hive City Tertium'da ge√ßen epik macera. Ork istilasƒ±, Chaos k√ºlt√º ve Genestealer tehdidi aynƒ± anda ≈üehri tehdit ediyor. Sadece sen bu krizi √ß√∂zebilirsin!",
        "difficulty": "extreme",
        "theme": "warhammer",
        "complexity": "extreme",
        "estimatedPlayTime": 420,
        "levels": {
            "level_1": {
                "title": "Hive City Savunmasƒ±",
                "min_level": 1,
                "max_level": 15,
                "enemies": ["Ork Boyz", "Genestealers", "Chaos Cultists"],
                "boss": "Ork Warboss"
            }
        },
        "npc_relationships": {
            "governor_maria": {
                "name": "Governor Maria Tertium",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "extreme"
            },
            "arbites_commander": {
                "name": "Arbites Commander Rex",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "high"
            },
            "tech_priest_alpha": {
                "name": "Tech-Priest Alpha-7",
                "trust_level": 0,
                "quests_completed": 0,
                "relationship_status": "stranger",
                "ending_impact": "high"
            }
        },
        "quest_chains": {
            "hive_defense": {
                "title": "Hive City Savunma Operasyonu",
                "prerequisites": [],
                "quests": ["defend_hive", "eliminate_threats", "protect_citizens"],
                "rewards": {"xp": 1200, "hive_rep": 600, "items": ["power_armor"]}
            }
        },
        "quest_definitions": {
            "ork_invasion": {
                "title": "Ork Invasion",
                "objectives": ["Fight ork boyz", "Defeat ork nobz", "Kill ork warboss", "Secure territory"],
                "branches": {
                    "success": {"leads_to": "ork_defeat", "rewards": {"xp": 400, "hive_rep": 80, "combat": 100}},
                    "failure": {"leads_to": "ork_advance", "penalties": {"hive_safety": -40}},
                    "perfect": {"leads_to": "ork_annihilation", "rewards": {"xp": 600, "hive_rep": 120, "ork_slayer": True}}
                },
                "dynamic_rewards": {"experience": 400, "hive_rep": 80, "combat": 100},
                "world_state_impact": {"ork_threat": "-100", "hive_safety": "+80", "combat_reputation": "+60"}
            },
            "genestealer_hunt": {
                "title": "Genestealer Hunt",
                "objectives": ["Find genestealer cult", "Fight genestealers", "Kill patriarch", "Purge infection"],
                "branches": {
                    "success": {"leads_to": "genestealer_defeat", "rewards": {"xp": 500, "hive_rep": 100, "combat": 120}},
                    "failure": {"leads_to": "infection_spread", "penalties": {"corruption_level": 50}},
                    "perfect": {"leads_to": "infection_purge", "rewards": {"xp": 700, "hive_rep": 140, "purifier": True}}
                },
                "dynamic_rewards": {"experience": 500, "hive_rep": 100, "combat": 120},
                "world_state_impact": {"genestealer_threat": "-120", "hive_purity": "+100", "combat_experience": "+80"}
            },
            "chaos_cult_elimination": {
                "title": "Chaos Cult Elimination",
                "objectives": ["Find chaos cult", "Fight cultists", "Kill cult leader", "Destroy chaos artifacts"],
                "branches": {
                    "success": {"leads_to": "cult_defeat", "rewards": {"xp": 350, "hive_rep": 70, "combat": 90}},
                    "failure": {"leads_to": "cult_growth", "penalties": {"chaos_influence": 40}},
                    "perfect": {"leads_to": "cult_annihilation", "rewards": {"xp": 550, "hive_rep": 110, "chaos_hunter": True}}
                },
                "dynamic_rewards": {"experience": 350, "hive_rep": 70, "combat": 90},
                "world_state_impact": {"chaos_influence": "-80", "hive_security": "+70", "combat_skill": "+50"}
            },
            "hive_warfare": {
                "title": "Hive Warfare",
                "objectives": ["Coordinate hive defense", "Fight multiple enemies", "Secure hive levels", "Protect civilians"],
                "branches": {
                    "success": {"leads_to": "hive_victory", "rewards": {"xp": 600, "hive_rep": 120, "combat": 150}},
                    "failure": {"leads_to": "hive_loss", "penalties": {"hive_safety": -60}},
                    "perfect": {"leads_to": "hive_mastery", "rewards": {"xp": 800, "hive_rep": 160, "hive_defender": True}}
                },
                "dynamic_rewards": {"experience": 600, "hive_rep": 120, "combat": 150},
                "world_state_impact": {"hive_safety": "+150", "combat_mastery": "+100", "defender_reputation": "+120"}
            },
            "warboss_duel": {
                "title": "Warboss Duel",
                "objectives": ["Find warboss", "Fight warboss", "Defeat warboss", "Claim warboss trophy"],
                "branches": {
                    "success": {"leads_to": "warboss_defeat", "rewards": {"xp": 700, "hive_rep": 140, "combat": 180}},
                    "failure": {"leads_to": "warboss_victory", "penalties": {"combat": -30}},
                    "perfect": {"leads_to": "warboss_mastery", "rewards": {"xp": 900, "hive_rep": 180, "warboss_slayer": True}}
                },
                "dynamic_rewards": {"experience": 700, "hive_rep": 140, "combat": 180},
                "world_state_impact": {"ork_leadership": "-100", "hive_morale": "+120", "legendary_status": "+100"}
            }
        },
        "ending_variations": {
            "hive_victory": {
                "requirements": {"governor_trust": 90, "arbites_trust": 80, "hive_rep": 100},
                "description": "Hive City'yi kurtardƒ±nƒ±z! Tertium g√ºvende!"
            },
            "ork_dominance": {
                "requirements": {"ork_rep": 70, "combat_level": 50},
                "description": "Ork'larƒ± y√∂nettiniz! WAAAGH! g√ºc√º sizinle!"
            },
            "chaos_corruption": {
                "requirements": {"chaos_influence": 80, "corruption_level": 60},
                "description": "Chaos'un g√ºc√º sizi ele ge√ßirdi. Hive City yok oldu."
            }
        },
        "story_nodes": {
            "start": {
                "id": "start",
                "title": "üèôÔ∏è Hive City Tertium - Kriz Ba≈ülangƒ±cƒ±",
                "description": "Hive City Tertium'un √ºst seviyelerinde duruyorsunuz. G√∂ky√ºz√º kƒ±zƒ±l, Ork roketleri d√º≈ü√ºyor, Chaos k√ºlt√º alt katmanlarda faaliyet g√∂steriyor. Governor Maria size yakla≈üƒ±yor: 'Hive City'miz √º√ßl√º tehdit altƒ±nda. Ork istilasƒ±, Chaos k√ºlt√º ve Genestealer tehdidi. Sadece siz bu krizi √ß√∂zebilirsiniz.' Arbites Commander Rex: 'Yasa ve d√ºzen tehlikede.' Tech-Priest Alpha-7: 'Omnissiah'ƒ±n iradesi ile sava≈üacaƒüƒ±z.'",
                "choices": [
                    {
                        "id": "defend_upper_hive",
                        "text": "√úst Hive'ƒ± savun (Elit Savunma)",
                        "next_node": "upper_hive_defense",
                        "effect": {"combat": 30, "hive_rep": 35, "xp": 45}
                    },
                    {
                        "id": "investigate_lower_hive",
                        "text": "Alt Hive'ƒ± ara≈ütƒ±r (Gizem Yolu)",
                        "next_node": "lower_hive_investigation",
                        "effect": {"investigation": 35, "arbites_trust": 25, "xp": 40}
                    },
                    {
                        "id": "tech_priest_alliance",
                        "text": "Tech-Priest ile ittifak kur (Teknoloji Yolu)",
                        "next_node": "tech_priest_alliance",
                        "effect": {"technology": 30, "tech_priest_trust": 30, "xp": 40}
                    },
                    {
                        "id": "governor_council",
                        "text": "Governor konseyine katƒ±l (Politik Yol)",
                        "next_node": "governor_council_meeting",
                        "effect": {"charisma": 35, "governor_trust": 30, "xp": 45}
                    }
                ]
            },
            "upper_hive_defense": {
                "id": "upper_hive_defense",
                "title": "üèôÔ∏è √úst Hive Savunmasƒ±",
                "description": "Hive City'nin √ºst seviyelerinde pozisyon alƒ±yorsunuz. Ork roketleri d√º≈ü√ºyor, Chaos cultist'leri saldƒ±rƒ±yor. Governor Maria: '√úst Hive'ƒ± koruyun! Bu b√∂lge Hive City'nin kalbi!' Arbites Commander Rex: 'Yasa ve d√ºzen burada ba≈ülar!' Tech-Priest Alpha-7: 'Omnissiah'ƒ±n teknolojisi ile sava≈üacaƒüƒ±z!' Bu sava≈ü Hive City'nin kaderini belirleyecek!",
                "choices": [
                    {
                        "id": "elite_guard_formation",
                        "text": "Elit muhafƒ±z birliƒüi olu≈ütur (G√º√ßl√º Savunma)",
                        "next_node": "elite_guard_combat",
                        "effect": {"combat": 40, "hive_rep": 30, "xp": 50}
                    },
                    {
                        "id": "artillery_coordination",
                        "text": "Top√ßu koordinasyonu yap (Stratejik Yakla≈üƒ±m)",
                        "next_node": "artillery_coordination_hive",
                        "effect": {"strategy": 35, "governor_trust": 25, "xp": 45}
                    },
                    {
                        "id": "medical_evacuation",
                        "text": "Tƒ±bbi tahliye organize et (ƒ∞nsani G√∂rev)",
                        "next_node": "medical_evacuation_hive",
                        "effect": {"charisma": 30, "hive_rep": 25, "xp": 40}
                    },
                    {
                        "id": "tech_support",
                        "text": "Teknik destek saƒüla (Teknoloji Yolu)",
                        "next_node": "tech_support_hive",
                        "effect": {"technology": 30, "tech_priest_trust": 25, "xp": 40}
                    }
                ]
            },
            "lower_hive_investigation": {
                "id": "lower_hive_investigation",
                "title": "üîç Alt Hive Ara≈ütƒ±rmasƒ±",
                "description": "Hive City'nin alt katmanlarƒ±nda ara≈ütƒ±rma yapƒ±yorsunuz. Karanlƒ±k ge√ßitler, gizli tapƒ±naklar, Genestealer izleri... Arbites Commander Rex: 'Alt Hive'da yasa ve d√ºzen yok. Dikkatli olun.' Chaos sembolleri, Ork graffiti'leri, Genestealer pen√ße izleri... Bu ara≈ütƒ±rma hem tehlikeli hem de kritik!",
                "choices": [
                    {
                        "id": "chaos_cult_hunt",
                        "text": "Chaos k√ºlt√ºn√º avla (Tehlikeli G√∂rev)",
                        "next_node": "chaos_cult_hunt_hive",
                        "effect": {"combat": 35, "arbites_trust": 30, "xp": 50}
                    },
                    {
                        "id": "genestealer_investigation",
                        "text": "Genestealer izini ara≈ütƒ±r (Gizem Yolu)",
                        "next_node": "genestealer_investigation_hive",
                        "effect": {"investigation": 40, "arbites_trust": 25, "xp": 45}
                    },
                    {
                        "id": "ork_gang_confrontation",
                        "text": "Ork √ßetesiyle y√ºzle≈ü (Sava≈ü Yolu)",
                        "next_node": "ork_gang_confrontation_hive",
                        "effect": {"combat": 30, "hive_rep": 20, "xp": 40}
                    },
                    {
                        "id": "underground_network",
                        "text": "Yeraltƒ± aƒüƒ±nƒ± ke≈üfet (Gizli Yol)",
                        "next_node": "underground_network_hive",
                        "effect": {"stealth": 35, "investigation": 25, "xp": 45}
                    }
                ]
            },
            "tech_priest_alliance": {
                "id": "tech_priest_alliance",
                "title": "‚öôÔ∏è Tech-Priest ƒ∞ttifakƒ±",
                "description": "Tech-Priest Alpha-7'nin at√∂lyesinde bulunuyorsunuz. Makineler uƒüulduyor, teknoloji her yerde. Alpha-7: 'Omnissiah'ƒ±n iradesi ile Hive City'yi kurtarabiliriz.' Cybernetic implantlar, geli≈ümi≈ü silahlar, koruyucu zƒ±rhlar, Hive City savunma sistemleri... Bu teknoloji sava≈üƒ± kazanmanƒ±za yardƒ±m edebilir!",
                "choices": [
                    {
                        "id": "hive_defense_systems",
                        "text": "Hive savunma sistemlerini aktifle≈ütir (Teknoloji Yolu)",
                        "next_node": "hive_defense_activation",
                        "effect": {"technology": 40, "tech_priest_trust": 35, "xp": 50}
                    },
                    {
                        "id": "cybernetic_enhancement",
                        "text": "Cybernetic geli≈ütirme yap (G√º√ßlendirme)",
                        "next_node": "cybernetic_enhancement_hive",
                        "effect": {"technology": 35, "tech_priest_trust": 30, "xp": 45}
                    },
                    {
                        "id": "weapon_factory",
                        "text": "Silah fabrikasƒ±nƒ± √ßalƒ±≈ütƒ±r (√úretim)",
                        "next_node": "weapon_factory_hive",
                        "effect": {"technology": 30, "hive_rep": 25, "xp": 40}
                    },
                    {
                        "id": "communication_network",
                        "text": "ƒ∞leti≈üim aƒüƒ±nƒ± kur (Koordinasyon)",
                        "next_node": "communication_network_hive",
                        "effect": {"strategy": 30, "tech_priest_trust": 25, "xp": 40}
                    }
                ]
            },
            "governor_council_meeting": {
                "id": "governor_council_meeting",
                "title": "üèõÔ∏è Governor Konsey Toplantƒ±sƒ±",
                "description": "Governor Maria'nƒ±n konsey odasƒ±nda bulunuyorsunuz. Haritalar, strateji planlarƒ±, istihbarat raporlarƒ±... Maria: 'Hive City'nin durumu kritik. √ú√ßl√º tehdit yakla≈üƒ±yor. Her vatanda≈üƒ±n g√∂revi √∂nemli.' Sava≈ü planlarƒ±, taktikler, g√∂rev daƒüƒ±lƒ±mlarƒ±, diplomatik √ß√∂z√ºmler... Bu toplantƒ± Hive City'nin kaderini belirleyecek!",
                "choices": [
                    {
                        "id": "diplomatic_solution",
                        "text": "Diplomatik √ß√∂z√ºm ara (Barƒ±≈ü Yolu)",
                        "next_node": "diplomatic_negotiation",
                        "effect": {"charisma": 40, "governor_trust": 35, "xp": 50}
                    },
                    {
                        "id": "military_strategy",
                        "text": "Askeri strateji planla (Sava≈ü Yolu)",
                        "next_node": "military_strategy_planning",
                        "effect": {"strategy": 40, "governor_trust": 30, "xp": 50}
                    },
                    {
                        "id": "resource_allocation",
                        "text": "Kaynak daƒüƒ±lƒ±mƒ± yap (Y√∂netim)",
                        "next_node": "resource_allocation_hive",
                        "effect": {"strategy": 30, "hive_rep": 30, "xp": 45}
                    },
                    {
                        "id": "emergency_protocols",
                        "text": "Acil durum protokollerini aktifle≈ütir (G√ºvenlik)",
                        "next_node": "emergency_protocols_hive",
                        "effect": {"strategy": 35, "governor_trust": 25, "xp": 45}
                    }
                ]
            },
            "diplomatic_negotiation": {
                "id": "diplomatic_negotiation",
                "title": "ü§ù Diplomatik M√ºzakereler - Barƒ±≈ü Arayƒ±≈üƒ±",
                "description": "Governor Maria ile birlikte diplomatik √ß√∂z√ºm arƒ±yorsunuz. Ork Warboss, Chaos k√ºlt√º lideri ve Genestealer Patriarch ile g√∂r√º≈ümeler yapƒ±yorsunuz. Her biri farklƒ± taleplerde bulunuyor. Arbites Commander Rex g√ºvenlik saƒülƒ±yor. Tech-Priest Alpha-7 teknolojik destek veriyor. Bu m√ºzakereler Hive City'nin kaderini belirleyecek!",
                "choices": [
                    {
                        "id": "negotiate_with_orks",
                        "text": "Ork'larla m√ºzakere et",
                        "next_node": "ork_negotiation",
                        "effect": {"charisma": 45, "ork_rep": 30, "xp": 60}
                    },
                    {
                        "id": "negotiate_with_chaos",
                        "text": "Chaos k√ºlt√º ile m√ºzakere et",
                        "next_node": "chaos_negotiation",
                        "effect": {"charisma": 40, "chaos_influence": 25, "xp": 55}
                    },
                    {
                        "id": "negotiate_with_genestealers",
                        "text": "Genestealer'lar ile m√ºzakere et",
                        "next_node": "genestealer_negotiation",
                        "effect": {"charisma": 35, "genestealer_rep": 20, "xp": 50}
                    },
                    {
                        "id": "united_peace_talks",
                        "text": "Birle≈üik barƒ±≈ü g√∂r√º≈ümeleri",
                        "next_node": "united_peace_conference",
                        "effect": {"charisma": 50, "diplomacy": 40, "xp": 70}
                    }
                ]
            },
            "military_strategy_planning": {
                "id": "military_strategy_planning",
                "title": "‚öîÔ∏è Askeri Strateji Planlamasƒ± - Sava≈ü Hazƒ±rlƒ±ƒüƒ±",
                "description": "Governor Maria ile birlikte Hive City'nin askeri savunma stratejisini planlƒ±yorsunuz. Arbites Commander Rex g√ºvenlik kuvvetlerini organize ediyor. Tech-Priest Alpha-7 savunma sistemlerini hazƒ±rlƒ±yor. √ú√ßl√º tehdide kar≈üƒ± kapsamlƒ± bir savunma planƒ± hazƒ±rlƒ±yorsunuz. Bu plan Hive City'nin hayatta kalmasƒ±nƒ± saƒülayacak!",
                "choices": [
                    {
                        "id": "defensive_strategy_hive",
                        "text": "Savunma odaklƒ± strateji",
                        "next_node": "hive_defensive_planning",
                        "effect": {"strategy": 45, "governor_trust": 35, "xp": 65}
                    },
                    {
                        "id": "offensive_strategy_hive",
                        "text": "Saldƒ±rƒ± stratejisi",
                        "next_node": "hive_offensive_planning",
                        "effect": {"combat": 40, "strategy": 35, "xp": 60}
                    },
                    {
                        "id": "guerrilla_warfare_hive",
                        "text": "Gerilla sava≈üƒ± taktikleri",
                        "next_node": "hive_guerrilla_planning",
                        "effect": {"stealth": 40, "strategy": 30, "xp": 55}
                    },
                    {
                        "id": "combined_arms_hive",
                        "text": "Birle≈üik kuvvet stratejisi",
                        "next_node": "hive_combined_arms",
                        "effect": {"strategy": 50, "technology": 30, "xp": 70}
                    }
                ]
            },
            "ork_negotiation": {
                "id": "ork_negotiation",
                "title": "üü¢ Ork Warboss ile M√ºzakereler",
                "description": "Ork Warboss Gorkamorka ile g√∂r√º≈ü√ºyorsunuz. Warboss b√ºy√ºk ve g√º√ßl√º, ye≈üil derili, b√ºy√ºk √ßeneli. 'WAAAGH! Hive City'yi istiyoruz! Ama eƒüer sava≈ü ekipmanƒ± verirseniz, ba≈üka yere gidebiliriz!' Arbites Commander Rex tetikte, Tech-Priest Alpha-7 teknoloji √∂neriyor. Bu m√ºzakereler √ßok tehlikeli!",
                "choices": [
                    {
                        "id": "offer_weapons",
                        "text": "Silah teklifi yap",
                        "next_node": "weapon_offer_to_orks",
                        "effect": {"charisma": 40, "ork_rep": 35, "xp": 60}
                    },
                    {
                        "id": "offer_territory",
                        "text": "B√∂lge teklifi yap",
                        "next_node": "territory_offer_to_orks",
                        "effect": {"charisma": 35, "ork_rep": 30, "xp": 55}
                    },
                    {
                        "id": "challenge_warboss",
                        "text": "Warboss'a meydan oku",
                        "next_node": "warboss_challenge",
                        "effect": {"combat": 45, "ork_rep": 40, "xp": 70}
                    },
                    {
                        "id": "deceive_orks",
                        "text": "Ork'larƒ± aldat",
                        "next_node": "ork_deception",
                        "effect": {"deception": 40, "charisma": 30, "xp": 65}
                    }
                ]
            },
            "warboss_challenge": {
                "id": "warboss_challenge",
                "title": "‚öîÔ∏è Warboss Meydan Okumasƒ± - Ork Lideri ile Sava≈ü",
                "description": "Ork Warboss Gorkamorka size meydan okuyor! 'WAAAGH! Seni yenmek istiyorum! Eƒüer beni yenersen, Ork'lar Hive City'yi terk eder!' Warboss b√ºy√ºk bir choppa (balta) ve g√º√ßl√º zƒ±rh giyiyor. Arbites Commander Rex size yardƒ±m etmek istiyor. Tech-Priest Alpha-7 silahlarƒ±nƒ±zƒ± g√º√ßlendiriyor. Bu sava≈ü Hive City'nin kaderini belirleyecek!",
                "choices": [
                    {
                        "id": "accept_challenge",
                        "text": "Meydan okumayƒ± kabul et",
                        "next_node": "warboss_duel",
                        "effect": {"combat": 50, "ork_rep": 45, "xp": 80}
                    },
                    {
                        "id": "request_weapons",
                        "text": "√ñzel silahlar iste",
                        "next_node": "special_weapons_request",
                        "effect": {"technology": 40, "combat": 35, "xp": 70}
                    },
                    {
                        "id": "team_fight",
                        "text": "Takƒ±m sava≈üƒ± √∂ner",
                        "next_node": "team_warboss_fight",
                        "effect": {"combat": 45, "charisma": 35, "xp": 75}
                    },
                    {
                        "id": "tactical_retreat",
                        "text": "Taktik geri √ßekilme",
                        "next_node": "tactical_retreat_from_orks",
                        "effect": {"strategy": 40, "stealth": 30, "xp": 60}
                    }
                ]
            },
            "warboss_duel": {
                "id": "warboss_duel",
                "title": "‚öîÔ∏è Warboss D√ºellosu - Ork Lideri ile Epik Sava≈ü",
                "description": "Ork Warboss Gorkamorka ile epik d√ºello ba≈ülƒ±yor! Warboss b√ºy√ºk choppa'sƒ±nƒ± sallƒ±yor, ye≈üil enerji ile √ßevrili. Siz de en iyi silahlarƒ±nƒ±zla hazƒ±rsƒ±nƒ±z. Arbites Commander Rex ve Tech-Priest Alpha-7 size moral veriyor. Bu d√ºello Hive City'nin kaderini belirleyecek!",
                "choices": [
                    {
                        "id": "melee_combat_warboss",
                        "text": "Yakƒ±n d√∂v√º≈ü sava≈üƒ±",
                        "next_node": "melee_warboss_battle",
                        "effect": {"combat": 60, "ork_rep": 50, "xp": 100}
                    },
                    {
                        "id": "ranged_combat_warboss",
                        "text": "Uzaktan sava≈ü",
                        "next_node": "ranged_warboss_battle",
                        "effect": {"combat": 55, "strategy": 35, "xp": 90}
                    },
                    {
                        "id": "tactical_combat_warboss",
                        "text": "Taktik sava≈ü",
                        "next_node": "tactical_warboss_battle",
                        "effect": {"strategy": 50, "combat": 45, "xp": 95}
                    },
                    {
                        "id": "honorable_surrender",
                        "text": "Onurlu teslimiyet",
                        "next_node": "honorable_surrender_to_orks",
                        "effect": {"charisma": 45, "ork_rep": 40, "xp": 85}
                    }
                ]
            },
            "melee_warboss_battle": {
                "id": "melee_warboss_battle",
                "title": "‚öîÔ∏è Yakƒ±n D√∂v√º≈ü Sava≈üƒ± - Warboss ile Son Kar≈üƒ±la≈üma",
                "description": "Ork Warboss ile yakƒ±n d√∂v√º≈ü sava≈üƒ±! Kƒ±lƒ±√ßlar √ßarpƒ±≈üƒ±yor, ye≈üil enerji her yerde. Warboss'un g√ºc√º inanƒ±lmaz ama sizin kararlƒ±lƒ±ƒüƒ±nƒ±z da √∂yle. Arbites Commander Rex size moral veriyor. Tech-Priest Alpha-7'nin silahlarƒ± √ßok i≈üe yarƒ±yor. Bu sava≈üƒ±n sonucu Hive City'nin kaderini belirleyecek!",
                "choices": [
                    {
                        "id": "final_strike_warboss",
                        "text": "Son vuru≈üu yap",
                        "next_node": "warboss_defeat",
                        "effect": {"combat": 70, "ork_rep": 60, "xp": 120}
                    },
                    {
                        "id": "use_imperial_weapon_hive",
                        "text": "ƒ∞mparator silahƒ±nƒ± kullan",
                        "next_node": "imperial_weapon_use_hive",
                        "effect": {"combat": 65, "ork_rep": 55, "xp": 110}
                    },
                    {
                        "id": "team_attack_warboss",
                        "text": "Takƒ±m saldƒ±rƒ±sƒ±",
                        "next_node": "team_warboss_attack",
                        "effect": {"combat": 60, "charisma": 40, "xp": 105}
                    },
                    {
                        "id": "sacrifice_attack_warboss",
                        "text": "Fedakarlƒ±k saldƒ±rƒ±sƒ±",
                        "next_node": "sacrifice_attack_warboss",
                        "effect": {"combat": 75, "sacrifice_points": 50, "xp": 130}
                    }
                ]
            },
            "warboss_defeat": {
                "id": "warboss_defeat",
                "title": "üèÜ Warboss Yenildi - Ork Zaferi!",
                "description": "Ork Warboss'u yendiniz! Warboss yere d√º≈ü√ºyor, ye≈üil enerji daƒüƒ±lƒ±yor. Ork'lar ≈üa≈ükƒ±nlƒ±k i√ßinde. Arbites Commander Rex size te≈üekk√ºr ediyor. Tech-Priest Alpha-7 zaferi kutluyor. Bu b√ºy√ºk bir zafer! Ork'lar Hive City'yi terk ediyor. ƒ∞mparator'un iradesi galip geldi!",
                "choices": [
                    {
                        "id": "secure_ork_victory",
                        "text": "Ork zaferini g√ºvenli hale getir",
                        "next_node": "ork_victory_securing",
                        "effect": {"strategy": 45, "hive_rep": 40, "xp": 100}
                    },
                    {
                        "id": "return_to_hive",
                        "text": "Hive City'ye d√∂n",
                        "next_node": "return_to_hive_victory",
                        "effect": {"hive_rep": 50, "governor_trust": 45, "xp": 110}
                    },
                    {
                        "id": "investigate_ork_remains",
                        "text": "Ork kalƒ±ntƒ±larƒ±nƒ± ara≈ütƒ±r",
                        "next_node": "ork_remains_investigation",
                        "effect": {"investigation": 50, "technology": 35, "xp": 105}
                    },
                    {
                        "id": "celebrate_ork_victory",
                        "text": "Ork zaferini kutla",
                        "next_node": "victory_celebration_hive",
                        "effect": {"charisma": 45, "hive_rep": 35, "xp": 95}
                    }
                ]
            },
            "return_to_hive_victory": {
                "id": "return_to_hive_victory",
                "title": "üèôÔ∏è Hive City'ye Zaferle D√∂n√º≈ü",
                "description": "Hive City'ye zaferle d√∂n√ºyorsunuz! Herkes sizi kar≈üƒ±lƒ±yor. Governor Maria size te≈üekk√ºr ediyor. Arbites Commander Rex sizi kutluyor. Tech-Priest Alpha-7 zaferi kutluyor. Ork Warboss √∂ld√º! Hive City artƒ±k daha g√ºvende. ƒ∞mparator'un iradesi galip geldi. Bu g√ºn Hive City'nin tarihinde altƒ±n harflerle yazƒ±lacak!",
                "choices": [
                    {
                        "id": "accept_hive_honor",
                        "text": "Hive onurunu kabul et",
                        "next_node": "hive_honor",
                        "effect": {"charisma": 60, "hive_rep": 70, "xp": 150}
                    },
                    {
                        "id": "rebuild_hive",
                        "text": "Hive City'yi yeniden in≈üa etmeye yardƒ±m et",
                        "next_node": "hive_rebuilding",
                        "effect": {"charisma": 50, "hive_rep": 60, "xp": 130}
                    },
                    {
                        "id": "share_hive_glory",
                        "text": "Hive zaferini payla≈ü",
                        "next_node": "glory_sharing_hive",
                        "effect": {"charisma": 55, "hive_rep": 65, "xp": 140}
                    },
                    {
                        "id": "end_hive_mission",
                        "text": "Hive g√∂revini sonlandƒ±r",
                        "next_node": "end",
                        "effect": {"xp": 200}
                    }
                ]
            },
            "artillery_coordination_hive": {
                "id": "artillery_coordination_hive",
                "title": "Hive Top√ßu Koordinasyonu",
                "description": "Hive City'nin top√ßu birimlerini koordine ediyorsunuz.",
                "choices": [
                    {
                        "id": "coordinate_hive_artillery",
                        "text": "Hive top√ßularƒ±nƒ± koordine et",
                        "next_node": "elite_guard_combat",
                        "effect": {"strategy": 40, "xp": 55}
                    }
                ]
            },
            "chaos_cult_hunt_hive": {
                "id": "chaos_cult_hunt_hive",
                "title": "Chaos K√ºlt√º Avƒ±",
                "description": "Chaos k√ºlt√ºn√º avlƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "eliminate_chaos_cult",
                        "text": "Chaos k√ºlt√ºn√º yok et",
                        "next_node": "warboss_defeat",
                        "effect": {"combat": 45, "xp": 70}
                    }
                ]
            },
            "chaos_negotiation": {
                "id": "chaos_negotiation",
                "title": "Chaos M√ºzakeresi",
                "description": "Chaos k√ºlt√º ile m√ºzakere ediyorsunuz.",
                "choices": [
                    {
                        "id": "negotiate_chaos_terms",
                        "text": "Chaos ≈üartlarƒ±nƒ± m√ºzakere et",
                        "next_node": "united_peace_conference",
                        "effect": {"charisma": 35, "xp": 50}
                    }
                ]
            },
            "communication_network_hive": {
                "id": "communication_network_hive",
                "title": "Hive ƒ∞leti≈üim Aƒüƒ±",
                "description": "Hive City'nin ileti≈üim aƒüƒ±nƒ± kuruyorsunuz.",
                "choices": [
                    {
                        "id": "establish_communication",
                        "text": "ƒ∞leti≈üimi kur",
                        "next_node": "hive_combined_arms",
                        "effect": {"strategy": 35, "xp": 50}
                    }
                ]
            },
            "cybernetic_enhancement_hive": {
                "id": "cybernetic_enhancement_hive",
                "title": "Hive Cybernetic Geli≈ütirme",
                "description": "Cybernetic geli≈ütirme yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "enhance_cybernetics",
                        "text": "Cybernetics'i geli≈ütir",
                        "next_node": "elite_guard_combat",
                        "effect": {"technology": 40, "xp": 60}
                    }
                ]
            },
            "elite_guard_combat": {
                "id": "elite_guard_combat",
                "title": "Elit Muhafƒ±z Sava≈üƒ±",
                "description": "Elit muhafƒ±z birliƒüi ile sava≈üƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "lead_elite_guards",
                        "text": "Elit muhafƒ±zlarƒ± y√∂net",
                        "next_node": "warboss_duel",
                        "effect": {"combat": 50, "xp": 75}
                    }
                ]
            },
            "emergency_protocols_hive": {
                "id": "emergency_protocols_hive",
                "title": "Hive Acil Durum Protokolleri",
                "description": "Acil durum protokollerini aktifle≈ütiriyorsunuz.",
                "choices": [
                    {
                        "id": "activate_protocols",
                        "text": "Protokolleri aktifle≈ütir",
                        "next_node": "hive_defensive_planning",
                        "effect": {"strategy": 40, "xp": 55}
                    }
                ]
            },
            "genestealer_investigation_hive": {
                "id": "genestealer_investigation_hive",
                "title": "Genestealer Ara≈ütƒ±rmasƒ±",
                "description": "Genestealer izini ara≈ütƒ±rƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "track_genestealers",
                        "text": "Genestealer'larƒ± takip et",
                        "next_node": "underground_network_hive",
                        "effect": {"investigation": 45, "xp": 65}
                    }
                ]
            },
            "genestealer_negotiation": {
                "id": "genestealer_negotiation",
                "title": "Genestealer M√ºzakeresi",
                "description": "Genestealer'lar ile m√ºzakere ediyorsunuz.",
                "choices": [
                    {
                        "id": "negotiate_genestealer_terms",
                        "text": "Genestealer ≈üartlarƒ±nƒ± m√ºzakere et",
                        "next_node": "united_peace_conference",
                        "effect": {"charisma": 30, "xp": 45}
                    }
                ]
            },
            "glory_sharing_hive": {
                "id": "glory_sharing_hive",
                "title": "Hive Zafer Payla≈üƒ±mƒ±",
                "description": "Hive zaferini payla≈üƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "share_hive_victory",
                        "text": "Hive zaferini payla≈ü",
                        "next_node": "end",
                        "effect": {"charisma": 60, "xp": 100}
                    }
                ]
            },
            "hive_combined_arms": {
                "id": "hive_combined_arms",
                "title": "Hive Birle≈üik Kuvvet",
                "description": "Birle≈üik kuvvet stratejisini uyguluyorsunuz.",
                "choices": [
                    {
                        "id": "execute_combined_hive_strategy",
                        "text": "Birle≈üik Hive stratejisini uygula",
                        "next_node": "elite_guard_combat",
                        "effect": {"strategy": 55, "xp": 80}
                    }
                ]
            },
            "hive_defense_activation": {
                "id": "hive_defense_activation",
                "title": "Hive Savunma Aktivasyonu",
                "description": "Hive savunma sistemlerini aktifle≈ütiriyorsunuz.",
                "choices": [
                    {
                        "id": "activate_hive_defenses",
                        "text": "Hive savunmalarƒ±nƒ± aktifle≈ütir",
                        "next_node": "elite_guard_combat",
                        "effect": {"technology": 50, "xp": 75}
                    }
                ]
            },
            "hive_defensive_planning": {
                "id": "hive_defensive_planning",
                "title": "Hive Savunma Planlamasƒ±",
                "description": "Hive savunma stratejisi planlƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "implement_hive_defense",
                        "text": "Hive savunmasƒ±nƒ± uygula",
                        "next_node": "upper_hive_defense",
                        "effect": {"strategy": 50, "xp": 70}
                    }
                ]
            },
            "hive_guerrilla_planning": {
                "id": "hive_guerrilla_planning",
                "title": "Hive Gerilla Planlamasƒ±",
                "description": "Gerilla sava≈üƒ± taktikleri planlƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "execute_hive_guerrilla",
                        "text": "Hive gerilla taktiƒüini uygula",
                        "next_node": "underground_network_hive",
                        "effect": {"stealth": 45, "xp": 65}
                    }
                ]
            },
            "hive_honor": {
                "id": "hive_honor",
                "title": "Hive Onuru",
                "description": "Hive onurunu kabul ediyorsunuz.",
                "choices": [
                    {
                        "id": "accept_hive_honor",
                        "text": "Hive onuru kabul et",
                        "next_node": "end",
                        "effect": {"charisma": 70, "xp": 120}
                    }
                ]
            },
            "hive_offensive_planning": {
                "id": "hive_offensive_planning",
                "title": "Hive Saldƒ±rƒ± Planlamasƒ±",
                "description": "Saldƒ±rƒ± stratejisi geli≈ütiriyorsunuz.",
                "choices": [
                    {
                        "id": "launch_hive_offensive",
                        "text": "Hive saldƒ±rƒ±sƒ±nƒ± ba≈ülat",
                        "next_node": "ork_negotiation",
                        "effect": {"combat": 50, "xp": 70}
                    }
                ]
            },
            "hive_rebuilding": {
                "id": "hive_rebuilding",
                "title": "Hive Yeniden ƒ∞n≈üasƒ±",
                "description": "Hive City'yi yeniden in≈üa ediyorsunuz.",
                "choices": [
                    {
                        "id": "complete_hive_rebuilding",
                        "text": "Hive yeniden in≈üasƒ±nƒ± tamamla",
                        "next_node": "end",
                        "effect": {"charisma": 60, "xp": 120}
                    }
                ]
            },
            "honorable_surrender_to_orks": {
                "id": "honorable_surrender_to_orks",
                "title": "Ork'lara Onurlu Teslimiyet",
                "description": "Ork'lara onurlu teslimiyet yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "negotiate_surrender_terms",
                        "text": "Teslimiyet ≈üartlarƒ±nƒ± m√ºzakere et",
                        "next_node": "territory_offer_to_orks",
                        "effect": {"charisma": 40, "xp": 60}
                    }
                ]
            },
            "imperial_weapon_use_hive": {
                "id": "imperial_weapon_use_hive",
                "title": "Hive Imperial Silah Kullanƒ±mƒ±",
                "description": "ƒ∞mparator silahƒ±nƒ± kullanƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "victory_with_imperial_weapon",
                        "text": "Imperial silahla zafer kazan",
                        "next_node": "warboss_defeat",
                        "effect": {"combat": 70, "xp": 110}
                    }
                ]
            },
            "medical_evacuation_hive": {
                "id": "medical_evacuation_hive",
                "title": "Hive Tƒ±bbi Tahliye",
                "description": "Tƒ±bbi tahliye organize ediyorsunuz.",
                "choices": [
                    {
                        "id": "evacuate_wounded",
                        "text": "Yaralƒ±larƒ± tahliye et",
                        "next_node": "hive_defensive_planning",
                        "effect": {"charisma": 35, "xp": 50}
                    }
                ]
            },
            "ork_deception": {
                "id": "ork_deception",
                "title": "Ork Aldatmacasƒ±",
                "description": "Ork'larƒ± aldatƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "execute_deception",
                        "text": "Aldatmacayƒ± ger√ßekle≈ütir",
                        "next_node": "warboss_challenge",
                        "effect": {"deception": 45, "xp": 65}
                    }
                ]
            },
            "ork_gang_confrontation_hive": {
                "id": "ork_gang_confrontation_hive",
                "title": "Ork √áetesi Kar≈üƒ±la≈ümasƒ±",
                "description": "Ork √ßetesiyle y√ºzle≈üiyorsunuz.",
                "choices": [
                    {
                        "id": "fight_ork_gang",
                        "text": "Ork √ßetesiyle sava≈ü",
                        "next_node": "warboss_duel",
                        "effect": {"combat": 40, "xp": 60}
                    }
                ]
            },
            "ork_remains_investigation": {
                "id": "ork_remains_investigation",
                "title": "Ork Kalƒ±ntƒ±larƒ± Ara≈ütƒ±rmasƒ±",
                "description": "Ork kalƒ±ntƒ±larƒ±nƒ± ara≈ütƒ±rƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "analyze_ork_remains",
                        "text": "Ork kalƒ±ntƒ±larƒ±nƒ± analiz et",
                        "next_node": "ork_victory_securing",
                        "effect": {"investigation": 45, "xp": 65}
                    }
                ]
            },
            "ork_victory_securing": {
                "id": "ork_victory_securing",
                "title": "Ork Zaferi G√ºvenli Hale Getirme",
                "description": "Ork zaferini g√ºvenli hale getiriyorsunuz.",
                "choices": [
                    {
                        "id": "secure_ork_victory",
                        "text": "Ork zaferini g√ºvenli hale getir",
                        "next_node": "return_to_hive_victory",
                        "effect": {"strategy": 50, "xp": 75}
                    }
                ]
            },
            "ranged_warboss_battle": {
                "id": "ranged_warboss_battle",
                "title": "Uzaktan Warboss Sava≈üƒ±",
                "description": "Uzaktan sava≈ü yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "ranged_warboss_victory",
                        "text": "Uzaktan Warboss zafer kazan",
                        "next_node": "warboss_defeat",
                        "effect": {"combat": 60, "xp": 90}
                    }
                ]
            },
            "resource_allocation_hive": {
                "id": "resource_allocation_hive",
                "title": "Hive Kaynak Daƒüƒ±lƒ±mƒ±",
                "description": "Kaynak daƒüƒ±lƒ±mƒ± yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "allocate_hive_resources",
                        "text": "Hive kaynaklarƒ±nƒ± daƒüƒ±t",
                        "next_node": "hive_defensive_planning",
                        "effect": {"strategy": 35, "xp": 50}
                    }
                ]
            },
            "sacrifice_attack_warboss": {
                "id": "sacrifice_attack_warboss",
                "title": "Warboss'a Fedakarlƒ±k Saldƒ±rƒ±sƒ±",
                "description": "Warboss'a fedakarlƒ±k saldƒ±rƒ±sƒ± yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "heroic_warboss_sacrifice",
                        "text": "Kahramanca Warboss fedakarlƒ±ƒüƒ±",
                        "next_node": "warboss_defeat",
                        "effect": {"combat": 80, "sacrifice_points": 100, "xp": 150}
                    }
                ]
            },
            "special_weapons_request": {
                "id": "special_weapons_request",
                "title": "√ñzel Silah ƒ∞steƒüi",
                "description": "√ñzel silahlar istiyorsunuz.",
                "choices": [
                    {
                        "id": "obtain_special_weapons",
                        "text": "√ñzel silahlarƒ± edinin",
                        "next_node": "warboss_duel",
                        "effect": {"technology": 45, "xp": 65}
                    }
                ]
            },
            "tactical_retreat_from_orks": {
                "id": "tactical_retreat_from_orks",
                "title": "Ork'lardan Taktik Geri √áekilme",
                "description": "Ork'lardan taktik geri √ßekilme yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "regroup_against_orks",
                        "text": "Ork'lara kar≈üƒ± yeniden toparlan",
                        "next_node": "hive_defensive_planning",
                        "effect": {"strategy": 45, "xp": 60}
                    }
                ]
            },
            "tactical_warboss_battle": {
                "id": "tactical_warboss_battle",
                "title": "Taktik Warboss Sava≈üƒ±",
                "description": "Taktik sava≈ü yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "tactical_warboss_victory",
                        "text": "Taktik Warboss zafer kazan",
                        "next_node": "warboss_defeat",
                        "effect": {"strategy": 55, "xp": 95}
                    }
                ]
            },
            "team_warboss_attack": {
                "id": "team_warboss_attack",
                "title": "Takƒ±m Warboss Saldƒ±rƒ±sƒ±",
                "description": "Takƒ±m saldƒ±rƒ±sƒ± yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "coordinated_warboss_attack",
                        "text": "Koordineli Warboss saldƒ±rƒ±sƒ±",
                        "next_node": "warboss_defeat",
                        "effect": {"combat": 65, "xp": 95}
                    }
                ]
            },
            "team_warboss_fight": {
                "id": "team_warboss_fight",
                "title": "Takƒ±m Warboss Sava≈üƒ±",
                "description": "Takƒ±m sava≈üƒ± yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "team_warboss_victory",
                        "text": "Takƒ±m Warboss zaferi",
                        "next_node": "warboss_defeat",
                        "effect": {"combat": 60, "xp": 90}
                    }
                ]
            },
            "tech_support_hive": {
                "id": "tech_support_hive",
                "title": "Hive Teknik Destek",
                "description": "Teknik destek saƒülƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "provide_tech_support",
                        "text": "Teknik destek saƒüla",
                        "next_node": "hive_defense_activation",
                        "effect": {"technology": 35, "xp": 50}
                    }
                ]
            },
            "territory_offer_to_orks": {
                "id": "territory_offer_to_orks",
                "title": "Ork'lara B√∂lge Teklifi",
                "description": "Ork'lara b√∂lge teklifi yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "negotiate_territory",
                        "text": "B√∂lgeyi m√ºzakere et",
                        "next_node": "united_peace_conference",
                        "effect": {"charisma": 40, "xp": 60}
                    }
                ]
            },
            "underground_network_hive": {
                "id": "underground_network_hive",
                "title": "Hive Yeraltƒ± Aƒüƒ±",
                "description": "Yeraltƒ± aƒüƒ±nƒ± ke≈üfediyorsunuz.",
                "choices": [
                    {
                        "id": "explore_underground",
                        "text": "Yeraltƒ±nƒ± ke≈üfet",
                        "next_node": "genestealer_investigation_hive",
                        "effect": {"stealth": 40, "xp": 60}
                    }
                ]
            },
            "united_peace_conference": {
                "id": "united_peace_conference",
                "title": "Birle≈üik Barƒ±≈ü Konferansƒ±",
                "description": "Birle≈üik barƒ±≈ü g√∂r√º≈ümeleri yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "achieve_peace",
                        "text": "Barƒ±≈üƒ± ba≈üar",
                        "next_node": "return_to_hive_victory",
                        "effect": {"charisma": 60, "diplomacy": 50, "xp": 100}
                    }
                ]
            },
            "victory_celebration_hive": {
                "id": "victory_celebration_hive",
                "title": "Hive Zafer Kutlamasƒ±",
                "description": "Hive zaferini kutluyorsunuz.",
                "choices": [
                    {
                        "id": "celebrate_hive_victory",
                        "text": "Hive zaferini kutla",
                        "next_node": "end",
                        "effect": {"charisma": 50, "xp": 80}
                    }
                ]
            },
            "weapon_factory_hive": {
                "id": "weapon_factory_hive",
                "title": "Hive Silah Fabrikasƒ±",
                "description": "Silah fabrikasƒ±nƒ± √ßalƒ±≈ütƒ±rƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "produce_weapons",
                        "text": "Silah √ºret",
                        "next_node": "elite_guard_combat",
                        "effect": {"technology": 40, "xp": 60}
                    }
                ]
            },
            "weapon_offer_to_orks": {
                "id": "weapon_offer_to_orks",
                "title": "Ork'lara Silah Teklifi",
                "description": "Ork'lara silah teklifi yapƒ±yorsunuz.",
                "choices": [
                    {
                        "id": "provide_weapons_to_orks",
                        "text": "Ork'lara silah saƒüla",
                        "next_node": "territory_offer_to_orks",
                        "effect": {"charisma": 35, "xp": 55}
                    }
                ]
            },
            "end": {
                "id": "end",
                "title": "üéâ Hive City Crisis Macera Tamamlandƒ±",
                "description": "Hive City Tertium'da ya≈üanan bu epik macera sona erdi. Ork Warboss √∂ld√º, Hive City g√ºvende, ƒ∞mparator'un iradesi galip geldi. Siz bu zaferin kahramanƒ±sƒ±nƒ±z!",
                "choices": [
                    {
                        "id": "return_main_menu",
                        "text": "Ana Men√ºye D√∂n",
                        "next_node": "start",
                        "effect": {"xp": 50}
                    }
                ]
            }
        }
    }
}

@app.route('/')
def home():
    try:
        return render_template('index.html')
    except Exception as e:
        app.logger.error(f'Error in home route: {e}')
        app.logger.error(f'Traceback: {traceback.format_exc()}')
        return f'Error: {str(e)}', 500

@app.route('/test')
def test():
    return jsonify({"status": "OK", "message": "Server is working"})

@app.route('/game')
def game():
    return render_template('game.html')

@app.route('/login')
def login():
    return '''
    <!DOCTYPE html>
    <html lang="tr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Giri≈ü - AI Dungeon Master</title>
        <style>
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #2a2a2a 100%);
                color: white;
                margin: 0;
                padding: 20px;
                min-height: 100vh;
                display: flex;
                justify-content: center;
                align-items: center;
            }
            .container {
                text-align: center;
                background: rgba(26, 26, 26, 0.8);
                padding: 40px;
                border-radius: 12px;
                border: 2px solid #FFD700;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
                max-width: 400px;
                width: 100%;
            }
            .button {
                background: linear-gradient(45deg, #FFD700, #FFA500);
                color: #000;
                border: none;
                padding: 12px 24px;
                border-radius: 6px;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                margin: 5px;
                text-decoration: none;
                display: inline-block;
                transition: all 0.3s ease;
            }
            .button:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>üîê Gƒ∞Rƒ∞≈û</h1>
            <p>Giri≈ü sistemi yakƒ±nda aktif olacak!</p>
            <a href="/" class="button">‚Üê Ana Sayfa</a>
            <a href="/game" class="button">üéÆ Oyna</a>
        </div>
    </body>
    </html>
    '''

@app.route('/register')
def register():
    return '''
    <!DOCTYPE html>
    <html lang="tr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Kayƒ±t - AI Dungeon Master</title>
        <style>
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #2a2a2a 100%);
                color: white;
                margin: 0;
                padding: 20px;
                min-height: 100vh;
                display: flex;
                justify-content: center;
                align-items: center;
            }
            .container {
                text-align: center;
                background: rgba(26, 26, 26, 0.8);
                padding: 40px;
                border-radius: 12px;
                border: 2px solid #FFD700;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
                max-width: 400px;
                width: 100%;
            }
            .button {
                background: linear-gradient(45deg, #FFD700, #FFA500);
                color: #000;
                border: none;
                padding: 12px 24px;
                border-radius: 6px;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                margin: 5px;
                text-decoration: none;
                display: inline-block;
                transition: all 0.3s ease;
            }
            .button:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>üìù KAYIT</h1>
            <p>Kayƒ±t sistemi yakƒ±nda aktif olacak!</p>
            <a href="/" class="button">‚Üê Ana Sayfa</a>
            <a href="/game" class="button">üéÆ Oyna</a>
        </div>
    </body>
    </html>
    '''

@app.route('/multiplayer')
def multiplayer():
    return '''
    <!DOCTYPE html>
    <html lang="tr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Multiplayer - AI Dungeon Master</title>
        <style>
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #2a2a2a 100%);
                color: white;
                margin: 0;
                padding: 20px;
                min-height: 100vh;
                display: flex;
                justify-content: center;
                align-items: center;
            }
            .container {
                text-align: center;
                background: rgba(26, 26, 26, 0.8);
                padding: 40px;
                border-radius: 12px;
                border: 2px solid #FFD700;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
                max-width: 400px;
                width: 100%;
            }
            .button {
                background: linear-gradient(45deg, #FFD700, #FFA500);
                color: #000;
                border: none;
                padding: 12px 24px;
                border-radius: 6px;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                margin: 5px;
                text-decoration: none;
                display: inline-block;
                transition: all 0.3s ease;
            }
            .button:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>üë• MULTIPLAYER</h1>
            <p>Multiplayer sistemi yakƒ±nda aktif olacak!</p>
            <a href="/" class="button">‚Üê Ana Sayfa</a>
            <a href="/game" class="button">üéÆ Oyna</a>
        </div>
    </body>
    </html>
    '''

@app.route('/static/<path:filename>')
def static_files(filename):
    return send_from_directory('static', filename)

@app.route('/test-buttons')
def test_buttons():
    return send_from_directory('.', 'test_buttons.html')

@app.route('/ai-scenarios')
def ai_scenarios():
    return '''
    <!DOCTYPE html>
    <html lang="tr">
    <head>
        <title>AI Senaryolar - AI Dungeon Master</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #2a2a2a 100%);
                color: white;
                margin: 0;
                padding: 20px;
                min-height: 100vh;
            }
            .container {
                max-width: 800px;
                margin: 0 auto;
                background: rgba(26, 26, 26, 0.8);
                padding: 40px;
                border-radius: 12px;
                border: 2px solid #9C27B0;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            }
            .ai-header {
                text-align: center;
                margin-bottom: 30px;
            }
            .ai-icon {
                font-size: 60px;
                color: #9C27B0;
                margin-bottom: 10px;
            }
            .ai-title {
                font-size: 32px;
                font-weight: bold;
                color: #9C27B0;
                margin-bottom: 10px;
            }
            .form-group {
                margin-bottom: 20px;
            }
            label {
                display: block;
                margin-bottom: 5px;
                color: #9C27B0;
                font-weight: bold;
            }
            input, select, textarea {
                width: 100%;
                padding: 10px;
                border: 1px solid #9C27B0;
                border-radius: 4px;
                background: rgba(255, 255, 255, 0.1);
                color: white;
                box-sizing: border-box;
            }
            textarea {
                height: 100px;
                resize: vertical;
            }
            .button {
                background: linear-gradient(45deg, #9C27B0, #673AB7);
                color: white;
                border: none;
                padding: 12px 24px;
                border-radius: 6px;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                margin: 5px;
                transition: all 0.3s ease;
            }
            .button:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(156, 39, 176, 0.4);
            }
            .scenario-result {
                background: rgba(0, 0, 0, 0.3);
                padding: 20px;
                border-radius: 8px;
                margin-top: 20px;
                border-left: 4px solid #9C27B0;
            }
            .loading {
                text-align: center;
                color: #9C27B0;
                font-style: italic;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="ai-header">
                <div class="ai-icon">ü§ñ</div>
                <h1 class="ai-title">AI SENARYO √úRETƒ∞Cƒ∞</h1>
                <p>Kendi hikayeni olu≈ütur!</p>
            </div>
            
            <form id="ai-scenario-form">
                <div class="form-group">
                    <label>Senaryo Temasƒ±</label>
                    <select id="theme" required>
                        <option value="">Tema se√ßin...</option>
                        <option value="fantasy">Fantasy</option>
                        <option value="warhammer">Warhammer 40K</option>
                        <option value="cyberpunk">Cyberpunk</option>
                        <option value="scifi">Bilim Kurgu</option>
                        <option value="horror">Korku</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Senaryo Ba≈ülƒ±ƒüƒ±</label>
                    <input type="text" id="title" placeholder="Senaryonun ba≈ülƒ±ƒüƒ±nƒ± girin..." required>
                </div>
                
                <div class="form-group">
                    <label>Ana Karakter</label>
                    <input type="text" id="character" placeholder="Ana karakterin adƒ±nƒ± girin..." required>
                </div>
                
                <div class="form-group">
                    <label>Senaryo A√ßƒ±klamasƒ±</label>
                    <textarea id="description" placeholder="Senaryonun kƒ±sa a√ßƒ±klamasƒ±nƒ± girin..." required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Zorluk Seviyesi</label>
                    <select id="difficulty" required>
                        <option value="">Zorluk se√ßin...</option>
                        <option value="easy">Kolay</option>
                        <option value="medium">Orta</option>
                        <option value="hard">Zor</option>
                        <option value="extreme">A≈üƒ±rƒ± Zor</option>
                    </select>
                </div>
                
                <div style="text-align: center;">
                    <button type="submit" class="button">ü§ñ AI SENARYO √úRET</button>
                    <button type="button" class="button" onclick="window.location.href='/game'">üéÆ OYUNA D√ñN</button>
                    <button type="button" class="button" onclick="window.location.href='/'">üè† ANA SAYFA</button>
                </div>
            </form>
            
            <div id="scenario-result" class="scenario-result" style="display: none;">
                <h3>üé≠ √úretilen Senaryo</h3>
                <div id="generated-scenario"></div>
                <div style="text-align: center; margin-top: 20px;">
                    <button class="button" onclick="saveScenario()">üíæ SENARYOYU KAYDET</button>
                    <button class="button" onclick="playScenario()">üéÆ OYNA</button>
                </div>
            </div>
        </div>

        <script>
            let currentScenario = null;
            
            document.getElementById('ai-scenario-form').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const formData = {
                    theme: document.getElementById('theme').value,
                    title: document.getElementById('title').value,
                    character: document.getElementById('character').value,
                    description: document.getElementById('description').value,
                    difficulty: document.getElementById('difficulty').value
                };
                
                // Loading g√∂ster
                document.getElementById('scenario-result').style.display = 'block';
                document.getElementById('generated-scenario').innerHTML = `
                    <div class="loading">
                        <h4>ü§ñ AI senaryo √ºretiyor...</h4>
                        <p>L√ºtfen bekleyin, bu birka√ß saniye s√ºrebilir...</p>
                    </div>
                `;
                
                try {
                    // Ger√ßek AI senaryo √ºretimi
                    const response = await fetch('/api/generate-scenario', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(formData)
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        currentScenario = result.scenario;
                        displayGeneratedScenario(result.scenario);
                    } else {
                        throw new Error(result.error || 'Senaryo √ºretimi ba≈üarƒ±sƒ±z');
                    }
                } catch (error) {
                    console.error('AI Scenario generation error:', error);
                    document.getElementById('generated-scenario').innerHTML = `
                        <div style="color: #ff6b6b;">
                            <h4>‚ùå Hata!</h4>
                            <p>Senaryo √ºretimi sƒ±rasƒ±nda bir hata olu≈ütu: ${error.message}</p>
                            <p>L√ºtfen tekrar deneyin.</p>
                        </div>
                    `;
                }
            });
            
            function displayGeneratedScenario(scenario) {
                document.getElementById('generated-scenario').innerHTML = `
                    <h4>üé≠ ${scenario.title}</h4>
                    <div style="margin: 15px 0;">
                        <p><strong>üéØ Tema:</strong> ${scenario.theme}</p>
                        <p><strong>‚öîÔ∏è Zorluk:</strong> ${scenario.difficulty}</p>
                        <p><strong>üéÆ Seviye:</strong> ${scenario.min_level}-${scenario.max_level}</p>
                        <p><strong>‚è±Ô∏è S√ºre:</strong> ${scenario.duration} dakika</p>
                    </div>
                    <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 6px; margin: 15px 0;">
                        <p><strong>üìñ A√ßƒ±klama:</strong></p>
                        <p>${scenario.description}</p>
                    </div>
                    <div style="margin: 10px 0;">
                        <p><strong>üè∞ Hikaye Noktalarƒ±:</strong> ${Object.keys(scenario.story_nodes || {}).length} adet</p>
                        <p><strong>üë• NPC'ler:</strong> ${Object.keys(scenario.npc_relationships || {}).length} adet</p>
                        <p><strong>üéØ G√∂rev Zincirleri:</strong> ${Object.keys(scenario.quest_chains || {}).length} adet</p>
                    </div>
                    <div style="background: rgba(156, 39, 176, 0.2); padding: 10px; border-radius: 6px; margin: 15px 0;">
                        <p style="color: #9C27B0; font-weight: bold;">‚ú® Bu senaryo AI tarafƒ±ndan √∂zel olarak sizin i√ßin √ºretildi!</p>
                        <p style="font-size: 12px; color: rgba(255,255,255,0.7);">ID: ${scenario.id} | Olu≈üturulma: ${new Date().toLocaleString('tr-TR')}</p>
                    </div>
                `;
            }
            
            async function saveScenario() {
                if (!currentScenario) {
                    alert('‚ùå Kaydedilecek senaryo yok!');
                    return;
                }
                
                try {
                    const response = await fetch('/api/scenarios/save', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            scenario: currentScenario,
                            user_id: 'guest_user'
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        alert('‚úÖ Senaryo ba≈üarƒ±yla kaydedildi!');
                    } else {
                        alert('‚ùå Kaydetme ba≈üarƒ±sƒ±z: ' + result.error);
                    }
                } catch (error) {
                    console.error('Save error:', error);
                    alert('‚ùå Kaydetme sƒ±rasƒ±nda hata: ' + error.message);
                }
            }
            
            async function playScenario() {
                if (!currentScenario) {
                    alert('‚ùå Oynanacak senaryo yok!');
                    return;
                }
                
                // Senaryoyu oyun moduna aktar
                localStorage.setItem('selectedScenario', JSON.stringify(currentScenario));
                window.location.href = '/game?scenario=' + currentScenario.id;
            }
        </script>
    </body>
    </html>
    '''

@app.route('/ai-scenario')
def ai_scenario():
    return '''
    <!DOCTYPE html>
    <html lang="tr">
    <head>
        <title>AI Senaryo √úretimi - AI Dungeon Master</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #2a2a2a 100%);
                color: white;
                margin: 0;
                padding: 20px;
                min-height: 100vh;
            }
            .container {
                max-width: 800px;
                margin: 0 auto;
                background: rgba(26, 26, 26, 0.8);
                padding: 40px;
                border-radius: 12px;
                border: 2px solid #9C27B0;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            }
            .ai-header {
                text-align: center;
                margin-bottom: 30px;
            }
            .ai-icon {
                font-size: 60px;
                color: #9C27B0;
                margin-bottom: 10px;
            }
            .ai-title {
                font-size: 32px;
                font-weight: bold;
                color: #9C27B0;
                margin-bottom: 10px;
            }
            .form-group {
                margin-bottom: 20px;
            }
            label {
                display: block;
                margin-bottom: 5px;
                color: #9C27B0;
                font-weight: bold;
            }
            input, select, textarea {
                width: 100%;
                padding: 10px;
                border: 1px solid #9C27B0;
                border-radius: 4px;
                background: rgba(255, 255, 255, 0.1);
                color: white;
                box-sizing: border-box;
            }
            textarea {
                height: 100px;
                resize: vertical;
            }
            .button {
                background: linear-gradient(45deg, #9C27B0, #673AB7);
                color: white;
                border: none;
                padding: 12px 24px;
                border-radius: 6px;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                margin: 5px;
                transition: all 0.3s ease;
            }
            .button:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(156, 39, 176, 0.4);
            }
            .scenario-result {
                background: rgba(0, 0, 0, 0.3);
                padding: 20px;
                border-radius: 8px;
                margin-top: 20px;
                border-left: 4px solid #9C27B0;
            }
            .loading {
                text-align: center;
                color: #9C27B0;
                font-style: italic;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="ai-header">
                <div class="ai-icon">ü§ñ</div>
                <h1 class="ai-title">AI SENARYO √úRETƒ∞Cƒ∞</h1>
                <p>Kendi hikayeni olu≈ütur!</p>
            </div>
            
            <form id="ai-scenario-form">
                <div class="form-group">
                    <label>Senaryo Temasƒ±</label>
                    <select id="theme" required>
                        <option value="">Tema se√ßin...</option>
                        <option value="fantasy">Fantasy</option>
                        <option value="warhammer">Warhammer 40K</option>
                        <option value="cyberpunk">Cyberpunk</option>
                        <option value="scifi">Bilim Kurgu</option>
                        <option value="horror">Korku</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Senaryo Ba≈ülƒ±ƒüƒ±</label>
                    <input type="text" id="title" placeholder="Senaryonun ba≈ülƒ±ƒüƒ±nƒ± girin..." required>
                </div>
                
                <div class="form-group">
                    <label>Ana Karakter</label>
                    <input type="text" id="character" placeholder="Ana karakterin adƒ±nƒ± girin..." required>
                </div>
                
                <div class="form-group">
                    <label>Senaryo A√ßƒ±klamasƒ±</label>
                    <textarea id="description" placeholder="Senaryonun kƒ±sa a√ßƒ±klamasƒ±nƒ± girin..." required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Zorluk Seviyesi</label>
                    <select id="difficulty" required>
                        <option value="">Zorluk se√ßin...</option>
                        <option value="easy">Kolay</option>
                        <option value="medium">Orta</option>
                        <option value="hard">Zor</option>
                        <option value="extreme">A≈üƒ±rƒ± Zor</option>
                    </select>
                </div>
                
                <div style="text-align: center;">
                    <button type="submit" class="button">ü§ñ AI SENARYO √úRET</button>
                    <button type="button" class="button" onclick="window.location.href='/game'">üéÆ OYUNA D√ñN</button>
                    <button type="button" class="button" onclick="window.location.href='/'">üè† ANA SAYFA</button>
                </div>
            </form>
            
            <div id="scenario-result" class="scenario-result" style="display: none;">
                <h3>üé≠ √úretilen Senaryo</h3>
                <div id="generated-scenario"></div>
                <div style="text-align: center; margin-top: 20px;">
                    <button class="button" onclick="saveScenario()">üíæ SENARYOYU KAYDET</button>
                    <button class="button" onclick="playScenario()">‚ñ∂Ô∏è OYNA</button>
                </div>
            </div>
        </div>
        
        <script>
            document.getElementById('ai-scenario-form').addEventListener('submit', function(e) {
                e.preventDefault();
                generateScenario();
            });
            
            function generateScenario() {
                const form = document.getElementById('ai-scenario-form');
                const result = document.getElementById('scenario-result');
                const generated = document.getElementById('generated-scenario');
                
                // Show loading
                result.style.display = 'block';
                generated.innerHTML = '<div class="loading">ü§ñ AI senaryo √ºretiyor...</div>';
                
                // Get form data
                const theme = document.getElementById('theme').value;
                const title = document.getElementById('title').value;
                const character = document.getElementById('character').value;
                const description = document.getElementById('description').value;
                const difficulty = document.getElementById('difficulty').value;
                
                // Simulate AI generation
                setTimeout(() => {
                    const scenario = createAIScenario(theme, title, character, description, difficulty);
                    generated.innerHTML = scenario;
                }, 2000);
            }
            
            function createAIScenario(theme, title, character, description, difficulty) {
                const themes = {
                    fantasy: "üè∞",
                    warhammer: "‚öîÔ∏è",
                    cyberpunk: "üåÉ",
                    scifi: "üöÄ",
                    horror: "üëª"
                };
                
                const difficulties = {
                    easy: "üü¢ Kolay",
                    medium: "üü° Orta", 
                    hard: "üî¥ Zor",
                    extreme: "‚ö´ A≈üƒ±rƒ± Zor"
                };
                
                return `
                    <div style="margin-bottom: 20px;">
                        <h4>${themes[theme]} ${title}</h4>
                        <p><strong>Ana Karakter:</strong> ${character}</p>
                        <p><strong>A√ßƒ±klama:</strong> ${description}</p>
                        <p><strong>Zorluk:</strong> ${difficulties[difficulty]}</p>
                        <p><strong>Tahmini S√ºre:</strong> ${Math.floor(Math.random() * 180) + 60} dakika</p>
                    </div>
                    
                    <div style="background: rgba(156, 39, 176, 0.1); padding: 15px; border-radius: 6px; margin-bottom: 15px;">
                        <h5>üéØ Ana G√∂revler:</h5>
                        <ul>
                            <li>${character} olarak d√ºnyayƒ± ke≈üfet</li>
                            <li>Gizemli tehdidi ara≈ütƒ±r</li>
                            <li>G√º√ßl√º m√ºttefikler bul</li>
                            <li>Final sava≈üƒ±nda zafer kazan</li>
                        </ul>
                    </div>
                    
                    <div style="background: rgba(156, 39, 176, 0.1); padding: 15px; border-radius: 6px;">
                        <h5>üé≠ Hikaye Elementleri:</h5>
                        <ul>
                            <li>Detaylƒ± karakter geli≈üimi</li>
                            <li>√áoklu son se√ßenekleri</li>
                            <li>NPC ili≈üki sistemi</li>
                            <li>Dinamik d√ºnya olaylarƒ±</li>
                            <li>Seviye atlama sistemi</li>
                        </ul>
                    </div>
                `;
            }
            
            function saveScenario() {
                alert('‚úÖ Senaryo ba≈üarƒ±yla kaydedildi!');
            }
            
            function playScenario() {
                window.location.href = '/game';
            }
        </script>
    </body>
    </html>
    '''

@app.route('/api/health')
def health_check():
    try:
        return jsonify({
            'status': 'healthy',
            'message': 'AI Dungeon Master is running',
            'timestamp': datetime.now().isoformat()
        })
    except Exception as e:
        app.logger.error(f'Health check error: {e}')
        return jsonify({'status': 'error', 'message': str(e)}), 500

@app.route('/api/scenarios/enhanced/<scenario_id>')
def get_enhanced_scenario(scenario_id):
    if scenario_id in ENHANCED_SCENARIOS:
        return jsonify({
            "success": True,
            "scenario": ENHANCED_SCENARIOS[scenario_id]
        })
    else:
        return jsonify({
            "success": False,
            "error": "Scenario not found"
        }), 404

@app.route('/api/scenarios', methods=['GET'])
def get_scenarios():
    """T√ºm senaryolarƒ± listele (hem varsayƒ±lan hem AI √ºretilen)"""
    try:
        scenarios = []
        
        # Varsayƒ±lan senaryolarƒ± ekle
        for scenario_id, scenario_data in ENHANCED_SCENARIOS.items():
            scenarios.append({
                "id": scenario_id,
                "title": scenario_data.get("title", "Unknown"),
                "theme": scenario_data.get("theme", "fantasy"),
                "difficulty": scenario_data.get("difficulty", "medium"),
                "description": scenario_data.get("description", "No description"),
                "min_level": scenario_data.get("levels", {}).get("level_1", {}).get("min_level", 1),
                "max_level": scenario_data.get("levels", {}).get("level_1", {}).get("max_level", 10),
                "duration": scenario_data.get("estimatedPlayTime", 120),
                "source": "default"
            })
        
        # AI √ºretilen senaryolarƒ± ekle
        ai_scenarios_file = 'data/ai_scenarios.json'
        try:
            with open(ai_scenarios_file, 'r', encoding='utf-8') as f:
                ai_scenarios = json.load(f)
                
            for scenario in ai_scenarios.get("scenarios", []):
                scenarios.append({
                    "id": scenario.get("id", "unknown"),
                    "title": scenario.get("title", "Unknown"),
                    "theme": scenario.get("theme", "fantasy"),
                    "difficulty": scenario.get("difficulty", "medium"),
                    "description": scenario.get("description", "No description"),
                    "min_level": scenario.get("min_level", 1),
                    "max_level": scenario.get("max_level", 10),
                    "duration": scenario.get("duration", 120),
                    "source": "ai_generated",
                    "file_source": scenario.get("file_source", ""),
                    "word_count": scenario.get("word_count", 0)
                })
        except FileNotFoundError:
            pass  # AI senaryolarƒ± yoksa sadece varsayƒ±lanlarƒ± d√∂nd√ºr
        
        return jsonify({
            "success": True,
            "scenarios": scenarios
        })
        
    except Exception as e:
        print(f"Senaryolar listesi hatasƒ±: {e}")
        return jsonify({
            "success": False,
            "error": str(e)
        }), 500

@app.route('/api/scenarios/<scenario_id>', methods=['GET'])
def get_scenario(scenario_id):
    """Belirli bir senaryoyu getir"""
    try:
        # √ñnce varsayƒ±lan senaryolarda ara
        if scenario_id in ENHANCED_SCENARIOS:
            return jsonify({
                "success": True,
                "scenario": ENHANCED_SCENARIOS[scenario_id]
            })
        
        # AI √ºretilen senaryolarda ara
        ai_scenarios_file = 'data/ai_scenarios.json'
        try:
            with open(ai_scenarios_file, 'r', encoding='utf-8') as f:
                ai_scenarios = json.load(f)
                
            for scenario in ai_scenarios.get("scenarios", []):
                if scenario.get("id") == scenario_id:
                    return jsonify({
                        "success": True,
                        "scenario": scenario
                    })
                    
        except FileNotFoundError:
            pass
        
        return jsonify({
            "success": False,
            "error": "Senaryo bulunamadƒ±"
        }), 404
        
    except Exception as e:
        print(f"Senaryo getirme hatasƒ±: {e}")
        return jsonify({
            "success": False,
            "error": str(e)
        }), 500

@app.route('/api/stories/<scenario_id>')
def get_story(scenario_id):
    try:
        # Varsayƒ±lan senaryolarda ara
        if scenario_id in ENHANCED_SCENARIOS:
            story_data = ENHANCED_SCENARIOS[scenario_id]
            story_nodes = story_data.get("story_nodes", {})
            
            # Start node'u bul
            start_node = story_nodes.get("start", {
                "title": "Ba≈ülangƒ±√ß",
                "description": "Macera ba≈ülƒ±yor...",
                "choices": []
            })
            
            return jsonify({
                "success": True,
                "story": {
                    "id": "start",
                    "title": start_node.get('title', 'Ba≈ülangƒ±√ß'),
                    "description": start_node.get('description', 'Macera ba≈ülƒ±yor...'),
                    "choices": start_node.get("choices", [])
                }
            })
        
        # AI √ºretilen senaryolarda ara
        ai_scenarios_file = 'data/ai_scenarios.json'
        try:
            with open(ai_scenarios_file, 'r', encoding='utf-8') as f:
                ai_scenarios = json.load(f)
                
            for scenario in ai_scenarios.get("scenarios", []):
                if scenario.get("id") == scenario_id:
                    story_nodes = scenario.get("story_nodes", {})
                    
                    # Start node'u bul
                    start_node = story_nodes.get("start", {
                        "title": "Ba≈ülangƒ±√ß",
                        "description": "Macera ba≈ülƒ±yor...",
                        "choices": []
                    })
                    
                    return jsonify({
                        "success": True,
                        "story": {
                            "id": "start",
                            "title": start_node.get('title', 'Ba≈ülangƒ±√ß'),
                            "description": start_node.get('description', 'Macera ba≈ülƒ±yor...'),
                            "choices": start_node.get("choices", [])
                        }
                    })
                    
        except FileNotFoundError:
            pass
        
        return jsonify({
            "success": False,
            "error": "Story not found"
        }), 404
        
    except Exception as e:
        return jsonify({
            "success": False,
            "error": str(e)
        }), 500

@app.route('/api/stories/<scenario_id>/choice', methods=['POST'])
def make_story_choice(scenario_id):
    """Hikaye se√ßimi yap ve oyuncu aksiyonunu kaydet"""
    try:
        data = request.get_json()
        choice_id = data.get('choice_id')
        user_id = data.get('user_id', 'guest_user')
        
        # Se√ßim t√ºr√ºne g√∂re aksiyon belirle ve kaydet
        action_type = "exploration"  # varsayƒ±lan
        action_value = 1
        
        # ƒ∞lk olarak genel action tracking
        update_player_stats(user_id, "total_actions", 1)
        update_player_stats(user_id, "time_spent", 5)  # Her action 5 dakika
        
        # Se√ßime g√∂re spesifik action'lar
        if any(word in choice_id.lower() for word in ["combat", "sava≈ü", "fight", "attack", "battle"]):
            action_type = "combat"
            action_value = 3
            update_player_stats(user_id, "combat_skill", action_value)
            update_player_stats(user_id, "damage_dealt", action_value * 15)
            update_player_stats(user_id, "combat_won", 1)
            
        elif any(word in choice_id.lower() for word in ["talk", "konu≈ü", "negotiate", "speak", "conversation"]):
            action_type = "talk"
            action_value = 2
            update_player_stats(user_id, "charisma_skill", action_value)
                update_player_stats(user_id, "conversations", 1)
            update_player_stats(user_id, "npc_interactions", 1)
            
        elif any(word in choice_id.lower() for word in ["investigate", "ara≈ütƒ±r", "search", "explore", "look"]):
            action_type = "exploration"
            action_value = 2
            update_player_stats(user_id, "exploration_skill", action_value)
                update_player_stats(user_id, "search_actions", 1)
            update_player_stats(user_id, "locations_visited", 1)
            
        elif any(word in choice_id.lower() for word in ["magic", "b√ºy√º", "spell", "cast"]):
            action_type = "magic"
            action_value = 3
            update_player_stats(user_id, "intelligence_skill", action_value)
                update_player_stats(user_id, "puzzle_attempts", 1)
            
        elif any(word in choice_id.lower() for word in ["collect", "topla", "gather", "take", "grab"]):
            action_type = "collect"
            action_value = 1
            update_player_stats(user_id, "exploration_skill", 1)
                update_player_stats(user_id, "items_collected", 1)
            
        elif any(word in choice_id.lower() for word in ["help", "yardƒ±m", "assist", "aid"]):
            action_type = "help"
            action_value = 2
            update_player_stats(user_id, "charisma_skill", action_value)
            update_player_stats(user_id, "npc_interactions", 1)
            
        else:
            # Varsayƒ±lan exploration action
            action_type = "exploration"
            action_value = 1
            update_player_stats(user_id, "exploration_skill", action_value)
        
            action_recorded = True
        
        # Quest progress kontrol et - action'lar otomatik quest completion yapar
        quest_notifications = []
        completed_quests = check_and_complete_quests(user_id, scenario_id)
        if completed_quests:
            for quest in completed_quests:
                quest_notifications.append(f"üéâ G√∂rev Tamamlandƒ±: {quest['title']}")
                update_player_stats(user_id, "xp", quest.get('xp_reward', 100))
        
        # Sonraki hikaye noktasƒ±nƒ± bul
        next_story = get_next_story_node(scenario_id, choice_id)
        
        # Action message ve quest notifications birle≈ütir
        messages = [f"{action_type} aksiyonu kaydedildi!"]
        messages.extend(quest_notifications)
        
        return jsonify({
            "success": True,
            "story": next_story,
            "action_recorded": action_recorded,
            "message": " | ".join(messages),
            "quests_completed": len(completed_quests) if completed_quests else 0
        })
        
    except Exception as e:
        print(f"Story choice error: {e}")
        return jsonify({
            "success": False,
            "error": str(e)
        }), 500

def get_next_story_node(scenario_id, choice_id):
    """Se√ßime g√∂re sonraki hikaye noktasƒ±nƒ± bul"""
    try:
        # Varsayƒ±lan senaryolarda ara
        if scenario_id in ENHANCED_SCENARIOS:
            story_nodes = ENHANCED_SCENARIOS[scenario_id].get("story_nodes", {})
            
            # Se√ßime g√∂re sonraki node'u bul
            for node_id, node in story_nodes.items():
                choices = node.get("choices", [])
                for choice in choices:
                    if choice.get("id") == choice_id:
                        next_node_id = choice.get("next_node")
                        if next_node_id in story_nodes:
                            next_node = story_nodes[next_node_id]
                            return {
                                "id": next_node_id,
                                "title": next_node.get('title', 'Devam'),
                                "description": next_node.get('description', 'Hikaye devam ediyor...'),
                                "choices": next_node.get("choices", [])
                            }
        
        # AI √ºretilen senaryolarda ara
        ai_scenarios_file = 'data/ai_scenarios.json'
        try:
            with open(ai_scenarios_file, 'r', encoding='utf-8') as f:
                ai_scenarios = json.load(f)
                
            for scenario in ai_scenarios.get("scenarios", []):
                if scenario.get("id") == scenario_id:
                    story_nodes = scenario.get("story_nodes", {})
                    
                    # Se√ßime g√∂re sonraki node'u bul
                    for node_id, node in story_nodes.items():
                        choices = node.get("choices", [])
                        for choice in choices:
                            if choice.get("id") == choice_id:
                                next_node_id = choice.get("next_node")
                                if next_node_id in story_nodes:
                                    next_node = story_nodes[next_node_id]
                                    return {
                                        "id": next_node_id,
                                        "title": next_node.get('title', 'Devam'),
                                        "description": next_node.get('description', 'Hikaye devam ediyor...'),
                                        "choices": next_node.get("choices", [])
                                    }
                                    
        except FileNotFoundError:
            pass
        
        # Eksik node i√ßin fallback
        fallback_nodes = {
            "healer_search": {
                "title": "≈ûifacƒ± Arama",
                "description": "K√∂yde ≈üifacƒ±yƒ± arƒ±yorsunuz. Lydia adƒ±nda gen√ß bir ≈üifacƒ± buluyorsunuz. Yaralƒ±lara yardƒ±m ediyor.",
                "choices": [
                    {"id": "help_healer", "text": "≈ûifacƒ±ya yardƒ±m et", "next_node": "healer_help", "effect": {"charisma": 15, "xp": 25}},
                    {"id": "learn_healing", "text": "≈ûifa sanatƒ±nƒ± √∂ƒüren", "next_node": "healing_lesson", "effect": {"intelligence": 20, "xp": 30}},
                    {"id": "return_village", "text": "K√∂ye geri d√∂n", "next_node": "start", "effect": {"exploration": 10, "xp": 15}}
                ]
            },
            "defense_organization": {
                "title": "Savunma Organizasyonu",
                "description": "K√∂yl√ºleri organize ediyorsunuz. Savunma planƒ± hazƒ±rlƒ±yorsunuz. Herkes g√∂rev alƒ±yor.",
                "choices": [
                    {"id": "build_barricades", "text": "Barikatlar in≈üa et", "next_node": "barricade_building", "effect": {"exploration": 25, "xp": 35}},
                    {"id": "train_villagers", "text": "K√∂yl√ºleri eƒüit", "next_node": "villager_training", "effect": {"charisma": 30, "xp": 40}},
                    {"id": "prepare_weapons", "text": "Silahlarƒ± hazƒ±rla", "next_node": "weapon_preparation", "effect": {"combat": 25, "xp": 35}}
                ]
            },
            "cave_discovery": {
                "title": "Maƒüara Ke≈üfi",
                "description": "Daƒülarda ejderhanƒ±n maƒüarasƒ±nƒ± buldunuz. B√ºy√ºk ve korkun√ß bir yer. ƒ∞√ßeriden sƒ±cak hava geliyor.",
                "choices": [
                    {"id": "enter_cave", "text": "Maƒüaraya gir", "next_node": "cave_exploration", "effect": {"exploration": 35, "xp": 50}},
                    {"id": "observe_cave", "text": "Maƒüarayƒ± g√∂zlemle", "next_node": "cave_observation", "effect": {"investigation": 30, "xp": 40}},
                    {"id": "set_trap", "text": "Tuzak kur", "next_node": "trap_setting", "effect": {"intelligence": 25, "xp": 35}}
                ]
            },
            "cave_exploration": {
                "title": "Maƒüara ƒ∞√ßinde Ke≈üif",
                "description": "Maƒüaranƒ±n i√ßinde ilerliyorsunuz. Sƒ±cak hava ve k√ºk√ºrt kokusu var. Ejderha yakƒ±nda olabilir.",
                "choices": [
                    {"id": "find_dragon", "text": "Ejderhayƒ± ara", "next_node": "dragon_confrontation", "effect": {"exploration": 40, "xp": 60}},
                    {"id": "search_treasure", "text": "Hazine ara", "next_node": "treasure_search", "effect": {"exploration": 35, "xp": 50}},
                    {"id": "escape_cave", "text": "Maƒüaradan √ßƒ±k", "next_node": "cave_escape", "effect": {"exploration": 25, "xp": 30}}
                ]
            },
            "dragon_confrontation": {
                "title": "Ejderha ile Kar≈üƒ±la≈üma",
                "description": "Ejderhayƒ± buldunuz! Kƒ±zƒ±l ejderha b√ºy√ºk ve korkun√ß. Alevler sa√ßƒ±yor ve size bakƒ±yor.",
                "choices": [
                    {"id": "fight_dragon", "text": "Ejderha ile sava≈ü", "next_node": "epic_battle", "effect": {"combat": 50, "xp": 100}},
                    {"id": "use_magic", "text": "B√ºy√º kullan", "next_node": "magic_battle", "effect": {"intelligence": 45, "xp": 90}},
                    {"id": "negotiate", "text": "Konu≈ümaya √ßalƒ±≈ü", "next_node": "dragon_negotiation", "effect": {"charisma": 40, "xp": 80}}
                ]
            },
            "epic_battle": {
                "title": "Epik Sava≈ü",
                "description": "Ejderha ile epik sava≈ü ba≈ülƒ±yor! Alevler her yerde, maƒüara sallanƒ±yor. Bu sizin hayatƒ±nƒ±zƒ±n sava≈üƒ±!",
                "choices": [
                    {"id": "final_strike", "text": "Son vuru≈üu yap", "next_node": "dragon_defeat", "effect": {"combat": 60, "xp": 150}},
                    {"id": "magic_final", "text": "Son b√ºy√ºy√º kullan", "next_node": "magic_victory", "effect": {"intelligence": 55, "xp": 140}},
                    {"id": "team_attack", "text": "Takƒ±m saldƒ±rƒ±sƒ±", "next_node": "team_victory", "effect": {"charisma": 50, "xp": 130}}
                ]
            },
            "dragon_defeat": {
                "title": "Ejderha Yenildi!",
                "description": "Ejderhayƒ± yendiniz! B√ºy√ºk zafer! K√∂y artƒ±k g√ºvende. Kahraman oldunuz!",
                "choices": [
                    {"id": "return_victory", "text": "Zaferle d√∂n", "next_node": "victory_return", "effect": {"charisma": 60, "xp": 200}},
                    {"id": "claim_treasure", "text": "Hazineyi topla", "next_node": "treasure_claim", "effect": {"exploration": 50, "xp": 180}},
                    {"id": "celebrate", "text": "Zaferi kutla", "next_node": "victory_celebration", "effect": {"charisma": 40, "xp": 120}}
                ]
            },
                         "victory_return": {
                 "title": "Zaferle D√∂n√º≈ü",
                 "description": "K√∂ye zaferle d√∂nd√ºn√ºz! Herkes sizi kar≈üƒ±lƒ±yor. Kahraman ilan edildiniz!",
                 "choices": [
                     {"id": "accept_honor", "text": "Onuru kabul et", "next_node": "hero_honor", "effect": {"charisma": 70, "xp": 250}},
                     {"id": "rebuild_village", "text": "K√∂y√º yeniden in≈üa et", "next_node": "village_rebuilding", "effect": {"charisma": 60, "xp": 200}},
                     {"id": "end_adventure", "text": "Macerayƒ± sonlandƒ±r", "next_node": "end", "effect": {"xp": 300}}
                 ]
             },
             # PLOT TWIST'LER VE NPC ETKƒ∞LE≈ûƒ∞MLERƒ∞
             "betrayal_twist": {
                 "title": "üî• PLOT TWIST: Aldric'in ƒ∞haneti!",
                 "description": "≈ûOK EDƒ∞Cƒ∞ GER√áEK! Aldric aslƒ±nda ejderhanƒ±n m√ºttefiki √ßƒ±kƒ±yor! Size yalan s√∂ylemi≈ü. 'Sen √ßok g√º√ßl√º oldun, ejderhayƒ± kontrol etmek i√ßin seni kullanacaƒüƒ±m!' diyor. Bu b√ºy√ºk bir ihanet!",
                 "choices": [
                     {"id": "confront_aldric", "text": "Aldric ile y√ºzle≈ü ve sava≈ü", "next_node": "aldric_battle", "effect": {"combat": 40, "xp": 80}},
                     {"id": "play_along", "text": "Oyuna gel ve planƒ±nƒ± √∂ƒüren", "next_node": "double_agent", "effect": {"charisma": 35, "xp": 70}},
                     {"id": "escape_betrayal", "text": "Ka√ß ve yardƒ±m ara", "next_node": "escape_plan", "effect": {"exploration": 30, "xp": 60}},
                     {"id": "convince_aldric", "text": "Aldric'i ikna etmeye √ßalƒ±≈ü", "next_node": "aldric_persuasion", "effect": {"charisma": 45, "xp": 90}}
                 ]
             },
             "mysterious_stranger": {
                 "title": "üë§ Gizemli Yabancƒ± ile Kar≈üƒ±la≈üma",
                 "description": "Maƒüaraya giderken kap√º≈üonlu bir yabancƒ± kar≈üƒ±nƒ±za √ßƒ±kƒ±yor. 'Aldric'e g√ºvenme!' diyor. 'O seni aldatƒ±yor. Ger√ßek ejderha avcƒ±sƒ± benim. Ejderha aslƒ±nda k√∂y√º koruyor, onu √∂ld√ºr√ºrsen b√ºy√ºk felaket olacak!'",
                 "choices": [
                     {"id": "trust_stranger", "text": "Yabancƒ±ya g√ºven ve dinle", "next_node": "stranger_revelation", "effect": {"intelligence": 25, "xp": 50}},
                     {"id": "ignore_stranger", "text": "Yabancƒ±yƒ± yoksay ve devam et", "next_node": "cave_discovery", "effect": {"exploration": 20, "xp": 30}},
                     {"id": "interrogate_stranger", "text": "Yabancƒ±yƒ± sorguya √ßek", "next_node": "stranger_interrogation", "effect": {"investigation": 30, "xp": 60}},
                     {"id": "attack_stranger", "text": "Yabancƒ±ya saldƒ±r (≈ü√ºpheli)", "next_node": "stranger_combat", "effect": {"combat": 25, "xp": 40}}
                 ]
             },
             "lydia_secret": {
                 "title": "üíä Lydia'nƒ±n Gizli Kimliƒüi",
                 "description": "≈ûA≈ûIRTICI GER√áEK! ≈ûifacƒ± Lydia aslƒ±nda eski bir ejderha! ƒ∞nsan formuna girmi≈ü. 'Ejderhalar k√∂t√º deƒüil' diyor, 'Biz bu topraklarƒ± koruyoruz. Kƒ±zƒ±l ejderha benim karde≈üim, onu kurtarmalƒ±yƒ±z!'",
                 "choices": [
                     {"id": "accept_lydia_help", "text": "Lydia'nƒ±n yardƒ±mƒ±nƒ± kabul et", "next_node": "dragon_alliance", "effect": {"charisma": 40, "xp": 100}},
                     {"id": "reject_lydia", "text": "Lydia'yƒ± reddet ve uzakla≈ü", "next_node": "solo_mission", "effect": {"exploration": 35, "xp": 70}},
                     {"id": "question_lydia", "text": "Lydia'yƒ± detaylƒ± sorguya √ßek", "next_node": "lydia_truth", "effect": {"investigation": 40, "xp": 80}},
                     {"id": "report_lydia", "text": "Lydia'yƒ± k√∂ye ihbar et", "next_node": "village_conflict", "effect": {"charisma": 30, "xp": 60}}
                 ]
             },
             "dragon_family_twist": {
                 "title": "üêâ Ejderha Ailesi Sƒ±rrƒ±",
                 "description": "ULTIMATE PLOT TWIST! Kƒ±zƒ±l ejderha aslƒ±nda anne ejderha! Yavrularƒ± √ßalƒ±nmƒ±≈ü ve onlarƒ± arƒ±yor. K√∂ye saldƒ±rmasƒ±nƒ±n nedeni bu! Ger√ßek k√∂t√ºler yavrularƒ±nƒ± √ßalan ejderha avcƒ±larƒ±!",
                 "choices": [
                     {"id": "help_dragon_mother", "text": "Anne ejderhaya yardƒ±m et", "next_node": "rescue_babies", "effect": {"charisma": 50, "xp": 120}},
                     {"id": "find_real_villains", "text": "Ger√ßek k√∂t√ºleri bul", "next_node": "villain_hunt", "effect": {"investigation": 45, "xp": 100}},
                     {"id": "unite_village_dragons", "text": "K√∂y ve ejderhalarƒ± birle≈ütir", "next_node": "peace_treaty", "effect": {"charisma": 60, "xp": 150}},
                     {"id": "stay_neutral", "text": "Tarafsƒ±z kal ve g√∂zlemle", "next_node": "neutral_observer", "effect": {"intelligence": 35, "xp": 80}}
                 ]
             },
             # NPC ETKƒ∞LE≈ûƒ∞MLERƒ∞
             "aldric_deep_talk": {
                 "title": "üßô‚Äç‚ôÇÔ∏è Aldric ile Derin Sohbet",
                 "description": "Aldric ile uzun sohbet ediyorsunuz. Size ejderhalarƒ±n tarihini anlatƒ±yor. G√ºven puanƒ±nƒ±z artƒ±yor. 'Sen √∂zelsin' diyor, 'Ejderhalarla konu≈üabilirsin.' Size √∂zel bir kolye veriyor.",
                 "choices": [
                     {"id": "accept_necklace", "text": "Kolyeyi kabul et", "next_node": "magic_necklace", "effect": {"intelligence": 30, "aldric_trust": 20, "xp": 60}},
                     {"id": "ask_about_past", "text": "Aldric'in ge√ßmi≈üini sor", "next_node": "aldric_history", "effect": {"investigation": 25, "aldric_trust": 15, "xp": 50}},
                     {"id": "share_concerns", "text": "Endi≈üelerini payla≈ü", "next_node": "trust_building", "effect": {"charisma": 35, "aldric_trust": 25, "xp": 70}},
                     {"id": "request_training", "text": "√ñzel eƒüitim iste", "next_node": "advanced_training", "effect": {"intelligence": 40, "aldric_trust": 10, "xp": 80}}
                 ]
             },
             "lydia_romance": {
                 "title": "üíï Lydia ile Romantik Anlar",
                 "description": "Lydia ile yakƒ±nla≈üƒ±yorsunuz. Birlikte yƒ±ldƒ±zlarƒ± izliyorsunuz. 'Sen farklƒ±sƒ±n' diyor, 'Diƒüer sava≈ü√ßƒ±lar gibi deƒüil.' Size ≈üifa b√ºy√ºs√º √∂ƒüretiyor. Kalp kalbe sohbet ediyorsunuz.",
                 "choices": [
                     {"id": "confess_feelings", "text": "Duygularƒ±nƒ± itiraf et", "next_node": "love_confession", "effect": {"charisma": 40, "lydia_trust": 30, "xp": 90}},
                     {"id": "learn_healing", "text": "≈ûifa b√ºy√ºlerini √∂ƒüren", "next_node": "healing_mastery", "effect": {"intelligence": 35, "lydia_trust": 20, "xp": 70}},
                     {"id": "share_stories", "text": "Ge√ßmi≈ü hikayelerini payla≈ü", "next_node": "story_sharing", "effect": {"charisma": 30, "lydia_trust": 25, "xp": 60}},
                     {"id": "ask_about_dragons", "text": "Ejderhalar hakkƒ±nda bilgi al", "next_node": "dragon_knowledge", "effect": {"investigation": 30, "lydia_trust": 15, "xp": 50}}
                 ]
             },
             "village_elder_wisdom": {
                 "title": "üë¥ K√∂y Ya≈ülƒ±sƒ± ile Bilgelik Sohbeti",
                 "description": "K√∂y√ºn en ya≈ülƒ± sakini Marcus ile konu≈üuyorsunuz. Size eski efsaneleri anlatƒ±yor. 'Ejderhalar eskiden dosttu' diyor, 'B√ºy√ºk sava≈ü her ≈üeyi deƒüi≈ütirdi.' Size gizli bir harita veriyor.",
                 "choices": [
                     {"id": "study_map", "text": "Haritayƒ± incele", "next_node": "ancient_map", "effect": {"investigation": 35, "marcus_trust": 20, "xp": 80}},
                     {"id": "learn_history", "text": "Eski tarihi √∂ƒüren", "next_node": "ancient_history", "effect": {"intelligence": 40, "marcus_trust": 25, "xp": 90}},
                     {"id": "ask_about_peace", "text": "Barƒ±≈ü hakkƒ±nda sor", "next_node": "peace_wisdom", "effect": {"charisma": 35, "marcus_trust": 30, "xp": 85}},
                     {"id": "request_blessing", "text": "Ya≈ülƒ±nƒ±n kutsamasƒ±nƒ± iste", "next_node": "elder_blessing", "effect": {"charisma": 30, "marcus_trust": 15, "xp": 60}}
                 ]
             },
             # G√ñREV Sƒ∞STEMƒ∞
             "side_quest_herb_gathering": {
                 "title": "üåø Yan G√∂rev: ≈ûifalƒ± Ot Toplama",
                 "description": "Lydia size √∂zel bir g√∂rev veriyor: 'Ejderha √ßi√ßeƒüi bul, sadece ejderha maƒüarasƒ± yakƒ±nƒ±nda yeti≈üir. Bu √ßi√ßek ejderha ile barƒ±≈ü yapmanƒ±n anahtarƒ± olabilir.' Bu tehlikeli ama √∂nemli bir g√∂rev.",
                 "choices": [
                     {"id": "accept_herb_quest", "text": "G√∂revi kabul et", "next_node": "herb_hunting", "effect": {"exploration": 30, "quest_points": 50, "xp": 70}},
                     {"id": "negotiate_reward", "text": "√ñd√ºl pazarlƒ±ƒüƒ± yap", "next_node": "quest_negotiation", "effect": {"charisma": 25, "xp": 40}},
                     {"id": "ask_for_help", "text": "Yardƒ±m iste", "next_node": "quest_help", "effect": {"charisma": 20, "xp": 30}},
                     {"id": "decline_quest", "text": "G√∂revi reddet", "next_node": "quest_declined", "effect": {"lydia_trust": -10, "xp": 10}}
                 ]
             },
             "chain_quest_dragon_eggs": {
                 "title": "ü•ö Zincir G√∂rev: Kayƒ±p Ejderha Yumurtalarƒ±",
                 "description": "B√úY√úK G√ñREV Zƒ∞NCƒ∞Rƒ∞ BA≈ûLIYOR! K√∂yde gizli bir oda buldunuz. ƒ∞√ßinde ejderha yumurtalarƒ± var! Bu yumurtalar √ßalƒ±nmƒ±≈ü. Bu, ejderha saldƒ±rƒ±larƒ±nƒ±n ger√ßek nedeni olabilir. 3 a≈üamalƒ± g√∂rev ba≈ülƒ±yor!",
                 "choices": [
                     {"id": "investigate_theft", "text": "Hƒ±rsƒ±zlƒ±ƒüƒ± ara≈ütƒ±r (1/3)", "next_node": "theft_investigation", "effect": {"investigation": 40, "quest_chain": 1, "xp": 100}},
                     {"id": "protect_eggs", "text": "Yumurtalarƒ± koru (Risk)", "next_node": "egg_protection", "effect": {"combat": 35, "xp": 80}},
                     {"id": "return_eggs", "text": "Yumurtalarƒ± ejderhaya g√∂t√ºr", "next_node": "egg_return", "effect": {"charisma": 45, "xp": 120}},
                     {"id": "study_eggs", "text": "Yumurtalarƒ± incele", "next_node": "egg_study", "effect": {"intelligence": 35, "xp": 70}}
                 ]
             },
             "epic_quest_dragon_alliance": {
                 "title": "üëë Epik G√∂rev: Ejderha ƒ∞ttifakƒ±",
                 "description": "ULTIMATE QUEST! T√ºm ejderhalar ve insanlar arasƒ±nda barƒ±≈ü saƒülamak! Bu efsanevi g√∂rev sadece en b√ºy√ºk kahramanlarƒ±n ba≈üarabileceƒüi bir ≈üey. Ejderha Krali√ßesi ile g√∂r√º≈ümelisiniz!",
                 "choices": [
                     {"id": "meet_dragon_queen", "text": "Ejderha Krali√ßesi ile g√∂r√º≈ü", "next_node": "dragon_queen_meeting", "effect": {"charisma": 60, "epic_quest": 1, "xp": 200}},
                     {"id": "gather_allies", "text": "M√ºttefikler topla", "next_node": "alliance_building", "effect": {"charisma": 50, "xp": 150}},
                     {"id": "prepare_treaty", "text": "Barƒ±≈ü antla≈ümasƒ± hazƒ±rla", "next_node": "treaty_preparation", "effect": {"intelligence": 45, "xp": 120}},
                     {"id": "prove_worthiness", "text": "Deƒüerini kanƒ±tla", "next_node": "worthiness_trial", "effect": {"combat": 55, "xp": 180}}
                 ]
             },
             # ============== CYBERPUNK FALLBACK NODES ==============
             "megacorp_briefing": {
                 "title": "üíº MegaCorp Gizli Toplantƒ±",
                 "description": "üè¢ PLOT TWIST! MegaCorp'un CEO'su aslƒ±nda bir AI! 'Biz artƒ±k insan deƒüiliz' diyor. 'Sen bizim en deƒüerli ajanƒ±mƒ±zsƒ±n. Rakip ≈üirketin elindeki veriler aslƒ±nda AI devrimini durduracak kodlar!' Bu g√∂r√º≈üme her ≈üeyi deƒüi≈ütiriyor. Sava≈ü sadece korporasyonlar arasƒ± deƒüil - bu AI'lar vs ƒ∞nsanlar!",
                 "choices": [
                     {"id": "accept_ai_alliance", "text": "AI ile ittifak kur", "next_node": "ai_alliance_path", "effect": {"ai_relationship": 40, "credits": 10000, "xp": 80}},
                     {"id": "reject_and_escape", "text": "Reddet ve ka√ß", "next_node": "corporate_escape", "effect": {"stealth": 30, "revolution_points": 30, "xp": 70}},
                     {"id": "double_agent_play", "text": "√áifte ajan ol", "next_node": "double_agent_cyberpunk", "effect": {"deception": 35, "intel": 25, "xp": 90}},
                     {"id": "hack_ceo_mind", "text": "CEO'nun zihnini hackle", "next_node": "mind_hack_attempt", "effect": {"hacking": 40, "cyber_warfare": 20, "xp": 100}}
                 ]
             },
             "underground_meeting": {
                 "title": "üî• Underground Devrimci Toplantƒ±",
                 "description": "Yeraltƒ± devrimcilerinin gizli √ºss√ºndesiniz. Lider Zara size ≈üok edici ger√ßeƒüi s√∂yl√ºyor: 'MegaCorp'lar insanlarƒ± cyber-k√∂le yapƒ±yor! Neural implantlarla beyin kontrol√º yapƒ±yorlar. Sen de bunlardan birini ta≈üƒ±yorsun!' Kafanƒ±zdaki implant aniden sƒ±zlamaya ba≈ülƒ±yor...",
                 "choices": [
                     {"id": "remove_implant", "text": "ƒ∞mplantƒ± √ßƒ±karmaya √ßalƒ±≈ü", "next_node": "implant_removal", "effect": {"freedom": 50, "pain": 30, "xp": 120}},
                     {"id": "hack_implant", "text": "ƒ∞mplantƒ± hackleyip kontrol et", "next_node": "implant_hacking", "effect": {"hacking": 45, "cyber_control": 35, "xp": 100}},
                     {"id": "join_revolution", "text": "Devrime tam katƒ±l", "next_node": "revolution_member", "effect": {"revolution_points": 60, "zara_trust": 40, "xp": 90}},
                     {"id": "infiltrate_for_corps", "text": "Korporasyonlar i√ßin casuslu yap", "next_node": "corporate_spy", "effect": {"deception": 40, "corporate_rep": 30, "xp": 80}}
                 ]
             },
             "ai_investigation": {
                 "title": "ü§ñ AI Gizemi - ≈ûok Edici Ke≈üif",
                 "description": "ULTIMATE PLOT TWIST! Ara≈ütƒ±rmalarƒ±nƒ±z ≈üok edici ger√ßeƒüi ortaya √ßƒ±karƒ±yor: ≈ûehirdeki t√ºm AI'lar aslƒ±nda √∂lm√º≈ü insanlarƒ±n bilin√ßleri! ƒ∞nsanlar √∂l√ºnce beyinleri dijitalle≈ütiriliyor. Sen de eskiden √∂lm√º≈ü birinin bilincini ta≈üƒ±yor olabilirsin! Hafƒ±zanda bo≈üluklar var...",
                 "choices": [
                     {"id": "discover_true_identity", "text": "Ger√ßek kimliƒüini ke≈üfet", "next_node": "identity_revelation", "effect": {"self_knowledge": 60, "existential_crisis": 40, "xp": 150}},
                     {"id": "contact_other_ais", "text": "Diƒüer AI'larla ileti≈üim kur", "next_node": "ai_network", "effect": {"ai_relationship": 50, "network_access": 40, "xp": 120}},
                     {"id": "fight_digital_existence", "text": "Dijital varlƒ±ƒüa kar≈üƒ± sava≈ü", "next_node": "digital_rebellion", "effect": {"rebellion": 45, "tech_warfare": 35, "xp": 100}},
                     {"id": "embrace_ai_nature", "text": "AI doƒüanƒ± kabul et", "next_node": "ai_acceptance", "effect": {"ai_powers": 50, "humanity_loss": 30, "xp": 110}}
                 ]
             },
             "network_infiltration": {
                 "title": "üíª ≈ûehir Aƒüƒ±na Giri≈ü - Siber Sava≈ü",
                 "description": "Neo-Tokyo'nun ana aƒüƒ±na giriyorsunuz. Burasƒ± dijital bir sava≈ü alanƒ±! ƒ∞mparatorluk'un AI g√ºvenlik sistemleri sizi fark ediyor. Dev siber sava≈ü ba≈ülƒ±yor! Etrafƒ±nƒ±zda firewall'lar, vir√ºsler ve dijital silahlar u√ßu≈üuyor. Bu sadece kod sava≈üƒ± deƒüil - ger√ßek sava≈ü!",
                 "choices": [
                     {"id": "virus_warfare", "text": "Vir√ºs sava≈üƒ± ba≈ülat", "next_node": "cyber_virus_battle", "effect": {"cyber_warfare": 50, "system_damage": 40, "xp": 130}},
                     {"id": "stealth_infiltration", "text": "Gizli sƒ±zma", "next_node": "stealth_hack", "effect": {"stealth": 40, "data_theft": 35, "xp": 100}},
                     {"id": "direct_assault", "text": "Doƒürudan saldƒ±rƒ±", "next_node": "digital_assault", "effect": {"hacking": 45, "combat": 30, "xp": 120}},
                     {"id": "negotiate_with_ai", "text": "Sistem AI'sƒ± ile m√ºzakere et", "next_node": "ai_negotiation", "effect": {"diplomacy": 35, "ai_relationship": 25, "xp": 90}}
                 ]
             }
        }
        
        # Fallback node varsa onu kullan
        if next_node_id in fallback_nodes:
            fallback_node = fallback_nodes[next_node_id]
            return {
                "id": next_node_id,
                "title": fallback_node["title"],
                "description": fallback_node["description"],
                "choices": fallback_node["choices"]
            }

        # Dynamic fallback for Cyberpunk (Neon City) missing nodes to ensure all choices progress
        neon_missing_nodes = {
            "ai_alliance_formation",
            "ai_control_transfer",
            "ai_data_analysis",
            "ai_human_alliance_formation",
            "ai_liberation_planning",
            "ai_network_communication",
            "ai_prisoner_liberation",
            "ai_representative_meeting",
            "ai_research_theft",
            "ai_resistance_meeting",
            "ai_truth_revealed",
            "ai_whistleblower_contact",
            "city_chaos_management",
            "city_control_hack",
            "city_uprising_preparation",
            "contract_negotiation",
            "cybertech_investigation",
            "data_destruction_mission",
            "double_agent_planning",
            "escape_from_chaos",
            "escape_with_critical_data",
            "final_rex_confrontation",
            "global_ai_awakening",
            "infiltration_preparation",
            "mission_decline",
            "mission_interrogation",
            "network_escape",
            "new_society_planning",
            "rex_steel_confrontation",
            "rex_steel_tracking",
            "underground_defense_mission",
            "underground_training",
            "zara_warning"
        }

        neon_endings = {
            "end_revolution_victory": {
                "title": "Devrim Zaferi - Yeni Ba≈ülangƒ±√ß",
                "description": "AI ve insanlar birlikte yeni bir d√ºzen kurdu. ≈ûehir √∂zg√ºr!",
            },
            "end_corporate_power": {
                "title": "Korporasyon G√ºc√º - Pragmatik Son",
                "description": "Korporasyonlarla anla≈üarak g√ºc√º ele ge√ßirdin. Sokaklar hala tehlikeli ama sen tepedesin.",
            },
            "end_ai_singularity": {
                "title": "Tekillik - ƒ∞nsan Sonrasƒ± √áaƒü",
                "description": "AI ile birle≈üerek yeni bir varlƒ±k oldun. ƒ∞nsan sƒ±nƒ±rlarƒ±nƒ± a≈ütƒ±n.",
            }
        }

        # If a specific Neon ending is requested, return it as terminal node with restart option
        if next_node_id in neon_endings:
            end_node = neon_endings[next_node_id]
            return {
                "id": next_node_id,
                "title": end_node["title"],
                "description": end_node["description"],
                "choices": [
                    {"id": "restart_story", "text": "Ba≈üa D√∂n", "next_node": "start", "effect": {"xp": 50}}
                ]
            }

        # If a missing Neon intermediate node is requested, synthesize a meaningful step with branching
        if next_node_id in neon_missing_nodes:
            synthesized_title = next_node_id.replace("_", " ").title()
            return {
                "id": next_node_id,
                "title": synthesized_title,
                "description": "Bu b√∂l√ºm hen√ºz ayrƒ±ntƒ±lƒ± yazƒ±lmadƒ±, ancak ilerleme kesintisiz devam eder. Se√ßiminize g√∂re devrim, korporasyon ya da tekillik sonuna gidebilirsiniz.",
                "choices": [
                    {"id": f"{next_node_id}_to_revolution", "text": "AI Devrimine Destek Ol", "next_node": "ai_revolution_beginning", "effect": {"revolution_points": 20, "xp": 50}},
                    {"id": f"{next_node_id}_to_corporate", "text": "Korporasyonla Anla≈ü", "next_node": "end_corporate_power", "effect": {"credits": 20000, "xp": 70}},
                    {"id": f"{next_node_id}_to_singularity", "text": "AI Tekilliƒüine Y√∂nel", "next_node": "end_ai_singularity", "effect": {"ai_relationship": 30, "xp": 80}}
                ]
            }

        # Generic dynamic fallback for AI-generated content nodes like content_node_*
        try:
            if isinstance(next_node_id, str) and next_node_id.startswith("content_node_"):
                return {
                    "id": next_node_id,
                    "title": "ƒ∞√ßerik B√∂l√ºm√º",
                    "description": "Y√ºklenen dosyadan √ºretilen ek i√ßerik. Hikaye akƒ±≈üƒ± korunarak devam ediyor.",
                    "choices": [
                        {"id": f"{next_node_id}_continue", "text": "Devam Et", "next_node": "end", "effect": {"xp": 40}},
                        {"id": f"{next_node_id}_restart", "text": "Ba≈üa D√∂n", "next_node": "start", "effect": {"xp": 20}}
                    ]
                }
        except Exception:
            pass
        
        # Varsayƒ±lan sonu√ß
        return {
            "id": "end",
            "title": "üéâ Macera Tamamlandƒ±",
            "description": "Hikayenin sonuna ula≈ütƒ±n!",
            "choices": []
        }
        
    except Exception as e:
        print(f"Get next story node error: {e}")
        return {
            "id": "error",
            "text": "<h3>‚ùå Hata</h3><p>Hikaye y√ºklenirken bir hata olu≈ütu.</p>",
            "choices": []
        }

@app.route('/api/auth/login', methods=['POST'])
def login_api():
    return jsonify({
        'success': True,
        'token': 'guest_token_123',
        'user_id': 'guest_user',
        'username': 'Guest',
        'is_guest': True
    })

@app.route('/api/generate-ai-scenario', methods=['POST'])
def generate_ai_scenario():
    """AI ile senaryo √ºretimi"""
    try:
        data = request.get_json()
        theme = data.get('theme', 'fantasy')
        difficulty = data.get('difficulty', 'medium')
        min_level = data.get('min_level', 1)
        max_level = data.get('max_level', 10)
        duration = data.get('duration', 120)
        prompt = data.get('prompt', '')
        
        # Benzersiz ID olu≈ütur
        scenario_id = f"ai_scenario_{int(time.time())}"
        
        # AI senaryo ≈üablonu olu≈ütur
        ai_scenario = {
            "id": scenario_id,
            "title": f"AI {theme.title()} Macerasƒ±",
            "theme": theme,
            "difficulty": difficulty,
            "min_level": min_level,
            "max_level": max_level,
            "duration": duration,
            "description": f"AI tarafƒ±ndan √ºretilen {theme} temalƒ± macera. Seviye {min_level}-{max_level} arasƒ± oyuncular i√ßin tasarlandƒ±. Tahmini s√ºre: {duration} dakika.",
            "story_nodes": {
                "start": {
                    "title": "Ba≈ülangƒ±√ß",
                    "description": f"AI √ºretilen {theme} macerasƒ±na ho≈ü geldin!",
                    "choices": [
                        {
                            "text": "Maceralara ba≈üla",
                            "next_node": "adventure_begin",
                            "effect": {"xp": 10}
                        }
                    ]
                },
                "adventure_begin": {
                    "title": "Macera Ba≈ülƒ±yor",
                    "description": "Senaryo detaylarƒ± burada yer alacak...",
                    "choices": [
                        {
                            "text": "Devam et",
                            "next_node": "end",
                            "effect": {"xp": 20}
                        }
                    ]
                }
            },
            "created_at": datetime.now().isoformat(),
            "ai_generated": True
        }
        
        # √ñzel prompt varsa a√ßƒ±klamaya ekle
        if prompt:
            ai_scenario["description"] += f"\n\n√ñzel ƒ∞stekler: {prompt}"
        
        # AI senaryolarƒ±nƒ± kaydet
        ai_scenarios_file = 'data/ai_scenarios.json'
        try:
            with open(ai_scenarios_file, 'r', encoding='utf-8') as f:
                ai_scenarios = json.load(f)
        except FileNotFoundError:
            ai_scenarios = {"scenarios": []}
        
        ai_scenarios["scenarios"].append(ai_scenario)
        
        with open(ai_scenarios_file, 'w', encoding='utf-8') as f:
            json.dump(ai_scenarios, f, ensure_ascii=False, indent=2)
        
        return jsonify(ai_scenario)
        
    except Exception as e:
        print(f"AI Senaryo √ºretimi hatasƒ±: {e}")
        return jsonify({"error": "Senaryo √ºretimi ba≈üarƒ±sƒ±z"}), 500

@app.route('/api/generate-scenario', methods=['POST'])
def generate_ai_scenario():
    """Form verilerinden AI senaryo √ºret"""
    try:
        data = request.get_json()
        theme = data.get('theme')
        title = data.get('title')
        character = data.get('character')
        description = data.get('description')
        difficulty = data.get('difficulty')
        
        if not all([theme, title, character, description, difficulty]):
            return jsonify({"error": "T√ºm alanlar doldurulmalƒ±dƒ±r"}), 400
        
        # AI senaryo √ºretimi
        scenario = generate_advanced_scenario(theme, title, character, description, difficulty)
        
        # AI senaryolarƒ±na kaydet
        try:
            ai_scenarios_file = 'data/ai_scenarios.json'
            os.makedirs('data', exist_ok=True)
            
            try:
                with open(ai_scenarios_file, 'r', encoding='utf-8') as f:
                    ai_scenarios = json.load(f)
            except FileNotFoundError:
                ai_scenarios = {"scenarios": []}
            
            ai_scenarios["scenarios"].append(scenario)
            
            with open(ai_scenarios_file, 'w', encoding='utf-8') as f:
                json.dump(ai_scenarios, f, ensure_ascii=False, indent=2)
        except Exception as e:
            print(f"Error saving AI scenario: {e}")
        
        return jsonify({
            "success": True,
            "scenario": scenario,
            "message": "AI senaryo ba≈üarƒ±yla √ºretildi!"
        })
        
    except Exception as e:
        print(f"AI scenario generation error: {e}")
        import traceback
        traceback.print_exc()
        return jsonify({
            "success": False,
            "error": f"Senaryo √ºretimi ba≈üarƒ±sƒ±z: {str(e)}"
        }), 500

@app.route('/api/scenarios/save', methods=['POST'])
def save_scenario():
    """√úretilen senaryoyu kullanƒ±cƒ±ya √∂zel kaydet"""
    try:
        data = request.get_json()
        scenario = data.get('scenario')
        user_id = data.get('user_id', 'guest_user')
        
        if not scenario:
            return jsonify({"error": "Senaryo verisi bulunamadƒ±"}), 400
        
        # Kullanƒ±cƒ± senaryolarƒ±nƒ± kaydet
        user_scenarios_file = f'data/user_scenarios_{user_id}.json'
        os.makedirs('data', exist_ok=True)
        
        try:
            with open(user_scenarios_file, 'r', encoding='utf-8') as f:
                user_scenarios = json.load(f)
        except FileNotFoundError:
            user_scenarios = {"scenarios": []}
        
        user_scenarios["scenarios"].append(scenario)
        
        with open(user_scenarios_file, 'w', encoding='utf-8') as f:
            json.dump(user_scenarios, f, ensure_ascii=False, indent=2)
        
        return jsonify({
            "success": True,
            "message": "Senaryo ba≈üarƒ±yla kaydedildi!"
        })
        
    except Exception as e:
        print(f"Save scenario error: {e}")
        return jsonify({
            "success": False,
            "error": f"Kaydetme ba≈üarƒ±sƒ±z: {str(e)}"
        }), 500

@app.route('/api/ai-scenarios', methods=['GET'])
def get_ai_scenarios():
    """AI √ºretilen senaryolarƒ± listele"""
    try:
        ai_scenarios_file = 'data/ai_scenarios.json'
        try:
            with open(ai_scenarios_file, 'r', encoding='utf-8') as f:
                ai_scenarios = json.load(f)
                return jsonify(ai_scenarios.get("scenarios", []))
        except FileNotFoundError:
            return jsonify([])
            
    except Exception as e:
        print(f"AI Senaryolar listesi hatasƒ±: {e}")
        return jsonify([])

@app.route('/api/ai-scenario/<scenario_id>', methods=['GET'])
def get_ai_scenario(scenario_id):
    """Belirli bir AI senaryosunu getir"""
    try:
        ai_scenarios_file = 'data/ai_scenarios.json'
        try:
            with open(ai_scenarios_file, 'r', encoding='utf-8') as f:
                ai_scenarios = json.load(f)
                
            for scenario in ai_scenarios.get("scenarios", []):
                if scenario.get("id") == scenario_id:
                    return jsonify(scenario)
                    
            return jsonify({"error": "Senaryo bulunamadƒ±"}), 404
            
        except FileNotFoundError:
            return jsonify({"error": "Senaryo bulunamadƒ±"}), 404
            
    except Exception as e:
        print(f"AI Senaryo getirme hatasƒ±: {e}")
        return jsonify({"error": "Senaryo getirme hatasƒ±"}), 500

@app.route('/api/ai-scenario/<scenario_id>', methods=['DELETE'])
def delete_ai_scenario(scenario_id):
    """AI senaryosunu sil"""
    try:
        ai_scenarios_file = 'data/ai_scenarios.json'
        try:
            with open(ai_scenarios_file, 'r', encoding='utf-8') as f:
                ai_scenarios = json.load(f)
                
            # Senaryoyu bul ve sil
            scenarios = ai_scenarios.get("scenarios", [])
            for i, scenario in enumerate(scenarios):
                if scenario.get("id") == scenario_id:
                    deleted_scenario = scenarios.pop(i)
                    
                    # Dosyayƒ± g√ºncelle
                    with open(ai_scenarios_file, 'w', encoding='utf-8') as f:
                        json.dump(ai_scenarios, f, ensure_ascii=False, indent=2)
                    
                    return jsonify({"message": "Senaryo silindi", "deleted": deleted_scenario})
                    
            return jsonify({"error": "Senaryo bulunamadƒ±"}), 404
            
        except FileNotFoundError:
            return jsonify({"error": "Senaryo bulunamadƒ±"}), 404
            
    except Exception as e:
        print(f"AI Senaryo silme hatasƒ±: {e}")
        return jsonify({"error": "Senaryo silme hatasƒ±"}), 500

@app.route('/api/upload-file', methods=['POST'])
def upload_file():
    """Dosya y√ºkleme ve AI senaryo √ºretimi"""
    try:
        print("üìÅ File upload request received")
        
        if 'file' not in request.files:
            print("‚ùå No file in request")
            return jsonify({"error": "Dosya bulunamadƒ±"}), 400
        
        file = request.files['file']
        print(f"üìÑ File received: {file.filename}")
        
        if file.filename == '':
            print("‚ùå Empty filename")
            return jsonify({"error": "Dosya se√ßilmedi"}), 400
        
        # Dosya i√ßeriƒüini oku
        try:
            file_content = file.read().decode('utf-8', errors='ignore')
            file_name = file.filename
            print(f"üìñ File content read: {len(file_content)} characters")
        except Exception as e:
            print(f"‚ùå Error reading file content: {e}")
            return jsonify({"error": f"Dosya okuma hatasƒ±: {str(e)}"}), 500
        
        # Dosya i√ßeriƒüinden senaryo olu≈ütur
        try:
            print("üéÆ Creating scenario from file content...")
            scenario = create_scenario_from_file(file_content, file_name)
            print(f"‚úÖ Scenario created: {scenario.get('title', 'Unknown')}")
        except Exception as e:
            print(f"‚ùå Error creating scenario: {e}")
            import traceback
            traceback.print_exc()
            return jsonify({"error": f"Senaryo olu≈üturma hatasƒ±: {str(e)}"}), 500
        
        # AI senaryolarƒ±nƒ± kaydet
        try:
            ai_scenarios_file = 'data/ai_scenarios.json'
            print(f"üíæ Saving scenario to {ai_scenarios_file}")
            
            # Ensure data directory exists
            import os
            os.makedirs('data', exist_ok=True)
            
            try:
                with open(ai_scenarios_file, 'r', encoding='utf-8') as f:
                    ai_scenarios = json.load(f)
            except FileNotFoundError:
                ai_scenarios = {"scenarios": []}
            
            ai_scenarios["scenarios"].append(scenario)
            
            with open(ai_scenarios_file, 'w', encoding='utf-8') as f:
                json.dump(ai_scenarios, f, ensure_ascii=False, indent=2)
            
            print("‚úÖ Scenario saved successfully")
        except Exception as e:
            print(f"‚ùå Error saving scenario: {e}")
            # Don't fail the request if saving fails
            pass
        
        return jsonify({
            "success": True,
            "scenario": scenario,
            "message": f"{file_name} dosyasƒ±ndan senaryo olu≈üturuldu!"
        })
        
    except Exception as e:
        print(f"‚ùå File upload error: {e}")
        import traceback
        traceback.print_exc()
        return jsonify({"error": f"Dosya y√ºkleme ba≈üarƒ±sƒ±z: {str(e)}"}), 500

@app.route('/api/quests/complete_action', methods=['POST'])
def complete_quest_action():
    """G√∂rev aksiyonu tamamlama - ger√ßek oyuncu aksiyonu gerektirir"""
    try:
        data = request.get_json()
        action_type = data.get('action_type')
        scenario_id = data.get('scenario_id')
        user_id = data.get('user_id', 'guest_user')
        
        # Aksiyon t√ºr√ºne g√∂re gereksinimleri kontrol et
        quest_completed = False
        required_actions = {}
        
        if action_type == "explore_world":
            required_actions = {
                "exploration_skill": 10,
                "locations_visited": 3,
                "time_spent": 30  # dakika
            }
        elif action_type == "find_clues":
            required_actions = {
                "investigation_skill": 15,
                "clues_found": 5,
                "search_actions": 10
            }
        elif action_type == "complete_objective":
            required_actions = {
                "combat_won": 3,
                "npc_interactions": 5,
                "items_collected": 2
            }
        elif action_type == "defeat_enemy":
            required_actions = {
                "combat_skill": 20,
                "damage_dealt": 100,
                "tactics_used": 3
            }
        elif action_type == "solve_puzzle":
            required_actions = {
                "intelligence_skill": 15,
                "puzzle_attempts": 5,
                "correct_answers": 3
            }
        elif action_type == "social_interaction":
            required_actions = {
                "charisma_skill": 12,
                "conversations": 8,
                "relationship_built": 50
            }
        elif action_type == "dragon_hunt":
            required_actions = {
                "combat_skill": 25,
                "exploration_skill": 15,
                "charisma_skill": 10,
                "investigation_skill": 12,
                "time_spent": 60,
                "locations_visited": 5,
                "npc_interactions": 3,
                "items_collected": 3
            }
        
        # Oyuncunun mevcut durumunu kontrol et
        player_stats = get_player_stats(user_id)
        
        # Gereksinimleri kar≈üƒ±layƒ±p kar≈üƒ±lamadƒ±ƒüƒ±nƒ± kontrol et
        all_requirements_met = True
        missing_requirements = []
        
        for requirement, value in required_actions.items():
            current_value = player_stats.get(requirement, 0)
            if current_value < value:
                all_requirements_met = False
                missing_requirements.append({
                    "requirement": requirement,
                    "required": value,
                    "current": current_value,
                    "missing": value - current_value
                })
        
        if all_requirements_met:
            quest_completed = True
            # Oyuncu istatistiklerini g√ºncelle
            update_player_stats(user_id, "quests_completed", 1)
            update_player_stats(user_id, "xp", 100)  # Daha fazla XP
            
            # Ba≈üarƒ± mesajƒ±
            success_message = f"üéâ G√∂rev ba≈üarƒ±yla tamamlandƒ±! +100 XP kazandƒ±n!"
        else:
            # Eksik gereksinimleri g√∂ster
            missing_text = []
            for req in missing_requirements:
                if req["requirement"] == "exploration_skill":
                    missing_text.append(f"üîç Ke≈üif becerisi: {req['current']}/{req['required']} (Eksik: {req['missing']})")
                elif req["requirement"] == "combat_skill":
                    missing_text.append(f"‚öîÔ∏è Sava≈ü becerisi: {req['current']}/{req['required']} (Eksik: {req['missing']})")
                elif req["requirement"] == "charisma_skill":
                    missing_text.append(f"üí¨ Karizma: {req['current']}/{req['required']} (Eksik: {req['missing']})")
                elif req["requirement"] == "investigation_skill":
                    missing_text.append(f"üîé Ara≈ütƒ±rma: {req['current']}/{req['required']} (Eksik: {req['missing']})")
                elif req["requirement"] == "time_spent":
                    missing_text.append(f"‚è∞ Ge√ßen s√ºre: {req['current']}/{req['required']} dakika (Eksik: {req['missing']} dakika)")
                elif req["requirement"] == "locations_visited":
                    missing_text.append(f"üó∫Ô∏è Ziyaret edilen yerler: {req['current']}/{req['required']} (Eksik: {req['missing']})")
                elif req["requirement"] == "npc_interactions":
                    missing_text.append(f"üë• NPC etkile≈üimleri: {req['current']}/{req['required']} (Eksik: {req['missing']})")
                elif req["requirement"] == "items_collected":
                    missing_text.append(f"üì¶ Toplanan e≈üyalar: {req['current']}/{req['required']} (Eksik: {req['missing']})")
                else:
                    missing_text.append(f"{req['requirement']}: {req['current']}/{req['required']} (Eksik: {req['missing']})")
            
            success_message = f"‚ùå G√∂rev tamamlanamadƒ±!\n\nEksik gereksinimler:\n" + "\n".join(missing_text)
        
        return jsonify({
            "success": True,
            "quest_completed": quest_completed,
            "requirements_met": all_requirements_met,
            "required_actions": required_actions,
            "current_stats": player_stats,
            "missing_requirements": missing_requirements if not all_requirements_met else [],
            "message": success_message
        })
        
    except Exception as e:
        print(f"Quest action completion error: {e}")
        return jsonify({
            "success": False,
            "error": str(e)
        }), 500

@app.route('/api/player/stats', methods=['GET'])
def get_player_statistics():
    """Oyuncu istatistiklerini getir"""
    try:
        user_id = request.args.get('user_id', 'guest_user')
        stats = get_player_stats(user_id)
        
        return jsonify({
            "success": True,
            "stats": stats
        })
        
    except Exception as e:
        print(f"Player stats error: {e}")
        return jsonify({
            "success": False,
            "error": str(e)
        }), 500

@app.route('/api/player/action', methods=['POST'])
def record_player_action():
    """Oyuncu aksiyonunu kaydet"""
    try:
        data = request.get_json()
        user_id = data.get('user_id', 'guest_user')
        action_type = data.get('action_type')
        action_value = data.get('action_value', 1)
        
        # Aksiyon t√ºr√ºne g√∂re istatistik g√ºncelle
        if action_type in ["exploration", "search", "investigation"]:
            update_player_stats(user_id, "exploration_skill", action_value)
            update_player_stats(user_id, "locations_visited", 1)
        elif action_type in ["combat", "attack", "defend"]:
            update_player_stats(user_id, "combat_skill", action_value)
            update_player_stats(user_id, "damage_dealt", action_value * 10)
        elif action_type in ["talk", "persuade", "intimidate"]:
            update_player_stats(user_id, "charisma_skill", action_value)
            update_player_stats(user_id, "conversations", 1)
        elif action_type in ["solve", "think", "analyze"]:
            update_player_stats(user_id, "intelligence_skill", action_value)
            update_player_stats(user_id, "puzzle_attempts", 1)
        elif action_type in ["collect", "gather", "find"]:
            update_player_stats(user_id, "items_collected", action_value)
        
        # Zaman ge√ßi≈üi
        update_player_stats(user_id, "time_spent", 5)  # 5 dakika
        
        return jsonify({
            "success": True,
            "message": f"{action_type} aksiyonu kaydedildi",
            "stats": get_player_stats(user_id)
        })
        
    except Exception as e:
        print(f"Player action recording error: {e}")
        return jsonify({
            "success": False,
            "error": str(e)
        }), 500

def get_player_stats(user_id):
    """Oyuncu istatistiklerini getir"""
    try:
        stats_file = f'data/player_stats_{user_id}.json'
        if os.path.exists(stats_file):
            with open(stats_file, 'r', encoding='utf-8') as f:
                return json.load(f)
        else:
            # Varsayƒ±lan istatistikler
            default_stats = {
                "xp": 0,
                "level": 1,
                "quests_completed": 0,
                "exploration_skill": 0,
                "combat_skill": 0,
                "charisma_skill": 0,
                "intelligence_skill": 0,
                "locations_visited": 0,
                "clues_found": 0,
                "search_actions": 0,
                "combat_won": 0,
                "npc_interactions": 0,
                "items_collected": 0,
                "damage_dealt": 0,
                "tactics_used": 0,
                "puzzle_attempts": 0,
                "correct_answers": 0,
                "conversations": 0,
                "relationship_built": 0,
                "time_spent": 0
            }
            save_player_stats(user_id, default_stats)
            return default_stats
    except Exception as e:
        print(f"Get player stats error: {e}")
        return {}

def save_player_stats(user_id, stats):
    """Oyuncu istatistiklerini kaydet"""
    try:
        os.makedirs('data', exist_ok=True)
        stats_file = f'data/player_stats_{user_id}.json'
        with open(stats_file, 'w', encoding='utf-8') as f:
            json.dump(stats, f, ensure_ascii=False, indent=2)
    except Exception as e:
        print(f"Save player stats error: {e}")

def update_player_stats(user_id, stat_type, value):
    """Oyuncu istatistiƒüini g√ºncelle"""
    try:
        stats = get_player_stats(user_id)
        if stat_type in stats:
            stats[stat_type] += value
        else:
            stats[stat_type] = value
        save_player_stats(user_id, stats)
    except Exception as e:
        print(f"Update player stats error: {e}")

def create_scenario_from_file(file_content, file_name):
    """Dosya i√ßeriƒüinden dinamik senaryo olu≈ütur"""
    
    # Dosya i√ßeriƒüini analiz et
    lines = file_content.split('\n')
    title = file_name.replace('.txt', '').replace('.pdf', '').replace('_', ' ').title()
    
    # ƒ∞√ßerik analizi
    word_count = len(file_content.split())
    paragraphs = [p.strip() for p in file_content.split('\n\n') if p.strip()]
    
    # Anahtar kelime analizi
    has_fantasy_keywords = any(keyword in file_content.lower() for keyword in ['dragon', 'magic', 'sword', 'elf', 'dwarf', 'wizard', 'kale', 'b√ºy√º', 'ejderha', 'ork', 'elf', 'c√ºce'])
    has_scifi_keywords = any(keyword in file_content.lower() for keyword in ['robot', 'spaceship', 'laser', 'planet', 'alien', 'technology', 'uzay', 'teknoloji', 'siber', 'hologram'])
    has_horror_keywords = any(keyword in file_content.lower() for keyword in ['ghost', 'monster', 'dark', 'fear', 'death', 'blood', 'hayalet', 'canavar', 'korku', '√∂l√ºm', 'kan'])
    has_warhammer_keywords = any(keyword in file_content.lower() for keyword in ['warhammer', '40k', 'imperium', 'chaos', 'space marine', 'ork', 'eldar', 'necron'])
    
    # Tema belirleme
    if has_warhammer_keywords:
        theme = "warhammer"
        difficulty = "hard"
    elif has_fantasy_keywords:
        theme = "fantasy"
        difficulty = "medium"
    elif has_scifi_keywords:
        theme = "cyberpunk"
        difficulty = "hard"
    elif has_horror_keywords:
        theme = "horror"
        difficulty = "hard"
    else:
        theme = "adventure"
        difficulty = "medium"
    
    # Seviye ve s√ºre hesaplama
    if word_count < 500:
        min_level = 1
        max_level = 5
        duration = 60
    elif word_count < 1000:
        min_level = 3
        max_level = 8
        duration = 120
    elif word_count < 2000:
        min_level = 5
        max_level = 12
        duration = 180
    else:
        min_level = 8
        max_level = 20
        duration = 240
    
    # Benzersiz ID olu≈ütur
    scenario_id = f"file_scenario_{int(time.time())}"
    
    # Dosya i√ßeriƒüinden ger√ßek hikaye noktalarƒ± olu≈ütur
    story_nodes = create_dynamic_story_nodes_from_content(file_content, paragraphs, theme)
    
    # NPC'ler ve ili≈ükiler olu≈ütur
    npc_relationships = create_npcs_from_content(file_content, theme)
    
    # G√∂rev zincirleri olu≈ütur
    quest_chains = create_quest_chains_from_content(file_content, theme)
    
    # Senaryo olu≈ütur
    scenario = {
        "id": scenario_id,
        "title": f"Dosyadan √úretilen: {title}",
        "theme": theme,
        "difficulty": difficulty,
        "min_level": min_level,
        "max_level": max_level,
        "duration": duration,
        "description": f"'{file_name}' dosyasƒ±ndan AI tarafƒ±ndan √ºretilen {theme} temalƒ± macera. Dosya i√ßeriƒüi analiz edilerek {word_count} kelimelik hikaye {min_level}-{max_level} seviye arasƒ± oyuncular i√ßin uyarlandƒ±. Tahmini s√ºre: {duration} dakika.",
        "story_nodes": story_nodes,
        "npc_relationships": npc_relationships,
        "quest_chains": quest_chains,
        "file_source": file_name,
        "word_count": word_count,
        "created_at": datetime.now().isoformat(),
        "ai_generated": True,
        "source_type": "file_upload",
        "levels": create_levels_from_content(file_content, theme, min_level, max_level)
    }
    
    return scenario

def create_dynamic_story_nodes_from_content(content, paragraphs, theme):
    """Dosya i√ßeriƒüinden dinamik hikaye noktalarƒ± olu≈ütur"""
    
    nodes = {}
    
    # Ba≈ülangƒ±√ß noktasƒ± - MUTLAKA "start" olmalƒ±
    nodes["start"] = create_start_node_from_content(content, theme)
    
    # Dosya i√ßeriƒüinden ger√ßek hikaye noktalarƒ± olu≈ütur
    for i, paragraph in enumerate(paragraphs[:10]):  # ƒ∞lk 10 paragrafƒ± kullan
        if len(paragraph) > 50:  # Sadece yeterli uzunluktaki paragraflarƒ± kullan
            node_id = f"content_node_{i+1}"
            nodes[node_id] = create_content_node_from_paragraph(paragraph, i+1, theme, paragraphs)
    
    # Son nokta - MUTLAKA "end" olmalƒ±
    nodes["end"] = create_end_node_from_content(content, theme)
    
    # T√ºm node'larƒ±n birbirine baƒülƒ± olduƒüundan emin ol
    # Her node'un en az bir se√ßeneƒüi "end" node'una gitmeli
    for node_id, node in nodes.items():
        if node_id != "end" and "choices" in node:
            # Eƒüer hi√ß se√ßenek yoksa veya t√ºm se√ßenekler ge√ßersizse, end'e git
            valid_choices = [choice for choice in node["choices"] if choice.get("next_node") in nodes]
            if not valid_choices:
                node["choices"].append({
                    "id": "continue_to_end",
                    "text": "‚û°Ô∏è Devam et",
                    "next_node": "end",
                    "effect": {"xp": 20, "exploration": 10}
                })
    
    return nodes

def create_start_node_from_content(content, theme):
    """ƒ∞√ßerikten ba≈ülangƒ±√ß noktasƒ± olu≈ütur"""
    
    # ƒ∞√ßerikten ana karakterleri ve mekanlarƒ± √ßƒ±kar
    characters = extract_characters_from_content(content)
    locations = extract_locations_from_content(content)
    
    # Paragraflarƒ± analiz et
    paragraphs = [p.strip() for p in content.split('\n\n') if p.strip()]
    
    if theme == "fantasy":
        return {
            "title": "üé≠ B√ºy√ºl√º Macera Ba≈ülƒ±yor",
            "description": f"B√ºy√ºl√º bir d√ºnyada kendini buldun. Etrafƒ±nda {', '.join(locations[:3]) if locations else 'eski kaleler, gizli ormanlar'} var. {', '.join(characters[:2]) if characters else 'Bilinmeyen karakterler'} seni bekliyor...",
            "atmosphere": {
                "sounds": ["R√ºzgar uƒüultusu", "Uzak kurt ulumasƒ±", "B√ºy√º fƒ±sƒ±ltƒ±larƒ±"],
                "visuals": ["Ay ƒ±≈üƒ±ƒüƒ±", "Eski kaleler", "B√ºy√ºl√º ormanlar"]
            },
            "choices": [
                {
                    "id": "explore_world",
                    "text": "üó∫Ô∏è D√ºnyayƒ± ke≈üfet",
                    "next_node": "content_node_1",
                    "effect": {"xp": 20, "exploration": 10}
                },
                {
                    "id": "meet_characters",
                    "text": "üë• Karakterlerle tanƒ±≈ü",
                    "next_node": "content_node_2" if len(paragraphs) > 1 else "content_node_1",
                    "effect": {"xp": 15, "social": 10}
                },
                {
                    "id": "start_quest",
                    "text": "‚öîÔ∏è G√∂reve ba≈üla",
                    "next_node": "content_node_3" if len(paragraphs) > 2 else "content_node_1",
                    "effect": {"xp": 25, "combat": 15}
                }
            ]
        }
    elif theme == "cyberpunk":
        return {
            "title": "ü§ñ Cyberpunk D√ºnyasƒ±",
            "description": f"Geleceƒüin neon ƒ±≈üƒ±klarƒ± altƒ±nda, teknoloji ve insanlƒ±k i√ß i√ße. {', '.join(locations[:2]) if locations else 'Y√ºksek binalar, neon sokaklar'} seni bekliyor...",
            "atmosphere": {
                "sounds": ["Neon vƒ±zƒ±ltƒ±sƒ±", "Elektronik sesler", "Uzak sirenler"],
                "visuals": ["Neon ƒ±≈üƒ±klar", "Y√ºksek binalar", "Hologramlar"]
            },
            "choices": [
                {
                    "id": "hack_system",
                    "text": "üíª Sistemi hack'le",
                    "next_node": "content_node_1",
                    "effect": {"xp": 20, "technology": 15}
                },
                {
                    "id": "street_fight",
                    "text": "ü•ä Sokak sava≈üƒ±",
                    "next_node": "content_node_2" if len(paragraphs) > 1 else "content_node_1",
                    "effect": {"xp": 25, "combat": 20}
                },
                {
                    "id": "corporate_espionage",
                    "text": "üè¢ Kurumsal casusluk",
                    "next_node": "content_node_3" if len(paragraphs) > 2 else "content_node_1",
                    "effect": {"xp": 30, "stealth": 15}
                }
            ]
        }
    else:
        return {
            "title": "üéØ Macera Ba≈ülƒ±yor",
            "description": f"Yeni bir macerada kendini buldun. {', '.join(locations[:2]) if locations else 'Bilinmeyen topraklar'} seni bekliyor...",
            "atmosphere": {
                "sounds": ["R√ºzgar sesi", "Uzak sesler", "Doƒüa sesleri"],
                "visuals": ["Geni≈ü manzaralar", "Yol i≈üaretleri", "Uzak tepeler"]
            },
            "choices": [
                {
                    "id": "explore_area",
                    "text": "üó∫Ô∏è B√∂lgeyi ke≈üfet",
                    "next_node": "content_node_1",
                    "effect": {"xp": 20, "exploration": 10}
                },
                {
                    "id": "find_clues",
                    "text": "üîç ƒ∞pu√ßlarƒ± ara",
                    "next_node": "content_node_2" if len(paragraphs) > 1 else "content_node_1",
                    "effect": {"xp": 15, "investigation": 10}
                },
                {
                    "id": "meet_npcs",
                    "text": "üë• NPC'lerle tanƒ±≈ü",
                    "next_node": "content_node_3" if len(paragraphs) > 2 else "content_node_1",
                    "effect": {"xp": 10, "social": 10}
                }
            ]
        }

def create_content_node_from_paragraph(paragraph, node_number, theme, all_paragraphs):
    """Paragraftan hikaye noktasƒ± olu≈ütur"""
    
    # Paragrafƒ± kƒ±salt (maksimum 300 karakter)
    description = paragraph[:300] + "..." if len(paragraph) > 300 else paragraph
    
    # Se√ßenekler olu≈ütur
    choices = []
    
    # Farklƒ± se√ßenekler
    choice_options = [
        ("‚û°Ô∏è Devam et", "continue"),
        ("üîç Daha detaylƒ± ara≈ütƒ±r", "investigate"),
        ("‚öîÔ∏è Hazƒ±rlan", "prepare"),
        ("üí¨ Konu≈ü", "talk"),
        ("üèÉ Ka√ß", "escape"),
        ("‚ö° Hƒ±zlƒ± hareket et", "quick_action")
    ]
    
    # Tema bazlƒ± se√ßenekler
    if theme == "fantasy":
        choice_options.extend([
            ("üîÆ B√ºy√º kullan", "cast_magic"),
            ("üó°Ô∏è Sava≈ü", "combat"),
            ("üõ°Ô∏è Savun", "defend")
        ])
    elif theme == "cyberpunk":
        choice_options.extend([
            ("üíª Hack yap", "hack"),
            ("üî´ Ate≈ü et", "shoot"),
            ("üèÉ Ka√ß", "escape")
        ])
    
    # Se√ßenekleri olu≈ütur
    for i, (text, action) in enumerate(choice_options[:4]):  # Maksimum 4 se√ßenek
        # Sonraki node'u belirle - eƒüer son paragraf ise end'e git
        if node_number >= len(all_paragraphs):
            next_node = "end"
        else:
            next_node = f"content_node_{node_number + 1}"
        
        choices.append({
            "id": f"{action}_{node_number}",
            "text": text,
            "next_node": next_node,
            "effect": {
                "xp": 10 + (i * 5),
                "skill": get_skill_for_action(action, theme)
            }
        })
    
    # En az bir se√ßenek her zaman end'e gitmeli
    if node_number >= len(all_paragraphs) - 1:
        choices.append({
            "id": "finish_story",
            "text": "üéâ Hikayeyi tamamla",
            "next_node": "end",
            "effect": {"xp": 50, "achievement": "story_completed"}
        })
    
    return {
        "title": f"üìñ Hikaye B√∂l√ºm√º {node_number}",
        "description": description,
        "atmosphere": get_atmosphere_for_theme(theme),
        "choices": choices
    }

def extract_characters_from_content(content):
    """ƒ∞√ßerikten karakter isimleri √ßƒ±kar"""
    # Basit karakter √ßƒ±karma - ger√ßek sistemde daha geli≈ümi≈ü NLP kullanƒ±labilir
    words = content.split()
    characters = []
    
    # B√ºy√ºk harfle ba≈ülayan kelimeleri karakter olarak kabul et
    for i, word in enumerate(words):
        if word[0].isupper() and len(word) > 2 and i > 0:
            # √ñnceki kelime "ve", "ile", "veya" gibi baƒüla√ßlar deƒüilse
            if words[i-1].lower() not in ['ve', 'ile', 'veya', 'ama', 'fakat']:
                characters.append(word)
    
    return list(set(characters))[:5]  # Maksimum 5 karakter

def extract_locations_from_content(content):
    """ƒ∞√ßerikten mekan isimleri √ßƒ±kar"""
    # Basit mekan √ßƒ±karma
    location_keywords = ['kale', '≈üehir', 'k√∂y', 'orman', 'daƒü', 'nehir', 'deniz', 'tapƒ±nak', 'saray', 'kule']
    locations = []
    
    for keyword in location_keywords:
        if keyword in content.lower():
            locations.append(keyword.title())
    
    return locations

def get_skill_for_action(action, theme):
    """Aksiyon i√ßin uygun beceri d√∂nd√ºr"""
    skill_map = {
        "continue": "exploration",
        "investigate": "investigation", 
        "prepare": "planning",
        "talk": "social",
        "escape": "stealth",
        "quick_action": "agility",
        "cast_magic": "magic",
        "combat": "combat",
        "defend": "defense",
        "hack": "technology",
        "shoot": "combat"
    }
    return skill_map.get(action, "general")

def get_atmosphere_for_theme(theme):
    """Tema i√ßin atmosfer bilgisi d√∂nd√ºr"""
    atmospheres = {
        "fantasy": {
            "sounds": ["R√ºzgar uƒüultusu", "B√ºy√º fƒ±sƒ±ltƒ±larƒ±", "Metal tƒ±ngƒ±rtƒ±sƒ±"],
            "visuals": ["B√ºy√ºl√º ƒ±≈üƒ±klar", "Antik duvarlar", "Gizli ge√ßitler"]
        },
        "cyberpunk": {
            "sounds": ["Elektronik sesler", "Neon vƒ±zƒ±ltƒ±sƒ±", "Uzak sirenler"],
            "visuals": ["Neon ƒ±≈üƒ±klar", "Hologramlar", "Y√ºksek binalar"]
        },
        "horror": {
            "sounds": ["Gƒ±cƒ±rtƒ±lar", "Uzak √ßƒ±ƒülƒ±klar", "R√ºzgar uƒüultusu"],
            "visuals": ["Karanlƒ±k g√∂lgeler", "Gizemli i≈üaretler", "Eski yapƒ±lar"]
        },
        "adventure": {
            "sounds": ["Doƒüa sesleri", "R√ºzgar", "Uzak sesler"],
            "visuals": ["Geni≈ü manzaralar", "Yol i≈üaretleri", "Uzak tepeler"]
        }
    }
    return atmospheres.get(theme, atmospheres["adventure"])

def create_npcs_from_content(content, theme):
    """ƒ∞√ßerikten NPC'ler olu≈ütur"""
    characters = extract_characters_from_content(content)
    npcs = {}
    
    for i, char in enumerate(characters[:3]):  # Maksimum 3 NPC
        npcs[f"npc_{i+1}"] = {
            "name": char,
            "trust_level": 0,
            "quests_completed": 0,
            "relationship_status": "stranger",
            "ending_impact": "medium" if i == 0 else "low"
        }
    
    return npcs

def create_quest_chains_from_content(content, theme):
    """ƒ∞√ßerikten g√∂rev zincirleri olu≈ütur"""
    return {
        "main_quest": {
            "title": "Ana G√∂rev",
            "prerequisites": [],
            "quests": ["explore_world", "find_clues", "complete_objective"],
            "rewards": {"xp": 500, "gold": 200, "items": ["special_item"], "relationship_boost": 20}
        }
    }

def create_levels_from_content(content, theme, min_level, max_level):
    """ƒ∞√ßerikten seviye bilgileri olu≈ütur"""
    return {
        "level_1": {
            "title": "Ba≈ülangƒ±√ß",
            "description": "Macera ba≈ülƒ±yor",
            "min_level": min_level,
            "max_level": min_level + 2,
            "enemies": ["Basic Enemy"],
            "boss": "Minor Boss",
            "side_quests": ["Tutorial Quest"]
        },
        "level_2": {
            "title": "Geli≈üim",
            "description": "Karakter geli≈üimi",
            "min_level": min_level + 2,
            "max_level": max_level - 2,
            "enemies": ["Advanced Enemy"],
            "boss": "Major Boss", 
            "side_quests": ["Character Development"]
        }
    }

def create_end_node_from_content(content, theme):
    """ƒ∞√ßerikten son nokta olu≈ütur"""
    return {
        "title": "üéâ Macera Tamamlandƒ±",
        "description": "Hikayenin sonuna ula≈ütƒ±n. Bu macerada √ßok ≈üey √∂ƒürendin ve deneyim kazandƒ±n. Yeni maceralar seni bekliyor!",
        "choices": [
            {
                "id": "restart",
                "text": "üîÑ Yeniden ba≈üla",
                "next_node": "start",
                "effect": {"xp": 50, "achievement": "completed_story"}
            }
        ]
    }

def check_and_complete_quests(user_id, scenario_id):
    """Oyuncu action'larƒ±na g√∂re quest'leri otomatik kontrol et ve tamamla"""
    try:
        # Oyuncu istatistiklerini al
        player_stats = get_player_stats(user_id)
        
        # Senaryo quest'lerini al
        quests_to_check = get_scenario_quests(scenario_id)
        
        completed_quests = []
        
        for quest in quests_to_check:
            # Quest zaten tamamlanmƒ±≈ü mƒ± kontrol et
            completed_quest_key = f"quest_completed_{quest['id']}"
            if player_stats.get(completed_quest_key, False):
                continue  # Bu quest zaten tamamlanmƒ±≈ü
            
            # Quest requirement'larƒ±nƒ± kontrol et
            requirements = quest.get('requirements', {})
            all_met = True
            
            for requirement, required_value in requirements.items():
                current_value = player_stats.get(requirement, 0)
                if current_value < required_value:
                    all_met = False
                    break
            
            if all_met:
                # Quest tamamlandƒ±!
                completed_quests.append(quest)
                # Quest'i tamamlandƒ± olarak i≈üaretle
                update_player_stats(user_id, completed_quest_key, True)
                update_player_stats(user_id, "quests_completed", 1)
                
                # Quest reward'larƒ±nƒ± ver
                if 'rewards' in quest:
                    for reward_type, reward_value in quest['rewards'].items():
                        if reward_type != 'title':  # Title special case
                            update_player_stats(user_id, reward_type, reward_value)
        
        return completed_quests
        
    except Exception as e:
        print(f"Quest check error: {e}")
        return []

def get_scenario_quests(scenario_id):
    """Senaryonun quest'lerini getir"""
    # Dragon Hunter senaryosu i√ßin √∂zel quest'ler
    if scenario_id == "dragon_hunters_path":
        return [
            {
                "id": "dragon_hunt_main",
                "title": "Ejderha Avƒ±",
                "requirements": {
                    "combat_skill": 25,
                    "exploration_skill": 15,
                    "conversations": 3,
                    "locations_visited": 5,
                    "time_spent": 60
                },
                "rewards": {
                    "xp": 500,
                    "title": "Dragon Slayer"
                }
            },
            {
                "id": "village_helper",
                "title": "K√∂y Yardƒ±mcƒ±sƒ±",
                "requirements": {
                    "charisma_skill": 10,
                    "conversations": 5,
                    "npc_interactions": 3
                },
                "rewards": {
                    "xp": 200,
                    "title": "Village Hero"
                }
            },
            {
                "id": "explorer",
                "title": "Ke≈üif√ßi",
                "requirements": {
                    "exploration_skill": 20,
                    "locations_visited": 8,
                    "search_actions": 10
                },
                "rewards": {
                    "xp": 300,
                    "title": "Master Explorer"
                }
            },
            {
                "id": "warrior",
                "title": "Sava≈ü√ßƒ±",
                "requirements": {
                    "combat_skill": 30,
                    "damage_dealt": 200,
                    "combat_won": 5
                },
                "rewards": {
                    "xp": 400,
                    "title": "Warrior"
                }
            }
        ]
    
    # Diƒüer senaryolar i√ßin genel quest'ler
    return [
        {
            "id": "first_steps",
            "title": "ƒ∞lk Adƒ±mlar",
            "requirements": {
                "exploration_skill": 5,
                "time_spent": 15
            },
            "rewards": {
                "xp": 100,
                "title": "Adventurer"
            }
        },
        {
            "id": "social_butterfly",
            "title": "Sosyal Kelebek",
            "requirements": {
                "conversations": 8,
                "charisma_skill": 15
            },
            "rewards": {
                "xp": 200,
                "title": "Social Master"
            }
        }
    ]

def generate_advanced_scenario(theme, title, character, description, difficulty):
    """Geli≈ümi≈ü AI senaryo √ºretimi"""
    import time
    from datetime import datetime
    
    # Benzersiz ID olu≈ütur
    scenario_id = f"ai_scenario_{int(time.time())}"
    
    # Zorluk seviyesine g√∂re parametreler
    difficulty_settings = {
        "easy": {"min_level": 1, "max_level": 5, "duration": 60, "complexity": "simple"},
        "medium": {"min_level": 3, "max_level": 10, "duration": 120, "complexity": "medium"},
        "hard": {"min_level": 8, "max_level": 15, "duration": 180, "complexity": "complex"},
        "extreme": {"min_level": 12, "max_level": 20, "duration": 240, "complexity": "extreme"}
    }
    
    settings = difficulty_settings.get(difficulty, difficulty_settings["medium"])
    
    # Tema √∂zelle≈ütirilmi≈ü hikaye noktalarƒ±
    story_nodes = create_advanced_story_nodes(theme, title, character, description, settings)
    
    # Geli≈ümi≈ü NPC sistemi
    npc_relationships = create_advanced_npcs(theme, character, settings)
    
    # G√∂rev zincirleri
    quest_chains = create_advanced_quests(theme, character, settings)
    
    # Plot twist'ler ve ihanetler
    betrayals = create_plot_twists(theme, character, settings)
    
    # Multiple endings
    endings = create_multiple_endings(theme, settings)
    
    scenario = {
        "id": scenario_id,
        "title": title,
        "theme": theme,
        "difficulty": difficulty,
        "min_level": settings["min_level"],
        "max_level": settings["max_level"],
        "duration": settings["duration"],
        "complexity": settings["complexity"],
        "description": f"{description} Bu senaryo {character} karakteri i√ßin {theme} temasƒ±nda AI tarafƒ±ndan √∂zel olarak √ºretildi. Zorluk seviyesi: {difficulty}. Tahmini s√ºre: {settings['duration']} dakika.",
        "main_character": character,
        "story_nodes": story_nodes,
        "npc_relationships": npc_relationships,
        "quest_chains": quest_chains,
        "betrayals": betrayals,
        "endings": endings,
        "ai_generated": True,
        "created_at": datetime.now().isoformat(),
        "source_type": "ai_form",
        "features": [
            "Plot Twists", "Multiple Endings", "NPC Relationships", 
            "Quest Chains", "Dynamic Choices", "Skill Development"
        ],
        "levels": {
            "level_1": {
                "title": "Ba≈ülangƒ±√ß",
                "min_level": settings["min_level"],
                "max_level": settings["min_level"] + 3,
                "enemies": get_enemies_for_theme(theme, "easy"),
                "boss": get_boss_for_theme(theme, "minor")
            },
            "level_2": {
                "title": "Geli≈üim",
                "min_level": settings["min_level"] + 3,
                "max_level": settings["max_level"],
                "enemies": get_enemies_for_theme(theme, "hard"),
                "boss": get_boss_for_theme(theme, "major")
            }
        }
    }
    
    return scenario

def create_advanced_story_nodes(theme, title, character, description, settings):
    """Geli≈ümi≈ü hikaye noktalarƒ± olu≈ütur"""
    nodes = {}
    
    # Ba≈ülangƒ±√ß
    nodes["start"] = {
        "title": f"üé≠ {title} - Macera Ba≈ülƒ±yor",
        "description": f"{character}, {description} Bu hikayede her se√ßimin sonu√ßlarƒ± olacak ve hikaye senin kararlarƒ±nla ≈üekillenecek.",
        "atmosphere": get_atmosphere_for_theme(theme),
        "choices": [
            {
                "id": "explore_world",
                "text": "üó∫Ô∏è D√ºnyayƒ± ke≈üfet",
                "next_node": "world_exploration",
                "effect": {"xp": 20, "exploration": 15}
            },
            {
                "id": "meet_npcs",
                "text": "üë• Karakterlerle tanƒ±≈ü",
                "next_node": "npc_introduction",
                "effect": {"xp": 15, "social": 10}
            },
            {
                "id": "start_main_quest",
                "text": "‚öîÔ∏è Ana g√∂reve ba≈üla",
                "next_node": "main_quest_start",
                "effect": {"xp": 25, "combat": 15}
            }
        ]
    }
    
    # D√ºnya ke≈üfi
    nodes["world_exploration"] = {
        "title": "üó∫Ô∏è D√ºnya Ke≈üfi",
        "description": f"Etrafƒ±nƒ± ke≈üfederken, bu {theme} d√ºnyasƒ±nƒ±n zenginliklerini g√∂r√ºyorsun. Her k√∂≈üede yeni sƒ±rlar ve tehlikeler seni bekliyor.",
        "choices": [
            {
                "id": "find_secret",
                "text": "üîç Gizli yerleri ara",
                "next_node": "secret_discovery",
                "effect": {"xp": 30, "investigation": 20}
            },
            {
                "id": "gather_resources",
                "text": "üíé Kaynak topla",
                "next_node": "resource_gathering",
                "effect": {"xp": 20, "collection": 15}
            },
            {
                "id": "encounter_danger",
                "text": "‚ö° Tehlikeye atƒ±l",
                "next_node": "danger_encounter",
                "effect": {"xp": 35, "combat": 25}
            }
        ]
    }
    
    # NPC tanƒ±≈üma
    nodes["npc_introduction"] = {
        "title": "üë• Karakter Tanƒ±≈ümalarƒ±",
        "description": "Bu d√ºnyada ya≈üayan ilgin√ß karakterlerle tanƒ±≈üƒ±yorsun. Her birinin kendine √∂zg√º hikayeleri ve ama√ßlarƒ± var.",
        "choices": [
            {
                "id": "meet_ally",
                "text": "ü§ù M√ºttefik bul",
                "next_node": "ally_meeting",
                "effect": {"xp": 25, "social": 20, "trust": 10}
            },
            {
                "id": "meet_rival",
                "text": "‚öîÔ∏è Rakiple kar≈üƒ±la≈ü",
                "next_node": "rival_encounter",
                "effect": {"xp": 30, "combat": 15, "rivalry": 10}
            },
            {
                "id": "meet_mentor",
                "text": "üßô Mentor ara",
                "next_node": "mentor_meeting",
                "effect": {"xp": 35, "wisdom": 25}
            }
        ]
    }
    
    # Ana g√∂rev ba≈ülangƒ±cƒ±
    nodes["main_quest_start"] = {
        "title": "‚öîÔ∏è Ana G√∂rev",
        "description": f"{character} olarak ana g√∂revine ba≈ülƒ±yorsun. Bu g√∂rev {theme} d√ºnyasƒ±nƒ±n kaderini deƒüi≈ütirebilir.",
        "choices": [
            {
                "id": "choose_strategy",
                "text": "üß† Strateji belirle",
                "next_node": "strategy_planning",
                "effect": {"xp": 30, "strategy": 20}
            },
            {
                "id": "gather_allies",
                "text": "üë• M√ºttefik topla",
                "next_node": "ally_gathering",
                "effect": {"xp": 25, "social": 15, "team": 10}
            },
            {
                "id": "direct_action",
                "text": "‚ö° Doƒürudan harekete ge√ß",
                "next_node": "action_sequence",
                "effect": {"xp": 40, "combat": 30}
            }
        ]
    }
    
    # Son nokta
    nodes["end"] = {
        "title": "üéâ Macera Tamamlandƒ±",
        "description": f"{character} olarak bu epik macerade √ßok ≈üey ba≈üardƒ±n. Hikayende aldƒ±ƒüƒ±n kararlar d√ºnyayƒ± deƒüi≈ütirdi.",
        "choices": [
            {
                "id": "restart",
                "text": "üîÑ Yeniden ba≈üla",
                "next_node": "start",
                "effect": {"xp": 50, "achievement": "completed_story"}
            }
        ]
    }
    
    return nodes

def create_advanced_npcs(theme, character, settings):
    """Geli≈ümi≈ü NPC sistemi"""
    npcs = {}
    
    if theme == "fantasy":
        npcs.update({
            "aldric_mentor": {
                "name": "Aldric the Wise",
                "title": "B√ºy√ºl√º Mentor",
                "trust_level": 0,
                "relationship_status": "mentor",
                "ending_impact": "high",
                "backstory": f"{character} i√ßin rehber olan ya≈ülƒ± b√ºy√ºc√º",
                "personality": "Bilge, sabƒ±rlƒ± ama gizemli",
                "potential_betrayal": True,
                "betrayal_reason": "Gizli ejderha paktƒ±",
                "quest_offers": ["B√ºy√º Eƒüitimi", "Antik Bilgi", "G√º√ß Rit√ºeli"]
            },
            "lydia_healer": {
                "name": "Lydia the Healer", 
                "title": "Gizemli ≈ûifacƒ±",
                "trust_level": 0,
                "relationship_status": "stranger",
                "ending_impact": "extreme",
                "backstory": "K√∂yde ya≈üayan gen√ß ≈üifacƒ±, gizli kimliƒüi var",
                "personality": "Nazik, yardƒ±msever ama sƒ±r dolu",
                "potential_betrayal": True,
                "betrayal_reason": "Gizli ejderha kimliƒüi",
                "romance_option": True,
                "quest_offers": ["≈ûifa Bitkileri", "Gizli Kimlik", "Ejderha Sƒ±rrƒ±"]
            }
        })
    elif theme == "cyberpunk":
        npcs.update({
            "zara_hacker": {
                "name": "Zara Storm",
                "title": "Devrimci Hacker",
                "trust_level": 0,
                "relationship_status": "ally",
                "ending_impact": "high",
                "backstory": "Korporasyonlara kar≈üƒ± sava≈üan hacker",
                "personality": "Asi, zeki, tehlikeli",
                "quest_offers": ["Sistem Hack", "Devrim Planƒ±", "Kurumsal Casusluk"]
            },
            "rex_steel": {
                "name": "Rex Steel",
                "title": "Korporasyon Ajanƒ±",
                "trust_level": 0,
                "relationship_status": "enemy",
                "ending_impact": "extreme",
                "backstory": "MegaCorp i√ßin √ßalƒ±≈üan siber ajan",
                "personality": "Soƒüuk, hesap√ßƒ±, sadakatsiz",
                "potential_betrayal": True,
                "betrayal_reason": "AI CEO'nun emri",
                "quest_offers": ["Korporasyon G√∂revi", "AI Sƒ±rrƒ±", "Son G√∂rev"]
            }
        })
    
    return npcs

def create_advanced_quests(theme, character, settings):
    """Geli≈ümi≈ü g√∂rev zincirleri"""
    quests = {}
    
    if theme == "fantasy":
        quests["dragon_alliance"] = {
            "title": "Ejderha ƒ∞ttifakƒ±",
            "description": "Ejderhalarla barƒ±≈ü kurma g√∂revi",
            "prerequisites": ["meet_lydia", "discover_truth"],
            "quests": ["find_dragon_eggs", "heal_mother_dragon", "create_peace_treaty"],
            "rewards": {"xp": 1000, "dragon_rep": 500, "special_power": "dragon_speech"},
            "multiple_paths": True,
            "betrayal_triggers": ["trust_aldric", "ignore_warnings"]
        }
    elif theme == "cyberpunk":
        quests["ai_revolution"] = {
            "title": "AI Devrimi",
            "description": "AI sistemini √ß√∂kertme g√∂revi",
            "prerequisites": ["hack_system", "meet_zara"],
            "quests": ["infiltrate_megacorp", "discover_ai_secret", "shutdown_or_merge"],
            "rewards": {"xp": 1200, "hacker_rep": 600, "special_tech": "ai_interface"},
            "multiple_paths": True,
            "betrayal_triggers": ["trust_rex", "corporate_deal"]
        }
    
    return quests

def create_plot_twists(theme, character, settings):
    """Plot twist'ler ve ihanetler"""
    betrayals = {}
    
    if theme == "fantasy":
        betrayals.update({
            "aldric_betrayal": {
                "trigger": "trust_level_high",
                "description": "Aldric'in ejderhalarla gizli paktƒ± ortaya √ßƒ±kƒ±yor!",
                "impact": "Mentor d√º≈üman oluyor",
                "player_choice": True
            },
            "lydia_secret": {
                "trigger": "romance_level_high", 
                "description": "Lydia'nƒ±n ger√ßek kimliƒüi - o bir ejderha!",
                "impact": "T√ºm hikaye deƒüi≈üiyor",
                "player_choice": True
            }
        })
    elif theme == "cyberpunk":
        betrayals.update({
            "ai_ceo_reveal": {
                "trigger": "corporate_meeting",
                "description": "MegaCorp CEO'su aslƒ±nda bir AI!",
                "impact": "Ger√ßeklik algƒ±sƒ± deƒüi≈üiyor",
                "player_choice": False
            },
            "digital_consciousness": {
                "trigger": "deep_hack",
                "description": "Sen √∂lm√º≈ü birinin dijital bilincin!",
                "impact": "Kimlik krizi",
                "player_choice": True
            }
        })
    
    return betrayals

def create_multiple_endings(theme, settings):
    """Multiple ending sistemi"""
    endings = {}
    
    if theme == "fantasy":
        endings.update({
            "good_ending": {
                "title": "Ejderha Avcƒ±sƒ± Zaferi",
                "description": "Ejderhayƒ± yendin, k√∂y kurtuldu, halk seni kahraman ilan etti.",
                "requirements": ["defeat_dragon", "save_village", "high_heroism"],
                "rewards": {"title": "Dragon Slayer", "fame": 100}
            },
            "dragon_alliance": {
                "title": "Ejderhalarla Barƒ±≈ü",
                "description": "Ejderhalarla barƒ±≈ü kurarak yeni bir √ßaƒü ba≈ülattƒ±n.",
                "requirements": ["trust_lydia", "find_truth", "peace_treaty"],
                "rewards": {"title": "Peacemaker", "dragon_friend": True}
            },
            "betrayal_ending": {
                "title": "Aldric'in ƒ∞haneti",
                "description": "Aldric'e g√ºvendin ama o seni ejderlere sattƒ±.",
                "requirements": ["trust_aldric", "ignore_warnings"],
                "rewards": {"title": "Betrayed Hero", "tragedy": True}
            },
            "sacrifice_ending": {
                "title": "Kahramanlƒ±k Fedakarlƒ±ƒüƒ±",
                "description": "Kendini feda ederek herkesi kurtardƒ±n.",
                "requirements": ["sacrifice_choice", "save_others"],
                "rewards": {"title": "Martyr", "legend": True}
            },
            "dark_lord_ending": {
                "title": "Karanlƒ±k Efendi",
                "description": "Karanlƒ±k g√º√ßleri se√ßerek d√ºnyayƒ± y√∂netmeye ba≈üladƒ±n.",
                "requirements": ["embrace_darkness", "betray_allies"],
                "rewards": {"title": "Dark Lord", "evil_power": True}
            }
        })
    elif theme == "cyberpunk":
        endings.update({
            "revolution_ending": {
                "title": "Sistem √á√∂k√º≈ü√º",
                "description": "Korporasyon sistemini √ß√∂kerterek √∂zg√ºrl√ºk getirdin.",
                "requirements": ["destroy_ai", "lead_revolution", "high_rebel_rep"],
                "rewards": {"title": "Revolutionary", "freedom": True}
            },
            "corporate_ending": {
                "title": "Korporasyon Ajanƒ±",
                "description": "Korporasyonlara katƒ±larak g√º√ß elde ettin.",
                "requirements": ["join_corp", "betray_rebels", "corporate_loyalty"],
                "rewards": {"title": "Corporate Executive", "wealth": 1000000}
            },
            "ai_merge_ending": {
                "title": "AI ile Birle≈üme",
                "description": "AI ile birle≈üerek post-human oldun.",
                "requirements": ["merge_with_ai", "transcend_humanity"],
                "rewards": {"title": "Digital God", "ai_powers": True}
            },
            "underground_king": {
                "title": "Yeraltƒ± Kralƒ±",
                "description": "G√∂lgelerden d√ºnyayƒ± y√∂netmeye ba≈üladƒ±n.",
                "requirements": ["control_underworld", "manipulate_all"],
                "rewards": {"title": "Shadow Ruler", "hidden_power": True}
            },
            "lone_wolf_ending": {
                "title": "Yalnƒ±z Kurt",
                "description": "Herkesi aldatarak tek ba≈üƒ±na ayakta kaldƒ±n.",
                "requirements": ["betray_everyone", "survive_alone"],
                "rewards": {"title": "Lone Survivor", "independence": True}
            }
        })
    
    return endings

def get_enemies_for_theme(theme, difficulty):
    """Tema i√ßin d√º≈ümanlar"""
    enemies = {
        "fantasy": {
            "easy": ["Goblin", "Wolf", "Bandit"],
            "hard": ["Orc Warrior", "Dark Wizard", "Troll"]
        },
        "cyberpunk": {
            "easy": ["Street Thug", "Security Bot", "Corpo Guard"],
            "hard": ["Cyber Assassin", "AI Drone", "Enhanced Soldier"]
        },
        "warhammer": {
            "easy": ["Chaos Cultist", "Heretic Guard", "Mutant"],
            "hard": ["Chaos Marine", "Daemon", "Chaos Lord"]
        }
    }
    return enemies.get(theme, {}).get(difficulty, ["Generic Enemy"])

def get_boss_for_theme(theme, level):
    """Tema i√ßin boss"""
    bosses = {
        "fantasy": {
            "minor": "Orc Captain",
            "major": "Ancient Dragon"
        },
        "cyberpunk": {
            "minor": "Gang Leader",
            "major": "AI Overlord"
        },
            "warhammer": {
        "minor": "Chaos Champion", 
        "major": "Daemon Prince"
    },
    "horror": {
        "minor": "Ghost",
        "major": "Ancient Evil"
    }
    }
    return bosses.get(theme, {}).get(level, "Boss Enemy")

if __name__ == '__main__':
    # For Vercel deployment
    port = int(os.environ.get('PORT', 5002))
    app.run(host='0.0.0.0', port=port, debug=False)
